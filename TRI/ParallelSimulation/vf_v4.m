function [f, dfdx, dfdu, dfdxdot] = vf_v4(x, u, xdot, params)

% Define local names for relevant parameters
n = params.numFREEs;
L = params.Lspine;
a = params.xattach;
[a1, a2, a3, a4] = deal(a(1), a(2), a(3), a(4));
b = params.yattach;
[b1, b2, b3, b4] = deal(b(1), b(2), b(3), b(4));
m = params.m;
[Ipsi, Itheta, Iphi] = deal(params.I(1), params.I(2), params.I(3));
[damppsi, damptheta, dampphi] = deal(params.damp(1), params.damp(2), params.damp(3));
g = params.g;
kelast_s = params.kelast_s;
[ks1, ks2, ks3, ks4] = deal(kelast_s(1), kelast_s(2), kelast_s(3), kelast_s(4));
kelast_w = params.kelast_w;
[kw1, kw2, kw3, kw4] = deal(kelast_w(1), kelast_w(2), kelast_w(3), kelast_w(4));
B = params.B;
[B1, B2, B3, B4] = deal(B(1), B(2), B(3), B(4));
Nf = params.Nf;
[N1, N2, N3, N4] = deal(Nf(1), Nf(2), Nf(3), Nf(4));

% Define local names for states and inputs
[psi, theta, phi, dpsi, dtheta, dphi] = deal(x(1), x(2), x(3), x(4), x(5), x(6));
[ddpsi, ddtheta, ddphi] = deal(xdot(4), xdot(5), xdot(6));
[P1, P2, P3, P4] = deal(u(1), u(2), u(3), u(4));

% Define the extension and twist of each FREE with respect to x
q = euler2free(x,params);
[s1, s2, s3, s4, w1, w2, w3, w4] = deal(q(1), q(2), q(3), q(4), q(5), q(6), q(7), q(8));

% Define the Jacobian, Jeul, such that: qdot = Jeul * [dpsi,dtheta,dphi]'
Jeul = calc_Jeul(x, params);

% Define the Jacobian, Jv, such that fq = Jv * u
Jv = calc_Jv(x, params);

% FREE elastomer forces
Felast = [kelast_s; kelast_w] .* q;   % linear elastomer forces/torques 

% Matrix to convert from FREE forces to torques (unused)
f2tau = calc_f2tau(x, params);

% Torques on end effector due to FREE forces, tau.
% tau = f2tau * (Jv*u + Felast);
tau = Jeul' * (Jv*u + Felast);

% Equations of Motion, f
f(1,1) = xdot(1) - dpsi;
f(2,1) = xdot(2) - dtheta;
f(3,1) = xdot(3) - dphi;
%% f(1,4) (damping term added)
f(4,1) = tau(1) - damppsi*dpsi - ((1/2).*g.*L.*m.*cos(theta).*sin(psi)+(1/4).*dpsi.^2.*L.^2.*m.*cos( ...
  psi).*cos(theta).^2.*sin(psi)+(1/4).*dtheta.^2.*L.^2.*m.*cos(psi) ...
  .*cos(theta).^2.*sin(psi)+(-1/2).*dpsi.*dtheta.*L.^2.*m.*cos( ...
  theta).*sin(psi).^2.*sin(theta)+(-1/2).*dpsi.*L.*m.*cos(psi).*cos( ...
  theta).*((-1/2).*dpsi.*L.*cos(theta).*sin(psi)+(-1/2).*dtheta.*L.* ...
  cos(psi).*sin(theta))+(1/2).*dtheta.*L.*m.*sin(psi).*sin(theta).*( ...
  (-1/2).*dpsi.*L.*cos(theta).*sin(psi)+(-1/2).*dtheta.*L.*cos(psi) ...
  .*sin(theta))+(1/2).*dphi.*dpsi.*L.^2.*m.*cos(phi).*cos(psi).*( ...
  cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(-1/2).* ...
  dphi.*dtheta.*L.^2.*m.*cos(psi).*cos(theta).*sin(phi).*(cos(psi).* ...
  sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(-1/2).*dpsi.* ...
  dtheta.*L.^2.*m.*cos(phi).*cos(theta).*sin(psi).*(cos(psi).*sin( ...
  phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(-1/4).*dphi.^2.*L.^2.* ...
  m.*sin(phi).*sin(psi).*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin( ...
  psi).*sin(theta))+(-1/4).*dpsi.^2.*L.^2.*m.*sin(phi).*sin(psi).*( ...
  cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(-1/4).* ...
  dphi.^2.*L.^2.*m.*cos(phi).*cos(psi).*sin(theta).*(cos(psi).*sin( ...
  phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(-1/4).*dpsi.^2.*L.^2.* ...
  m.*cos(phi).*cos(psi).*sin(theta).*(cos(psi).*sin(phi)+(-1).*cos( ...
  phi).*sin(psi).*sin(theta))+(-1/4).*dtheta.^2.*L.^2.*m.*cos(phi).* ...
  cos(psi).*sin(theta).*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi) ...
  .*sin(theta))+(1/2).*dphi.*dpsi.*L.^2.*m.*sin(phi).*sin(psi).*sin( ...
  theta).*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+ ...
  (1/2).*dphi.*dtheta.*L.^2.*m.*cos(phi).*cos(psi).*cos(theta).*( ...
  cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+(-1/2).* ...
  dphi.*dpsi.*L.^2.*m.*cos(psi).*sin(phi).*(cos(phi).*cos(psi)+(-1) ...
  .*sin(phi).*sin(psi).*sin(theta))+(-1/4).*dphi.^2.*L.^2.*m.*cos( ...
  phi).*sin(psi).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin( ...
  theta))+(-1/4).*dpsi.^2.*L.^2.*m.*cos(phi).*sin(psi).*(cos(phi).* ...
  cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+(-1/2).*dpsi.* ...
  dtheta.*L.^2.*m.*cos(theta).*sin(phi).*sin(psi).*(cos(phi).*cos( ...
  psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+(-1/4).*dphi.^2.*L.^2.* ...
  m.*cos(psi).*sin(phi).*sin(theta).*(cos(phi).*cos(psi)+(-1).*sin( ...
  phi).*sin(psi).*sin(theta))+(-1/4).*dpsi.^2.*L.^2.*m.*cos(psi).* ...
  sin(phi).*sin(theta).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi) ...
  .*sin(theta))+(-1/4).*dtheta.^2.*L.^2.*m.*cos(psi).*sin(phi).*sin( ...
  theta).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+ ...
  (-1/2).*dphi.*dpsi.*L.^2.*m.*cos(phi).*sin(psi).*sin(theta).*(cos( ...
  phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+(1/4).*L.^2.* ...
  m.*(dtheta.*cos(phi).*cos(psi).*cos(theta)+dpsi.*cos(psi).*sin( ...
  phi)+dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin( ...
  theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin(theta)).*(dphi.*cos( ...
  phi).*cos(psi)+(-1).*dtheta.*cos(phi).*cos(theta).*sin(psi)+(-1).* ...
  dpsi.*sin(phi).*sin(psi)+(-1).*dpsi.*cos(phi).*cos(psi).*sin( ...
  theta)+dphi.*sin(phi).*sin(psi).*sin(theta))+(1/4).*L.^2.*m.*((-1) ...
  .*dphi.*cos(psi).*sin(phi)+(-1).*dpsi.*cos(phi).*sin(psi)+(-1).* ...
  dtheta.*cos(theta).*sin(phi).*sin(psi)+(-1).*dpsi.*cos(psi).*sin( ...
  phi).*sin(theta)+(-1).*dphi.*cos(phi).*sin(psi).*sin(theta)).*( ...
  dpsi.*cos(phi).*cos(psi)+dtheta.*cos(psi).*cos(theta).*sin(phi)+( ...
  -1).*dphi.*sin(phi).*sin(psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).*sin(psi).*sin(theta))+ddtheta.*((1/4).* ...
  L.^2.*m.*cos(psi).*cos(theta).*sin(psi).*sin(theta)+(1/4).*L.^2.* ...
  m.*cos(phi).*cos(psi).*cos(theta).*(cos(psi).*sin(phi)+(-1).*cos( ...
  phi).*sin(psi).*sin(theta))+(1/4).*L.^2.*m.*cos(psi).*cos(theta).* ...
  sin(phi).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta) ...
  ))+ddphi.*((1/4).*L.^2.*m.*cos(phi).*sin(psi).*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(-1/4).*L.^2.*m.*cos(psi).* ...
  sin(phi).*sin(theta).*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi) ...
  .*sin(theta))+(-1/4).*L.^2.*m.*sin(phi).*sin(psi).*(cos(phi).*cos( ...
  psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+(1/4).*L.^2.*m.*cos( ...
  phi).*cos(psi).*sin(theta).*(cos(phi).*cos(psi)+(-1).*sin(phi).* ...
  sin(psi).*sin(theta)))+ddpsi.*(Ipsi+(1/4).*L.^2.*m.*cos(theta) ...
  .^2.*sin(psi).^2+(1/4).*L.^2.*m.*cos(psi).*sin(phi).*(cos(psi).* ...
  sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(-1/4).*L.^2.*m.* ...
  cos(phi).*sin(psi).*sin(theta).*(cos(psi).*sin(phi)+(-1).*cos(phi) ...
  .*sin(psi).*sin(theta))+(1/4).*L.^2.*m.*cos(phi).*cos(psi).*(cos( ...
  phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+(-1/4).* ...
  L.^2.*m.*sin(phi).*sin(psi).*sin(theta).*(cos(phi).*cos(psi)+(-1) ...
  .*sin(phi).*sin(psi).*sin(theta)))+(-1/2).*m.*(2.*((-1/2).*dpsi.* ...
  L.*cos(theta).*sin(psi)+(-1/2).*dtheta.*L.*cos(psi).*sin(theta)).* ...
  ((-1/2).*dpsi.*L.*cos(psi).*cos(theta)+(1/2).*dtheta.*L.*sin(psi) ...
  .*sin(theta))+(1/2).*L.^2.*(dtheta.*cos(phi).*cos(psi).*cos(theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi).*sin(psi)+(-1).*dphi.* ...
  cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos(phi).*sin(psi).* ...
  sin(theta)).*(dphi.*cos(phi).*cos(psi)+(-1).*dtheta.*cos(phi).* ...
  cos(theta).*sin(psi)+(-1).*dpsi.*sin(phi).*sin(psi)+(-1).*dpsi.* ...
  cos(phi).*cos(psi).*sin(theta)+dphi.*sin(phi).*sin(psi).*sin( ...
  theta))+(1/2).*L.^2.*((-1).*dphi.*cos(psi).*sin(phi)+(-1).*dpsi.* ...
  cos(phi).*sin(psi)+(-1).*dtheta.*cos(theta).*sin(phi).*sin(psi)+( ...
  -1).*dpsi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dphi.*cos(phi).* ...
  sin(psi).*sin(theta)).*(dpsi.*cos(phi).*cos(psi)+dtheta.*cos(psi) ...
  .*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin(psi)+dphi.*cos( ...
  phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).*sin(psi).*sin( ...
  theta)))); 
%% f(1,5) (damping term added)
f(5,1) = tau(2) - damptheta*dtheta - ((1/2).*dphi.*dpsi.*L.^2.*m.*cos(phi).^2.*cos(psi).^2.*cos(theta)+( ...
  -1/2).*dphi.*dpsi.*L.^2.*m.*cos(psi).^2.*cos(theta).*sin(phi).^2+( ...
  -1/2).*dpsi.*dtheta.*L.^2.*m.*cos(phi).^2.*cos(psi).*cos(theta) ...
  .^2.*sin(psi)+(-1/2).*dphi.^2.*L.^2.*m.*cos(phi).*cos(psi).*cos( ...
  theta).*sin(phi).*sin(psi)+(-1/2).*dpsi.^2.*L.^2.*m.*cos(phi).* ...
  cos(psi).*cos(theta).*sin(phi).*sin(psi)+(-1/2).*dpsi.*dtheta.* ...
  L.^2.*m.*cos(psi).*cos(theta).^2.*sin(phi).^2.*sin(psi)+ddphi.*(( ...
  1/4).*L.^2.*m.*cos(phi).^2.*cos(psi).*cos(theta).*sin(psi)+(-1/4) ...
  .*L.^2.*m.*cos(psi).*cos(theta).*sin(phi).^2.*sin(psi))+(1/2).*g.* ...
  L.*m.*cos(psi).*sin(theta)+(1/4).*dpsi.^2.*L.^2.*m.*cos(psi).^2.* ...
  cos(theta).*sin(theta)+(1/4).*dtheta.^2.*L.^2.*m.*cos(psi).^2.* ...
  cos(theta).*sin(theta)+(-1/4).*dphi.^2.*L.^2.*m.*cos(phi).^2.*cos( ...
  psi).^2.*cos(theta).*sin(theta)+(-1/4).*dpsi.^2.*L.^2.*m.*cos(phi) ...
  .^2.*cos(psi).^2.*cos(theta).*sin(theta)+(-1/4).*dtheta.^2.*L.^2.* ...
  m.*cos(phi).^2.*cos(psi).^2.*cos(theta).*sin(theta)+(-1/4).* ...
  dphi.^2.*L.^2.*m.*cos(psi).^2.*cos(theta).*sin(phi).^2.*sin(theta)+(-1/4).*dpsi.^2.*L.^2.*m.*cos(psi).^2.*cos(theta).*sin(phi).^2.* ...
  sin(theta)+(-1/4).*dtheta.^2.*L.^2.*m.*cos(psi).^2.*cos(theta).* ...
  sin(phi).^2.*sin(theta)+(-1/2).*dpsi.*dtheta.*L.^2.*m.*cos(psi).* ...
  sin(psi).*sin(theta).^2+(-1/2).*dtheta.*L.*m.*cos(psi).*cos(theta) ...
  .*((-1/2).*dpsi.*L.*cos(theta).*sin(psi)+(-1/2).*dtheta.*L.*cos( ...
  psi).*sin(theta))+(1/2).*dpsi.*L.*m.*sin(psi).*sin(theta).*((-1/2) ...
  .*dpsi.*L.*cos(theta).*sin(psi)+(-1/2).*dtheta.*L.*cos(psi).*sin( ...
  theta))+(-1/4).*dphi.*L.^2.*m.*cos(psi).*cos(theta).*sin(phi).*( ...
  dtheta.*cos(phi).*cos(psi).*cos(theta)+dpsi.*cos(psi).*sin(phi)+ ...
  dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin( ...
  theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin(theta))+(-1/4).*dpsi.* ...
  L.^2.*m.*cos(phi).*cos(theta).*sin(psi).*(dtheta.*cos(phi).*cos( ...
  psi).*cos(theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi).*sin(psi) ...
  +(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos(phi).* ...
  sin(psi).*sin(theta))+(-1/4).*dtheta.*L.^2.*m.*cos(phi).*cos(psi) ...
  .*sin(theta).*(dtheta.*cos(phi).*cos(psi).*cos(theta)+dpsi.*cos( ...
  psi).*sin(phi)+dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin( ...
  phi).*sin(theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin(theta))+(1/4) ...
  .*dphi.*L.^2.*m.*cos(phi).*cos(psi).*cos(theta).*(dpsi.*cos(phi).* ...
  cos(psi)+dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin( ...
  phi).*sin(psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.* ...
  sin(phi).*sin(psi).*sin(theta))+(-1/4).*dpsi.*L.^2.*m.*cos(theta) ...
  .*sin(phi).*sin(psi).*(dpsi.*cos(phi).*cos(psi)+dtheta.*cos(psi).* ...
  cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin(psi)+dphi.*cos(phi) ...
  .*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).*sin(psi).*sin(theta)) ...
  +(-1/4).*dtheta.*L.^2.*m.*cos(psi).*sin(phi).*sin(theta).*(dpsi.* ...
  cos(phi).*cos(psi)+dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).* ...
  dphi.*sin(phi).*sin(psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1) ...
  .*dpsi.*sin(phi).*sin(psi).*sin(theta))+ddpsi.*((1/2).*L.^2.*m.* ...
  cos(phi).*cos(psi).^2.*cos(theta).*sin(phi)+(1/4).*L.^2.*m.*cos( ...
  psi).*cos(theta).*sin(psi).*sin(theta)+(-1/4).*L.^2.*m.*cos(phi) ...
  .^2.*cos(psi).*cos(theta).*sin(psi).*sin(theta)+(-1/4).*L.^2.*m.* ...
  cos(psi).*cos(theta).*sin(phi).^2.*sin(psi).*sin(theta))+ddtheta.* ...
  (Itheta+(1/4).*L.^2.*m.*cos(phi).^2.*cos(psi).^2.*cos(theta).^2+( ...
  1/4).*L.^2.*m.*cos(psi).^2.*cos(theta).^2.*sin(phi).^2+(1/4).* ...
  L.^2.*m.*cos(psi).^2.*sin(theta).^2)+(-1/2).*m.*(2.*((-1/2).* ...
  dpsi.*L.*cos(theta).*sin(psi)+(-1/2).*dtheta.*L.*cos(psi).*sin( ...
  theta)).*((-1/2).*dtheta.*L.*cos(psi).*cos(theta)+(-1/2).*dpsi.* ...
  L.*sin(psi).*sin(theta))+(1/2).*L.^2.*((-1).*dphi.*cos(psi).*cos( ...
  theta).*sin(phi)+(-1).*dpsi.*cos(phi).*cos(theta).*sin(psi)+(-1).* ...
  dtheta.*cos(phi).*cos(psi).*sin(theta)).*(dtheta.*cos(phi).*cos( ...
  psi).*cos(theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi).*sin(psi) ...
  +(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos(phi).* ...
  sin(psi).*sin(theta))+(1/2).*L.^2.*(dphi.*cos(phi).*cos(psi).*cos( ...
  theta)+(-1).*dpsi.*cos(theta).*sin(phi).*sin(psi)+(-1).*dtheta.* ...
  cos(psi).*sin(phi).*sin(theta)).*(dpsi.*cos(phi).*cos(psi)+ ...
  dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin( ...
  psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).* ...
  sin(psi).*sin(theta)))); 
%% f(1,6) (damping term added)
f(6,1) = tau(3) - dampphi*dphi - ((1/2).*dphi.*dtheta.*L.^2.*m.*cos(phi).*cos(psi).*cos(theta).*(( ...
  -1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+(-1/2).* ...
  dphi.*dpsi.*L.^2.*m.*cos(psi).*sin(phi).*((-1).*sin(phi).*sin(psi) ...
  +cos(phi).*cos(psi).*sin(theta))+(-1/4).*dphi.^2.*L.^2.*m.*cos( ...
  phi).*sin(psi).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin( ...
  theta))+(-1/4).*dpsi.^2.*L.^2.*m.*cos(phi).*sin(psi).*((-1).*sin( ...
  phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+(-1/2).*dpsi.* ...
  dtheta.*L.^2.*m.*cos(theta).*sin(phi).*sin(psi).*((-1).*sin(phi).* ...
  sin(psi)+cos(phi).*cos(psi).*sin(theta))+(-1/4).*dphi.^2.*L.^2.* ...
  m.*cos(psi).*sin(phi).*sin(theta).*((-1).*sin(phi).*sin(psi)+cos( ...
  phi).*cos(psi).*sin(theta))+(-1/4).*dpsi.^2.*L.^2.*m.*cos(psi).* ...
  sin(phi).*sin(theta).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi) ...
  .*sin(theta))+(-1/4).*dtheta.^2.*L.^2.*m.*cos(psi).*sin(phi).*sin( ...
  theta).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+ ...
  (-1/2).*dphi.*dpsi.*L.^2.*m.*cos(phi).*sin(psi).*sin(theta).*((-1) ...
  .*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+(1/2).*dphi.* ...
  dpsi.*L.^2.*m.*cos(phi).*cos(psi).*(cos(phi).*sin(psi)+(-1).*cos( ...
  psi).*sin(phi).*sin(theta))+(-1/2).*dphi.*dtheta.*L.^2.*m.*cos( ...
  psi).*cos(theta).*sin(phi).*(cos(phi).*sin(psi)+(-1).*cos(psi).* ...
  sin(phi).*sin(theta))+(-1/2).*dpsi.*dtheta.*L.^2.*m.*cos(phi).* ...
  cos(theta).*sin(psi).*(cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi) ...
  .*sin(theta))+(-1/4).*dphi.^2.*L.^2.*m.*sin(phi).*sin(psi).*(cos( ...
  phi).*sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(-1/4).* ...
  dpsi.^2.*L.^2.*m.*sin(phi).*sin(psi).*(cos(phi).*sin(psi)+(-1).* ...
  cos(psi).*sin(phi).*sin(theta))+(-1/4).*dphi.^2.*L.^2.*m.*cos(phi) ...
  .*cos(psi).*sin(theta).*(cos(phi).*sin(psi)+(-1).*cos(psi).*sin( ...
  phi).*sin(theta))+(-1/4).*dpsi.^2.*L.^2.*m.*cos(phi).*cos(psi).* ...
  sin(theta).*(cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).*sin( ...
  theta))+(-1/4).*dtheta.^2.*L.^2.*m.*cos(phi).*cos(psi).*sin(theta) ...
  .*(cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(1/2) ...
  .*dphi.*dpsi.*L.^2.*m.*sin(phi).*sin(psi).*sin(theta).*(cos(phi).* ...
  sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(1/4).*L.^2.*m.*( ...
  dtheta.*cos(phi).*cos(psi).*cos(theta)+(-1).*dpsi.*cos(psi).*sin( ...
  phi)+(-1).*dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi) ...
  .*sin(theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin(theta)).*(dpsi.* ...
  cos(phi).*cos(psi)+dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).* ...
  dphi.*sin(phi).*sin(psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1) ...
  .*dpsi.*sin(phi).*sin(psi).*sin(theta))+(1/4).*L.^2.*m.*(dtheta.* ...
  cos(phi).*cos(psi).*cos(theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos( ...
  phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).* ...
  dpsi.*cos(phi).*sin(psi).*sin(theta)).*(dpsi.*cos(phi).*cos(psi)+( ...
  -1).*dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).* ...
  sin(psi)+(-1).*dphi.*cos(phi).*cos(psi).*sin(theta)+dpsi.*sin(phi) ...
  .*sin(psi).*sin(theta))+ddtheta.*((1/4).*L.^2.*m.*cos(psi).*cos( ...
  theta).*sin(phi).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).* ...
  sin(theta))+(1/4).*L.^2.*m.*cos(phi).*cos(psi).*cos(theta).*(cos( ...
  phi).*sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta)))+ddphi.*( ...
  Iphi+(-1/4).*L.^2.*m.*sin(phi).*sin(psi).*((-1).*sin(phi).*sin( ...
  psi)+cos(phi).*cos(psi).*sin(theta))+(1/4).*L.^2.*m.*cos(phi).* ...
  cos(psi).*sin(theta).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi) ...
  .*sin(theta))+(1/4).*L.^2.*m.*cos(phi).*sin(psi).*(cos(phi).*sin( ...
  psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(-1/4).*L.^2.*m.*cos( ...
  psi).*sin(phi).*sin(theta).*(cos(phi).*sin(psi)+(-1).*cos(psi).* ...
  sin(phi).*sin(theta)))+ddpsi.*((1/4).*L.^2.*m.*cos(phi).*cos(psi) ...
  .*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+(-1/4) ...
  .*L.^2.*m.*sin(phi).*sin(psi).*sin(theta).*((-1).*sin(phi).*sin( ...
  psi)+cos(phi).*cos(psi).*sin(theta))+(1/4).*L.^2.*m.*cos(psi).* ...
  sin(phi).*(cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta) ...
  )+(-1/4).*L.^2.*m.*cos(phi).*sin(psi).*sin(theta).*(cos(phi).*sin( ...
  psi)+(-1).*cos(psi).*sin(phi).*sin(theta)))+(-1/2).*m.*((1/2).* ...
  L.^2.*(dtheta.*cos(phi).*cos(psi).*cos(theta)+(-1).*dpsi.*cos(psi) ...
  .*sin(phi)+(-1).*dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos(psi).* ...
  sin(phi).*sin(theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin(theta)).* ...
  (dpsi.*cos(phi).*cos(psi)+dtheta.*cos(psi).*cos(theta).*sin(phi)+( ...
  -1).*dphi.*sin(phi).*sin(psi)+dphi.*cos(phi).*cos(psi).*sin(theta) ...
  +(-1).*dpsi.*sin(phi).*sin(psi).*sin(theta))+(1/2).*L.^2.*( ...
  dtheta.*cos(phi).*cos(psi).*cos(theta)+dpsi.*cos(psi).*sin(phi)+ ...
  dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin( ...
  theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin(theta)).*(dpsi.*cos( ...
  phi).*cos(psi)+(-1).*dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).* ...
  dphi.*sin(phi).*sin(psi)+(-1).*dphi.*cos(phi).*cos(psi).*sin( ...
  theta)+dpsi.*sin(phi).*sin(psi).*sin(theta)))); 


% Gradients of equations of motion

%% dfdx
dfdx = [...
    0, 0, 0, -1, 0, 0;...
    0, 0, 0, 0, -1, 0;...
    0, 0, 0, 0, 0, -1;...
    (-1/2).*g.*L.*m.*cos(psi).*cos(theta)+(-1/4).*dpsi.^2.*L.^2.*m.* ...
    cos(psi).^2.*cos(theta).^2+(-1/4).*dtheta.^2.*L.^2.*m.*cos(psi) ...
    .^2.*cos(theta).^2+(1/4).*dpsi.^2.*L.^2.*m.*cos(theta).^2.*sin( ...
    psi).^2+(1/4).*dtheta.^2.*L.^2.*m.*cos(theta).^2.*sin(psi).^2+ ...
    dpsi.*dtheta.*L.^2.*m.*cos(psi).*cos(theta).*sin(psi).*sin(theta)+ ...
    (-1/2).*dpsi.*L.*m.*cos(theta).*sin(psi).*((-1/2).*dpsi.*L.*cos( ...
    theta).*sin(psi)+(-1/2).*dtheta.*L.*cos(psi).*sin(theta))+(-1/2).* ...
    dtheta.*L.*m.*cos(psi).*sin(theta).*((-1/2).*dpsi.*L.*cos(theta).* ...
    sin(psi)+(-1/2).*dtheta.*L.*cos(psi).*sin(theta))+(-1/2).*dphi.* ...
    dpsi.*L.^2.*m.*cos(phi).*cos(psi).*((-1).*sin(phi).*sin(psi)+(-1) ...
    .*cos(phi).*cos(psi).*sin(theta))+(1/2).*dphi.*dtheta.*L.^2.*m.* ...
    cos(psi).*cos(theta).*sin(phi).*((-1).*sin(phi).*sin(psi)+(-1).* ...
    cos(phi).*cos(psi).*sin(theta))+(1/2).*dpsi.*dtheta.*L.^2.*m.*cos( ...
    phi).*cos(theta).*sin(psi).*((-1).*sin(phi).*sin(psi)+(-1).*cos( ...
    phi).*cos(psi).*sin(theta))+(1/4).*dphi.^2.*L.^2.*m.*sin(phi).* ...
    sin(psi).*((-1).*sin(phi).*sin(psi)+(-1).*cos(phi).*cos(psi).*sin( ...
    theta))+(1/4).*dpsi.^2.*L.^2.*m.*sin(phi).*sin(psi).*((-1).*sin( ...
    phi).*sin(psi)+(-1).*cos(phi).*cos(psi).*sin(theta))+(1/4).* ...
    dphi.^2.*L.^2.*m.*cos(phi).*cos(psi).*sin(theta).*((-1).*sin(phi) ...
    .*sin(psi)+(-1).*cos(phi).*cos(psi).*sin(theta))+(1/4).*dpsi.^2.* ...
    L.^2.*m.*cos(phi).*cos(psi).*sin(theta).*((-1).*sin(phi).*sin(psi)+(-1).*cos(phi).*cos(psi).*sin(theta))+(1/4).*dtheta.^2.*L.^2.*m.* ...
    cos(phi).*cos(psi).*sin(theta).*((-1).*sin(phi).*sin(psi)+(-1).* ...
    cos(phi).*cos(psi).*sin(theta))+(-1/2).*dphi.*dpsi.*L.^2.*m.*sin( ...
    phi).*sin(psi).*sin(theta).*((-1).*sin(phi).*sin(psi)+(-1).*cos( ...
    phi).*cos(psi).*sin(theta))+(-1/2).*dphi.*dtheta.*L.^2.*m.*cos( ...
    phi).*cos(psi).*cos(theta).*((-1).*cos(phi).*sin(psi)+(-1).*cos( ...
    psi).*sin(phi).*sin(theta))+(1/2).*dphi.*dpsi.*L.^2.*m.*cos(psi).* ...
    sin(phi).*((-1).*cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).*sin( ...
    theta))+(1/4).*dphi.^2.*L.^2.*m.*cos(phi).*sin(psi).*((-1).*cos( ...
    phi).*sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(1/4).* ...
    dpsi.^2.*L.^2.*m.*cos(phi).*sin(psi).*((-1).*cos(phi).*sin(psi)+( ...
    -1).*cos(psi).*sin(phi).*sin(theta))+(1/2).*dpsi.*dtheta.*L.^2.* ...
    m.*cos(theta).*sin(phi).*sin(psi).*((-1).*cos(phi).*sin(psi)+(-1) ...
    .*cos(psi).*sin(phi).*sin(theta))+(1/4).*dphi.^2.*L.^2.*m.*cos( ...
    psi).*sin(phi).*sin(theta).*((-1).*cos(phi).*sin(psi)+(-1).*cos( ...
    psi).*sin(phi).*sin(theta))+(1/4).*dpsi.^2.*L.^2.*m.*cos(psi).* ...
    sin(phi).*sin(theta).*((-1).*cos(phi).*sin(psi)+(-1).*cos(psi).* ...
    sin(phi).*sin(theta))+(1/4).*dtheta.^2.*L.^2.*m.*cos(psi).*sin( ...
    phi).*sin(theta).*((-1).*cos(phi).*sin(psi)+(-1).*cos(psi).*sin( ...
    phi).*sin(theta))+(1/2).*dphi.*dpsi.*L.^2.*m.*cos(phi).*sin(psi).* ...
    sin(theta).*((-1).*cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).* ...
    sin(theta))+(1/2).*dpsi.*L.*m.*cos(psi).*cos(theta).*((-1/2).* ...
    dpsi.*L.*cos(psi).*cos(theta)+(1/2).*dtheta.*L.*sin(psi).*sin( ...
    theta))+(-1/2).*dtheta.*L.*m.*sin(psi).*sin(theta).*((-1/2).* ...
    dpsi.*L.*cos(psi).*cos(theta)+(1/2).*dtheta.*L.*sin(psi).*sin( ...
    theta))+(1/2).*dpsi.*dtheta.*L.^2.*m.*cos(phi).*cos(psi).*cos( ...
    theta).*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+ ...
    (1/4).*dphi.^2.*L.^2.*m.*cos(psi).*sin(phi).*(cos(psi).*sin(phi)+( ...
    -1).*cos(phi).*sin(psi).*sin(theta))+(1/4).*dpsi.^2.*L.^2.*m.*cos( ...
    psi).*sin(phi).*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin( ...
    theta))+(1/2).*dphi.*dpsi.*L.^2.*m.*cos(phi).*sin(psi).*(cos(psi) ...
    .*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(-1/2).*dphi.* ...
    dtheta.*L.^2.*m.*cos(theta).*sin(phi).*sin(psi).*(cos(psi).*sin( ...
    phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(-1/2).*dphi.*dpsi.* ...
    L.^2.*m.*cos(psi).*sin(phi).*sin(theta).*(cos(psi).*sin(phi)+(-1) ...
    .*cos(phi).*sin(psi).*sin(theta))+(-1/4).*dphi.^2.*L.^2.*m.*cos( ...
    phi).*sin(psi).*sin(theta).*(cos(psi).*sin(phi)+(-1).*cos(phi).* ...
    sin(psi).*sin(theta))+(-1/4).*dpsi.^2.*L.^2.*m.*cos(phi).*sin(psi) ...
    .*sin(theta).*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin( ...
    theta))+(-1/4).*dtheta.^2.*L.^2.*m.*cos(phi).*sin(psi).*sin(theta) ...
    .*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(-1/4) ...
    .*L.^2.*m.*((-1).*dphi.*cos(psi).*sin(phi)+(-1).*dpsi.*cos(phi).* ...
    sin(psi)+(-1).*dtheta.*cos(theta).*sin(phi).*sin(psi)+(-1).*dpsi.* ...
    cos(psi).*sin(phi).*sin(theta)+(-1).*dphi.*cos(phi).*sin(psi).* ...
    sin(theta)).^2+(-1/4).*L.^2.*m.*(dtheta.*cos(phi).*cos(psi).*cos( ...
    theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi).*sin(psi)+(-1).* ...
    dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos(phi).*sin( ...
    psi).*sin(theta)).*((-1).*dtheta.*cos(phi).*cos(psi).*cos(theta)+( ...
    -1).*dpsi.*cos(psi).*sin(phi)+(-1).*dphi.*cos(phi).*sin(psi)+ ...
    dphi.*cos(psi).*sin(phi).*sin(theta)+dpsi.*cos(phi).*sin(psi).* ...
    sin(theta))+(1/4).*dphi.^2.*L.^2.*m.*cos(phi).*cos(psi).*(cos(phi) ...
    .*cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+(1/4).*dpsi.^2.* ...
    L.^2.*m.*cos(phi).*cos(psi).*(cos(phi).*cos(psi)+(-1).*sin(phi).* ...
    sin(psi).*sin(theta))+(1/2).*dpsi.*dtheta.*L.^2.*m.*cos(psi).*cos( ...
    theta).*sin(phi).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).* ...
    sin(theta))+(1/2).*dphi.*dtheta.*L.^2.*m.*cos(phi).*cos(theta).* ...
    sin(psi).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta) ...
    )+(-1/2).*dphi.*dpsi.*L.^2.*m.*sin(phi).*sin(psi).*(cos(phi).*cos( ...
    psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+(1/2).*dphi.*dpsi.* ...
    L.^2.*m.*cos(phi).*cos(psi).*sin(theta).*(cos(phi).*cos(psi)+(-1) ...
    .*sin(phi).*sin(psi).*sin(theta))+(-1/4).*dphi.^2.*L.^2.*m.*sin( ...
    phi).*sin(psi).*sin(theta).*(cos(phi).*cos(psi)+(-1).*sin(phi).* ...
    sin(psi).*sin(theta))+(-1/4).*dpsi.^2.*L.^2.*m.*sin(phi).*sin(psi) ...
    .*sin(theta).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin( ...
    theta))+(-1/4).*dtheta.^2.*L.^2.*m.*sin(phi).*sin(psi).*sin(theta) ...
    .*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+(-1/4) ...
    .*L.^2.*m.*(dphi.*cos(phi).*cos(psi)+(-1).*dtheta.*cos(phi).*cos( ...
    theta).*sin(psi)+(-1).*dpsi.*sin(phi).*sin(psi)+(-1).*dpsi.*cos( ...
    phi).*cos(psi).*sin(theta)+dphi.*sin(phi).*sin(psi).*sin(theta)) ...
    .^2+(-1/4).*L.^2.*m.*(dpsi.*cos(phi).*cos(psi)+dtheta.*cos(psi).* ...
    cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin(psi)+dphi.*cos(phi) ...
    .*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).*sin(psi).*sin(theta)) ...
    .*((-1).*dpsi.*cos(phi).*cos(psi)+(-1).*dtheta.*cos(psi).*cos( ...
    theta).*sin(phi)+dphi.*sin(phi).*sin(psi)+(-1).*dphi.*cos(phi).* ...
    cos(psi).*sin(theta)+dpsi.*sin(phi).*sin(psi).*sin(theta))+(-1).* ...
    ddtheta.*((1/4).*L.^2.*m.*cos(psi).^2.*cos(theta).*sin(theta)+( ...
    -1/4).*L.^2.*m.*cos(theta).*sin(psi).^2.*sin(theta)+(1/4).*L.^2.* ...
    m.*cos(phi).*cos(psi).*cos(theta).*((-1).*sin(phi).*sin(psi)+(-1) ...
    .*cos(phi).*cos(psi).*sin(theta))+(1/4).*L.^2.*m.*cos(psi).*cos( ...
    theta).*sin(phi).*((-1).*cos(phi).*sin(psi)+(-1).*cos(psi).*sin( ...
    phi).*sin(theta))+(-1/4).*L.^2.*m.*cos(phi).*cos(theta).*sin(psi) ...
    .*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(-1/4) ...
    .*L.^2.*m.*cos(theta).*sin(phi).*sin(psi).*(cos(phi).*cos(psi)+( ...
    -1).*sin(phi).*sin(psi).*sin(theta)))+(-1).*ddpsi.*((1/2).*L.^2.* ...
    m.*cos(psi).*cos(theta).^2.*sin(psi)+(1/4).*L.^2.*m.*cos(psi).* ...
    sin(phi).*((-1).*sin(phi).*sin(psi)+(-1).*cos(phi).*cos(psi).*sin( ...
    theta))+(-1/4).*L.^2.*m.*cos(phi).*sin(psi).*sin(theta).*((-1).* ...
    sin(phi).*sin(psi)+(-1).*cos(phi).*cos(psi).*sin(theta))+(1/4).* ...
    L.^2.*m.*cos(phi).*cos(psi).*((-1).*cos(phi).*sin(psi)+(-1).*cos( ...
    psi).*sin(phi).*sin(theta))+(-1/4).*L.^2.*m.*sin(phi).*sin(psi).* ...
    sin(theta).*((-1).*cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).* ...
    sin(theta))+(-1/4).*L.^2.*m.*sin(phi).*sin(psi).*(cos(psi).*sin( ...
    phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(-1/4).*L.^2.*m.*cos( ...
    phi).*cos(psi).*sin(theta).*(cos(psi).*sin(phi)+(-1).*cos(phi).* ...
    sin(psi).*sin(theta))+(-1/4).*L.^2.*m.*cos(phi).*sin(psi).*(cos( ...
    phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+(-1/4).* ...
    L.^2.*m.*cos(psi).*sin(phi).*sin(theta).*(cos(phi).*cos(psi)+(-1) ...
    .*sin(phi).*sin(psi).*sin(theta)))+(-1).*ddphi.*((1/4).*L.^2.*m.* ...
    cos(phi).*sin(psi).*((-1).*sin(phi).*sin(psi)+(-1).*cos(phi).*cos( ...
    psi).*sin(theta))+(-1/4).*L.^2.*m.*cos(psi).*sin(phi).*sin(theta) ...
    .*((-1).*sin(phi).*sin(psi)+(-1).*cos(phi).*cos(psi).*sin(theta))+ ...
    (-1/4).*L.^2.*m.*sin(phi).*sin(psi).*((-1).*cos(phi).*sin(psi)+( ...
    -1).*cos(psi).*sin(phi).*sin(theta))+(1/4).*L.^2.*m.*cos(phi).* ...
    cos(psi).*sin(theta).*((-1).*cos(phi).*sin(psi)+(-1).*cos(psi).* ...
    sin(phi).*sin(theta))+(1/4).*L.^2.*m.*cos(phi).*cos(psi).*(cos( ...
    psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(1/4).*L.^2.* ...
    m.*sin(phi).*sin(psi).*sin(theta).*(cos(psi).*sin(phi)+(-1).*cos( ...
    phi).*sin(psi).*sin(theta))+(-1/4).*L.^2.*m.*cos(psi).*sin(phi).*( ...
    cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+(-1/4).* ...
    L.^2.*m.*cos(phi).*sin(psi).*sin(theta).*(cos(phi).*cos(psi)+(-1) ...
    .*sin(phi).*sin(psi).*sin(theta)))+(1/2).*m.*(2.*((-1/2).*dpsi.* ...
    L.*cos(theta).*sin(psi)+(-1/2).*dtheta.*L.*cos(psi).*sin(theta)).* ...
    ((1/2).*dpsi.*L.*cos(theta).*sin(psi)+(1/2).*dtheta.*L.*cos(psi).* ...
    sin(theta))+2.*((-1/2).*dpsi.*L.*cos(psi).*cos(theta)+(1/2).* ...
    dtheta.*L.*sin(psi).*sin(theta)).^2+(1/2).*L.^2.*((-1).*dphi.*cos( ...
    psi).*sin(phi)+(-1).*dpsi.*cos(phi).*sin(psi)+(-1).*dtheta.*cos( ...
    theta).*sin(phi).*sin(psi)+(-1).*dpsi.*cos(psi).*sin(phi).*sin( ...
    theta)+(-1).*dphi.*cos(phi).*sin(psi).*sin(theta)).^2+(1/2).* ...
    L.^2.*(dtheta.*cos(phi).*cos(psi).*cos(theta)+dpsi.*cos(psi).*sin( ...
    phi)+dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin( ...
    theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin(theta)).*((-1).* ...
    dtheta.*cos(phi).*cos(psi).*cos(theta)+(-1).*dpsi.*cos(psi).*sin( ...
    phi)+(-1).*dphi.*cos(phi).*sin(psi)+dphi.*cos(psi).*sin(phi).*sin( ...
    theta)+dpsi.*cos(phi).*sin(psi).*sin(theta))+(1/2).*L.^2.*(dphi.* ...
    cos(phi).*cos(psi)+(-1).*dtheta.*cos(phi).*cos(theta).*sin(psi)+( ...
    -1).*dpsi.*sin(phi).*sin(psi)+(-1).*dpsi.*cos(phi).*cos(psi).*sin( ...
    theta)+dphi.*sin(phi).*sin(psi).*sin(theta)).^2+(1/2).*L.^2.*( ...
    dpsi.*cos(phi).*cos(psi)+dtheta.*cos(psi).*cos(theta).*sin(phi)+( ...
    -1).*dphi.*sin(phi).*sin(psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).*sin(psi).*sin(theta)).*((-1).*dpsi.*cos( ...
    phi).*cos(psi)+(-1).*dtheta.*cos(psi).*cos(theta).*sin(phi)+dphi.* ...
    sin(phi).*sin(psi)+(-1).*dphi.*cos(phi).*cos(psi).*sin(theta)+ ...
    dpsi.*sin(phi).*sin(psi).*sin(theta)))+b1.*cos(psi).*cos(theta).*( ...
    L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).*((a1.^2+b1.^2).* ...
    phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2).^( ...
    -1/2).*((-6).*b1.*P1.*pi.*(phi+2.*N1.*pi).^(-2).*cos(psi).*cos( ...
    theta).*(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta))+b1.* ...
    ks1.*cos(psi).*cos(theta).*(L+b1.*cos(theta).*sin(psi)+(-1).*a1.* ...
    sin(theta)).*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+( ...
    -1).*a1.*sin(theta)).^2).^(-1/2))+b2.*cos(psi).*cos(theta).*(L+ ...
    b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).*((a2.^2+b2.^2).* ...
    phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^( ...
    -1/2).*((-6).*b2.*P2.*pi.*(phi+2.*N2.*pi).^(-2).*cos(psi).*cos( ...
    theta).*(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta))+b2.* ...
    ks2.*cos(psi).*cos(theta).*(L+b2.*cos(theta).*sin(psi)+(-1).*a2.* ...
    sin(theta)).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+( ...
    -1).*a2.*sin(theta)).^2).^(-1/2))+b3.*cos(psi).*cos(theta).*(L+ ...
    b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).*((a3.^2+b3.^2).* ...
    phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^( ...
    -1/2).*((-6).*b3.*P3.*pi.*(phi+2.*N3.*pi).^(-2).*cos(psi).*cos( ...
    theta).*(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta))+b3.* ...
    ks3.*cos(psi).*cos(theta).*(L+b3.*cos(theta).*sin(psi)+(-1).*a3.* ...
    sin(theta)).*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+( ...
    -1).*a3.*sin(theta)).^2).^(-1/2))+b4.*cos(psi).*cos(theta).*(L+ ...
    b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).*((a4.^2+b4.^2).* ...
    phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^( ...
    -1/2).*((-6).*b4.*P4.*pi.*(phi+2.*N4.*pi).^(-2).*cos(psi).*cos( ...
    theta).*(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta))+b4.* ...
    ks4.*cos(psi).*cos(theta).*(L+b4.*cos(theta).*sin(psi)+(-1).*a4.* ...
    sin(theta)).*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+( ...
    -1).*a4.*sin(theta)).^2).^(-1/2))+(-1).*b1.^2.*cos(psi).^2.*cos( ...
    theta).^2.*(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2.*( ...
    (a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin( ...
    theta)).^2).^(-3/2).*(ks1.*((-1).*L+((a1.^2+b1.^2).*phi.^2+(L+b1.* ...
    cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2).^(1/2))+P1.*pi.*( ...
    phi+2.*N1.*pi).^(-2).*(B1.^2+(-3).*((a1.^2+b1.^2).*phi.^2+(L+b1.* ...
    cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2)))+b1.^2.*cos(psi) ...
    .^2.*cos(theta).^2.*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin( ...
    psi)+(-1).*a1.*sin(theta)).^2).^(-1/2).*(ks1.*((-1).*L+((a1.^2+ ...
    b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)) ...
    .^2).^(1/2))+P1.*pi.*(phi+2.*N1.*pi).^(-2).*(B1.^2+(-3).*((a1.^2+ ...
    b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)) ...
    .^2)))+(-1).*b1.*cos(theta).*sin(psi).*(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).* ...
    sin(psi)+(-1).*a1.*sin(theta)).^2).^(-1/2).*(ks1.*((-1).*L+(( ...
    a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin( ...
    theta)).^2).^(1/2))+P1.*pi.*(phi+2.*N1.*pi).^(-2).*(B1.^2+(-3).*(( ...
    a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin( ...
    theta)).^2)))+(-1).*b2.^2.*cos(psi).^2.*cos(theta).^2.*(L+b2.*cos( ...
    theta).*sin(psi)+(-1).*a2.*sin(theta)).^2.*((a2.^2+b2.^2).*phi.^2+ ...
    (L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^(-3/2).*( ...
    ks2.*((-1).*L+((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+( ...
    -1).*a2.*sin(theta)).^2).^(1/2))+P2.*pi.*(phi+2.*N2.*pi).^(-2).*( ...
    B2.^2+(-3).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+( ...
    -1).*a2.*sin(theta)).^2)))+b2.^2.*cos(psi).^2.*cos(theta).^2.*(( ...
    a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin( ...
    theta)).^2).^(-1/2).*(ks2.*((-1).*L+((a2.^2+b2.^2).*phi.^2+(L+b2.* ...
    cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^(1/2))+P2.*pi.*( ...
    phi+2.*N2.*pi).^(-2).*(B2.^2+(-3).*((a2.^2+b2.^2).*phi.^2+(L+b2.* ...
    cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).^2)))+(-1).*b2.*cos( ...
    theta).*sin(psi).*(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta) ...
    ).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.* ...
    sin(theta)).^2).^(-1/2).*(ks2.*((-1).*L+((a2.^2+b2.^2).*phi.^2+(L+ ...
    b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^(1/2))+P2.* ...
    pi.*(phi+2.*N2.*pi).^(-2).*(B2.^2+(-3).*((a2.^2+b2.^2).*phi.^2+(L+ ...
    b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).^2)))+(-1).*b3.^2.* ...
    cos(psi).^2.*cos(theta).^2.*(L+b3.*cos(theta).*sin(psi)+(-1).*a3.* ...
    sin(theta)).^2.*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^(-3/2).*(ks3.*((-1).*L+((a3.^2+b3.^2) ...
    .*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^( ...
    1/2))+P3.*pi.*(phi+2.*N3.*pi).^(-2).*(B3.^2+(-3).*((a3.^2+b3.^2).* ...
    phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2)))+ ...
    b3.^2.*cos(psi).^2.*cos(theta).^2.*((a3.^2+b3.^2).*phi.^2+(L+b3.* ...
    cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^(-1/2).*(ks3.*(( ...
    -1).*L+((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).* ...
    a3.*sin(theta)).^2).^(1/2))+P3.*pi.*(phi+2.*N3.*pi).^(-2).*(B3.^2+ ...
    (-3).*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).* ...
    a3.*sin(theta)).^2)))+(-1).*b3.*cos(theta).*sin(psi).*(L+b3.*cos( ...
    theta).*sin(psi)+(-1).*a3.*sin(theta)).*((a3.^2+b3.^2).*phi.^2+(L+ ...
    b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^(-1/2).*(ks3.* ...
    ((-1).*L+((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).* ...
    a3.*sin(theta)).^2).^(1/2))+P3.*pi.*(phi+2.*N3.*pi).^(-2).*(B3.^2+ ...
    (-3).*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).* ...
    a3.*sin(theta)).^2)))+(-1).*b4.^2.*cos(psi).^2.*cos(theta).^2.*(L+ ...
    b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2.*((a4.^2+b4.^2) ...
    .*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^( ...
    -3/2).*(ks4.*((-1).*L+((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).* ...
    sin(psi)+(-1).*a4.*sin(theta)).^2).^(1/2))+P4.*pi.*(phi+2.*N4.*pi) ...
    .^(-2).*(B4.^2+(-3).*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).* ...
    sin(psi)+(-1).*a4.*sin(theta)).^2)))+b4.^2.*cos(psi).^2.*cos( ...
    theta).^2.*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1) ...
    .*a4.*sin(theta)).^2).^(-1/2).*(ks4.*((-1).*L+((a4.^2+b4.^2).* ...
    phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^( ...
    1/2))+P4.*pi.*(phi+2.*N4.*pi).^(-2).*(B4.^2+(-3).*((a4.^2+b4.^2).* ...
    phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2)))+( ...
    -1).*b4.*cos(theta).*sin(psi).*(L+b4.*cos(theta).*sin(psi)+(-1).* ...
    a4.*sin(theta)).*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin( ...
    psi)+(-1).*a4.*sin(theta)).^2).^(-1/2).*(ks4.*((-1).*L+((a4.^2+ ...
    b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)) ...
    .^2).^(1/2))+P4.*pi.*(phi+2.*N4.*pi).^(-2).*(B4.^2+(-3).*((a4.^2+ ...
    b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)) ...
    .^2))),(1/2).*dphi.*dpsi.*L.^2.*m.*cos(phi).^2.*cos(psi).*cos( ...
    theta).*sin(psi)+(-1/2).*dphi.*dpsi.*L.^2.*m.*cos(psi).*cos(theta) ...
    .*sin(phi).^2.*sin(psi)+(1/2).*dpsi.*dtheta.*L.^2.*m.*cos(theta) ...
    .^2.*sin(psi).^2+(-1/2).*dpsi.*dtheta.*L.^2.*m.*cos(phi).^2.*cos( ...
    theta).^2.*sin(psi).^2+(-1/2).*dphi.^2.*L.^2.*m.*cos(phi).*cos( ...
    theta).*sin(phi).*sin(psi).^2+(-1/2).*dpsi.^2.*L.^2.*m.*cos(phi).* ...
    cos(theta).*sin(phi).*sin(psi).^2+(-1/2).*dpsi.*dtheta.*L.^2.*m.* ...
    cos(theta).^2.*sin(phi).^2.*sin(psi).^2+(1/2).*g.*L.*m.*sin(psi).* ...
    sin(theta)+(1/2).*dpsi.^2.*L.^2.*m.*cos(psi).*cos(theta).*sin(psi) ...
    .*sin(theta)+(1/2).*dtheta.^2.*L.^2.*m.*cos(psi).*cos(theta).*sin( ...
    psi).*sin(theta)+(-1/4).*dphi.^2.*L.^2.*m.*cos(phi).^2.*cos(psi).* ...
    cos(theta).*sin(psi).*sin(theta)+(-1/4).*dpsi.^2.*L.^2.*m.*cos( ...
    phi).^2.*cos(psi).*cos(theta).*sin(psi).*sin(theta)+(-1/4).* ...
    dtheta.^2.*L.^2.*m.*cos(phi).^2.*cos(psi).*cos(theta).*sin(psi).* ...
    sin(theta)+(-1/4).*dphi.^2.*L.^2.*m.*cos(psi).*cos(theta).*sin( ...
    phi).^2.*sin(psi).*sin(theta)+(-1/4).*dpsi.^2.*L.^2.*m.*cos(psi).* ...
    cos(theta).*sin(phi).^2.*sin(psi).*sin(theta)+(-1/4).*dtheta.^2.* ...
    L.^2.*m.*cos(psi).*cos(theta).*sin(phi).^2.*sin(psi).*sin(theta)+( ...
    -1/2).*dpsi.*dtheta.*L.^2.*m.*sin(psi).^2.*sin(theta).^2+(-1/2).* ...
    dtheta.*L.*m.*cos(theta).*sin(psi).*((-1/2).*dpsi.*L.*cos(theta).* ...
    sin(psi)+(-1/2).*dtheta.*L.*cos(psi).*sin(theta))+(-1/2).*dpsi.* ...
    L.*m.*cos(psi).*sin(theta).*((-1/2).*dpsi.*L.*cos(theta).*sin(psi)+(-1/2).*dtheta.*L.*cos(psi).*sin(theta))+(1/2).*dpsi.*L.*m.*cos( ...
    psi).*cos(theta).*((-1/2).*dtheta.*L.*cos(psi).*cos(theta)+(1/2).* ...
    dpsi.*L.*sin(psi).*sin(theta))+(-1/2).*dtheta.*L.*m.*sin(psi).* ...
    sin(theta).*((-1/2).*dtheta.*L.*cos(psi).*cos(theta)+(1/2).*dpsi.* ...
    L.*sin(psi).*sin(theta))+(1/4).*dphi.^2.*L.^2.*m.*cos(phi).*cos( ...
    psi).*cos(theta).*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).* ...
    sin(theta))+(1/4).*dpsi.^2.*L.^2.*m.*cos(phi).*cos(psi).*cos( ...
    theta).*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+ ...
    (1/4).*dtheta.^2.*L.^2.*m.*cos(phi).*cos(psi).*cos(theta).*(cos( ...
    psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(-1/2).* ...
    dphi.*dpsi.*L.^2.*m.*cos(theta).*sin(phi).*sin(psi).*(cos(psi).* ...
    sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(-1/2).*dphi.* ...
    dtheta.*L.^2.*m.*cos(psi).*sin(phi).*sin(theta).*(cos(psi).*sin( ...
    phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(-1/2).*dpsi.*dtheta.* ...
    L.^2.*m.*cos(phi).*sin(psi).*sin(theta).*(cos(psi).*sin(phi)+(-1) ...
    .*cos(phi).*sin(psi).*sin(theta))+(-1/4).*L.^2.*m.*(dphi.*cos(phi) ...
    .*cos(psi).*cos(theta)+(-1).*dpsi.*cos(theta).*sin(phi).*sin(psi)+ ...
    (-1).*dtheta.*cos(psi).*sin(phi).*sin(theta)).*((-1).*dphi.*cos( ...
    psi).*sin(phi)+(-1).*dpsi.*cos(phi).*sin(psi)+(-1).*dtheta.*cos( ...
    theta).*sin(phi).*sin(psi)+(-1).*dpsi.*cos(psi).*sin(phi).*sin( ...
    theta)+(-1).*dphi.*cos(phi).*sin(psi).*sin(theta))+(-1/4).*L.^2.* ...
    m.*(dtheta.*cos(phi).*cos(psi).*cos(theta)+dpsi.*cos(psi).*sin( ...
    phi)+dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin( ...
    theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin(theta)).*((-1).*dpsi.* ...
    cos(phi).*cos(psi).*cos(theta)+dphi.*cos(theta).*sin(phi).*sin( ...
    psi)+dtheta.*cos(phi).*sin(psi).*sin(theta))+(1/4).*dphi.^2.* ...
    L.^2.*m.*cos(psi).*cos(theta).*sin(phi).*(cos(phi).*cos(psi)+(-1) ...
    .*sin(phi).*sin(psi).*sin(theta))+(1/4).*dpsi.^2.*L.^2.*m.*cos( ...
    psi).*cos(theta).*sin(phi).*(cos(phi).*cos(psi)+(-1).*sin(phi).* ...
    sin(psi).*sin(theta))+(1/4).*dtheta.^2.*L.^2.*m.*cos(psi).*cos( ...
    theta).*sin(phi).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).* ...
    sin(theta))+(1/2).*dphi.*dpsi.*L.^2.*m.*cos(phi).*cos(theta).*sin( ...
    psi).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+( ...
    1/2).*dphi.*dtheta.*L.^2.*m.*cos(phi).*cos(psi).*sin(theta).*(cos( ...
    phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+(-1/2).* ...
    dpsi.*dtheta.*L.^2.*m.*sin(phi).*sin(psi).*sin(theta).*(cos(phi).* ...
    cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+(-1/4).*L.^2.*m.*(( ...
    -1).*dphi.*cos(psi).*cos(theta).*sin(phi)+(-1).*dpsi.*cos(phi).* ...
    cos(theta).*sin(psi)+(-1).*dtheta.*cos(phi).*cos(psi).*sin(theta)) ...
    .*(dphi.*cos(phi).*cos(psi)+(-1).*dtheta.*cos(phi).*cos(theta).* ...
    sin(psi)+(-1).*dpsi.*sin(phi).*sin(psi)+(-1).*dpsi.*cos(phi).*cos( ...
    psi).*sin(theta)+dphi.*sin(phi).*sin(psi).*sin(theta))+(-1/4).* ...
    L.^2.*m.*(dpsi.*cos(phi).*cos(psi)+dtheta.*cos(psi).*cos(theta).* ...
    sin(phi)+(-1).*dphi.*sin(phi).*sin(psi)+dphi.*cos(phi).*cos(psi).* ...
    sin(theta)+(-1).*dpsi.*sin(phi).*sin(psi).*sin(theta)).*((-1).* ...
    dpsi.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*cos(phi).*cos( ...
    theta).*sin(psi)+dtheta.*sin(phi).*sin(psi).*sin(theta))+(-1).* ...
    ddphi.*((-1/4).*L.^2.*m.*cos(phi).^2.*cos(theta).*sin(psi).^2+( ...
    1/4).*L.^2.*m.*cos(theta).*sin(phi).^2.*sin(psi).^2+(-1/4).*L.^2.* ...
    m.*cos(psi).*cos(theta).*sin(phi).*(cos(psi).*sin(phi)+(-1).*cos( ...
    phi).*sin(psi).*sin(theta))+(1/4).*L.^2.*m.*cos(phi).*cos(psi).* ...
    cos(theta).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin( ...
    theta)))+(-1).*ddpsi.*((-1/2).*L.^2.*m.*cos(phi).*cos(psi).*cos( ...
    theta).*sin(phi).*sin(psi)+(-1/2).*L.^2.*m.*cos(theta).*sin(psi) ...
    .^2.*sin(theta)+(1/4).*L.^2.*m.*cos(phi).^2.*cos(theta).*sin(psi) ...
    .^2.*sin(theta)+(1/4).*L.^2.*m.*cos(theta).*sin(phi).^2.*sin(psi) ...
    .^2.*sin(theta)+(-1/4).*L.^2.*m.*cos(phi).*cos(theta).*sin(psi).*( ...
    cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(-1/4).* ...
    L.^2.*m.*cos(theta).*sin(phi).*sin(psi).*(cos(phi).*cos(psi)+(-1) ...
    .*sin(phi).*sin(psi).*sin(theta)))+(-1).*ddtheta.*((1/4).*L.^2.* ...
    m.*cos(psi).*cos(theta).^2.*sin(psi)+(-1/4).*L.^2.*m.*cos(phi) ...
    .^2.*cos(psi).*cos(theta).^2.*sin(psi)+(-1/4).*L.^2.*m.*cos(psi).* ...
    cos(theta).^2.*sin(phi).^2.*sin(psi)+(-1/4).*L.^2.*m.*cos(psi).* ...
    sin(psi).*sin(theta).^2+(-1/4).*L.^2.*m.*cos(phi).*cos(psi).*sin( ...
    theta).*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+ ...
    (-1/4).*L.^2.*m.*cos(psi).*sin(phi).*sin(theta).*(cos(phi).*cos( ...
    psi)+(-1).*sin(phi).*sin(psi).*sin(theta)))+(1/2).*m.*(2.*((1/2).* ...
    dtheta.*L.*cos(theta).*sin(psi)+(1/2).*dpsi.*L.*cos(psi).*sin( ...
    theta)).*((-1/2).*dpsi.*L.*cos(theta).*sin(psi)+(-1/2).*dtheta.* ...
    L.*cos(psi).*sin(theta))+2.*((-1/2).*dtheta.*L.*cos(psi).*cos( ...
    theta)+(1/2).*dpsi.*L.*sin(psi).*sin(theta)).*((-1/2).*dpsi.*L.* ...
    cos(psi).*cos(theta)+(1/2).*dtheta.*L.*sin(psi).*sin(theta))+(1/2) ...
    .*L.^2.*(dphi.*cos(phi).*cos(psi).*cos(theta)+(-1).*dpsi.*cos( ...
    theta).*sin(phi).*sin(psi)+(-1).*dtheta.*cos(psi).*sin(phi).*sin( ...
    theta)).*((-1).*dphi.*cos(psi).*sin(phi)+(-1).*dpsi.*cos(phi).* ...
    sin(psi)+(-1).*dtheta.*cos(theta).*sin(phi).*sin(psi)+(-1).*dpsi.* ...
    cos(psi).*sin(phi).*sin(theta)+(-1).*dphi.*cos(phi).*sin(psi).* ...
    sin(theta))+(1/2).*L.^2.*(dtheta.*cos(phi).*cos(psi).*cos(theta)+ ...
    dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos( ...
    psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin( ...
    theta)).*((-1).*dpsi.*cos(phi).*cos(psi).*cos(theta)+dphi.*cos( ...
    theta).*sin(phi).*sin(psi)+dtheta.*cos(phi).*sin(psi).*sin(theta))+(1/2).*L.^2.*((-1).*dphi.*cos(psi).*cos(theta).*sin(phi)+(-1).* ...
    dpsi.*cos(phi).*cos(theta).*sin(psi)+(-1).*dtheta.*cos(phi).*cos( ...
    psi).*sin(theta)).*(dphi.*cos(phi).*cos(psi)+(-1).*dtheta.*cos( ...
    phi).*cos(theta).*sin(psi)+(-1).*dpsi.*sin(phi).*sin(psi)+(-1).* ...
    dpsi.*cos(phi).*cos(psi).*sin(theta)+dphi.*sin(phi).*sin(psi).* ...
    sin(theta))+(1/2).*L.^2.*(dpsi.*cos(phi).*cos(psi)+dtheta.*cos( ...
    psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin(psi)+dphi.* ...
    cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).*sin(psi).* ...
    sin(theta)).*((-1).*dpsi.*cos(psi).*cos(theta).*sin(phi)+(-1).* ...
    dphi.*cos(phi).*cos(theta).*sin(psi)+dtheta.*sin(phi).*sin(psi).* ...
    sin(theta)))+b1.*cos(psi).*cos(theta).*(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).* ...
    sin(psi)+(-1).*a1.*sin(theta)).^2).^(-1/2).*((-6).*P1.*pi.*(phi+ ...
    2.*N1.*pi).^(-2).*(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta) ...
    ).*((-1).*a1.*cos(theta)+(-1).*b1.*sin(psi).*sin(theta))+ks1.*(L+ ...
    b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).*((-1).*a1.*cos( ...
    theta)+(-1).*b1.*sin(psi).*sin(theta)).*((a1.^2+b1.^2).*phi.^2+(L+ ...
    b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2).^(-1/2))+b2.* ...
    cos(psi).*cos(theta).*(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin( ...
    theta)).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).* ...
    a2.*sin(theta)).^2).^(-1/2).*((-6).*P2.*pi.*(phi+2.*N2.*pi).^(-2) ...
    .*(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).*((-1).*a2.* ...
    cos(theta)+(-1).*b2.*sin(psi).*sin(theta))+ks2.*(L+b2.*cos(theta) ...
    .*sin(psi)+(-1).*a2.*sin(theta)).*((-1).*a2.*cos(theta)+(-1).*b2.* ...
    sin(psi).*sin(theta)).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).* ...
    sin(psi)+(-1).*a2.*sin(theta)).^2).^(-1/2))+b3.*cos(psi).*cos( ...
    theta).*(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).*(( ...
    a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin( ...
    theta)).^2).^(-1/2).*((-6).*P3.*pi.*(phi+2.*N3.*pi).^(-2).*(L+b3.* ...
    cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).*((-1).*a3.*cos(theta)+ ...
    (-1).*b3.*sin(psi).*sin(theta))+ks3.*(L+b3.*cos(theta).*sin(psi)+( ...
    -1).*a3.*sin(theta)).*((-1).*a3.*cos(theta)+(-1).*b3.*sin(psi).* ...
    sin(theta)).*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+( ...
    -1).*a3.*sin(theta)).^2).^(-1/2))+b4.*cos(psi).*cos(theta).*(L+ ...
    b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).*((a4.^2+b4.^2).* ...
    phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^( ...
    -1/2).*((-6).*P4.*pi.*(phi+2.*N4.*pi).^(-2).*(L+b4.*cos(theta).* ...
    sin(psi)+(-1).*a4.*sin(theta)).*((-1).*a4.*cos(theta)+(-1).*b4.* ...
    sin(psi).*sin(theta))+ks4.*(L+b4.*cos(theta).*sin(psi)+(-1).*a4.* ...
    sin(theta)).*((-1).*a4.*cos(theta)+(-1).*b4.*sin(psi).*sin(theta)) ...
    .*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.* ...
    sin(theta)).^2).^(-1/2))+(-1).*b1.*cos(psi).*cos(theta).*(L+b1.* ...
    cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2.*((-1).*a1.*cos( ...
    theta)+(-1).*b1.*sin(psi).*sin(theta)).*((a1.^2+b1.^2).*phi.^2+(L+ ...
    b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2).^(-3/2).*(ks1.* ...
    ((-1).*L+((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).* ...
    a1.*sin(theta)).^2).^(1/2))+P1.*pi.*(phi+2.*N1.*pi).^(-2).*(B1.^2+ ...
    (-3).*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).* ...
    a1.*sin(theta)).^2)))+(-1).*b1.*cos(psi).*sin(theta).*(L+b1.*cos( ...
    theta).*sin(psi)+(-1).*a1.*sin(theta)).*((a1.^2+b1.^2).*phi.^2+(L+ ...
    b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2).^(-1/2).*(ks1.* ...
    ((-1).*L+((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).* ...
    a1.*sin(theta)).^2).^(1/2))+P1.*pi.*(phi+2.*N1.*pi).^(-2).*(B1.^2+ ...
    (-3).*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).* ...
    a1.*sin(theta)).^2)))+b1.*cos(psi).*cos(theta).*((-1).*a1.*cos( ...
    theta)+(-1).*b1.*sin(psi).*sin(theta)).*((a1.^2+b1.^2).*phi.^2+(L+ ...
    b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2).^(-1/2).*(ks1.* ...
    ((-1).*L+((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).* ...
    a1.*sin(theta)).^2).^(1/2))+P1.*pi.*(phi+2.*N1.*pi).^(-2).*(B1.^2+ ...
    (-3).*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).* ...
    a1.*sin(theta)).^2)))+(-1).*b2.*cos(psi).*cos(theta).*(L+b2.*cos( ...
    theta).*sin(psi)+(-1).*a2.*sin(theta)).^2.*((-1).*a2.*cos(theta)+( ...
    -1).*b2.*sin(psi).*sin(theta)).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos( ...
    theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^(-3/2).*(ks2.*((-1).* ...
    L+((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.* ...
    sin(theta)).^2).^(1/2))+P2.*pi.*(phi+2.*N2.*pi).^(-2).*(B2.^2+(-3) ...
    .*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.* ...
    sin(theta)).^2)))+(-1).*b2.*cos(psi).*sin(theta).*(L+b2.*cos( ...
    theta).*sin(psi)+(-1).*a2.*sin(theta)).*((a2.^2+b2.^2).*phi.^2+(L+ ...
    b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^(-1/2).*(ks2.* ...
    ((-1).*L+((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).* ...
    a2.*sin(theta)).^2).^(1/2))+P2.*pi.*(phi+2.*N2.*pi).^(-2).*(B2.^2+ ...
    (-3).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).* ...
    a2.*sin(theta)).^2)))+b2.*cos(psi).*cos(theta).*((-1).*a2.*cos( ...
    theta)+(-1).*b2.*sin(psi).*sin(theta)).*((a2.^2+b2.^2).*phi.^2+(L+ ...
    b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^(-1/2).*(ks2.* ...
    ((-1).*L+((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).* ...
    a2.*sin(theta)).^2).^(1/2))+P2.*pi.*(phi+2.*N2.*pi).^(-2).*(B2.^2+ ...
    (-3).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).* ...
    a2.*sin(theta)).^2)))+(-1).*b3.*cos(psi).*cos(theta).*(L+b3.*cos( ...
    theta).*sin(psi)+(-1).*a3.*sin(theta)).^2.*((-1).*a3.*cos(theta)+( ...
    -1).*b3.*sin(psi).*sin(theta)).*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos( ...
    theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^(-3/2).*(ks3.*((-1).* ...
    L+((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.* ...
    sin(theta)).^2).^(1/2))+P3.*pi.*(phi+2.*N3.*pi).^(-2).*(B3.^2+(-3) ...
    .*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.* ...
    sin(theta)).^2)))+(-1).*b3.*cos(psi).*sin(theta).*(L+b3.*cos( ...
    theta).*sin(psi)+(-1).*a3.*sin(theta)).*((a3.^2+b3.^2).*phi.^2+(L+ ...
    b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^(-1/2).*(ks3.* ...
    ((-1).*L+((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).* ...
    a3.*sin(theta)).^2).^(1/2))+P3.*pi.*(phi+2.*N3.*pi).^(-2).*(B3.^2+ ...
    (-3).*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).* ...
    a3.*sin(theta)).^2)))+b3.*cos(psi).*cos(theta).*((-1).*a3.*cos( ...
    theta)+(-1).*b3.*sin(psi).*sin(theta)).*((a3.^2+b3.^2).*phi.^2+(L+ ...
    b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^(-1/2).*(ks3.* ...
    ((-1).*L+((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).* ...
    a3.*sin(theta)).^2).^(1/2))+P3.*pi.*(phi+2.*N3.*pi).^(-2).*(B3.^2+ ...
    (-3).*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).* ...
    a3.*sin(theta)).^2)))+(-1).*b4.*cos(psi).*cos(theta).*(L+b4.*cos( ...
    theta).*sin(psi)+(-1).*a4.*sin(theta)).^2.*((-1).*a4.*cos(theta)+( ...
    -1).*b4.*sin(psi).*sin(theta)).*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos( ...
    theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^(-3/2).*(ks4.*((-1).* ...
    L+((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.* ...
    sin(theta)).^2).^(1/2))+P4.*pi.*(phi+2.*N4.*pi).^(-2).*(B4.^2+(-3) ...
    .*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.* ...
    sin(theta)).^2)))+(-1).*b4.*cos(psi).*sin(theta).*(L+b4.*cos( ...
    theta).*sin(psi)+(-1).*a4.*sin(theta)).*((a4.^2+b4.^2).*phi.^2+(L+ ...
    b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^(-1/2).*(ks4.* ...
    ((-1).*L+((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).* ...
    a4.*sin(theta)).^2).^(1/2))+P4.*pi.*(phi+2.*N4.*pi).^(-2).*(B4.^2+ ...
    (-3).*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).* ...
    a4.*sin(theta)).^2)))+b4.*cos(psi).*cos(theta).*((-1).*a4.*cos( ...
    theta)+(-1).*b4.*sin(psi).*sin(theta)).*((a4.^2+b4.^2).*phi.^2+(L+ ...
    b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^(-1/2).*(ks4.* ...
    ((-1).*L+((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).* ...
    a4.*sin(theta)).^2).^(1/2))+P4.*pi.*(phi+2.*N4.*pi).^(-2).*(B4.^2+ ...
    (-3).*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).* ...
    a4.*sin(theta)).^2))),(-1/2).*dphi.*dtheta.*L.^2.*m.*cos(phi).* ...
    cos(psi).*cos(theta).*((-1).*cos(psi).*sin(phi)+(-1).*cos(phi).* ...
    sin(psi).*sin(theta))+(1/2).*dphi.*dpsi.*L.^2.*m.*cos(psi).*sin( ...
    phi).*((-1).*cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin( ...
    theta))+(1/4).*dphi.^2.*L.^2.*m.*cos(phi).*sin(psi).*((-1).*cos( ...
    psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(1/4).* ...
    dpsi.^2.*L.^2.*m.*cos(phi).*sin(psi).*((-1).*cos(psi).*sin(phi)+( ...
    -1).*cos(phi).*sin(psi).*sin(theta))+(1/2).*dpsi.*dtheta.*L.^2.* ...
    m.*cos(theta).*sin(phi).*sin(psi).*((-1).*cos(psi).*sin(phi)+(-1) ...
    .*cos(phi).*sin(psi).*sin(theta))+(1/4).*dphi.^2.*L.^2.*m.*cos( ...
    psi).*sin(phi).*sin(theta).*((-1).*cos(psi).*sin(phi)+(-1).*cos( ...
    phi).*sin(psi).*sin(theta))+(1/4).*dpsi.^2.*L.^2.*m.*cos(psi).* ...
    sin(phi).*sin(theta).*((-1).*cos(psi).*sin(phi)+(-1).*cos(phi).* ...
    sin(psi).*sin(theta))+(1/4).*dtheta.^2.*L.^2.*m.*cos(psi).*sin( ...
    phi).*sin(theta).*((-1).*cos(psi).*sin(phi)+(-1).*cos(phi).*sin( ...
    psi).*sin(theta))+(1/2).*dphi.*dpsi.*L.^2.*m.*cos(phi).*sin(psi).* ...
    sin(theta).*((-1).*cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).* ...
    sin(theta))+(1/2).*dphi.*dtheta.*L.^2.*m.*cos(phi).*cos(psi).*cos( ...
    theta).*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+ ...
    (1/2).*dphi.*dpsi.*L.^2.*m.*cos(psi).*sin(phi).*(cos(psi).*sin( ...
    phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(1/4).*dphi.^2.*L.^2.* ...
    m.*cos(phi).*sin(psi).*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin( ...
    psi).*sin(theta))+(1/4).*dpsi.^2.*L.^2.*m.*cos(phi).*sin(psi).*( ...
    cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(-1/2).* ...
    dpsi.*dtheta.*L.^2.*m.*cos(theta).*sin(phi).*sin(psi).*(cos(psi).* ...
    sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(-1/4).*dphi.^2.* ...
    L.^2.*m.*cos(psi).*sin(phi).*sin(theta).*(cos(psi).*sin(phi)+(-1) ...
    .*cos(phi).*sin(psi).*sin(theta))+(-1/4).*dpsi.^2.*L.^2.*m.*cos( ...
    psi).*sin(phi).*sin(theta).*(cos(psi).*sin(phi)+(-1).*cos(phi).* ...
    sin(psi).*sin(theta))+(-1/4).*dtheta.^2.*L.^2.*m.*cos(psi).*sin( ...
    phi).*sin(theta).*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).* ...
    sin(theta))+(-1/2).*dphi.*dpsi.*L.^2.*m.*cos(phi).*sin(psi).*sin( ...
    theta).*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+ ...
    (-1/4).*L.^2.*m.*((-1).*dphi.*cos(psi).*sin(phi)+(-1).*dpsi.*cos( ...
    phi).*sin(psi)+(-1).*dtheta.*cos(theta).*sin(phi).*sin(psi)+(-1).* ...
    dpsi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dphi.*cos(phi).*sin( ...
    psi).*sin(theta)).*(dtheta.*cos(phi).*cos(psi).*cos(theta)+(-1).* ...
    dpsi.*cos(psi).*sin(phi)+(-1).*dphi.*cos(phi).*sin(psi)+(-1).* ...
    dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos(phi).*sin( ...
    psi).*sin(theta))+(-1/4).*L.^2.*m.*((-1).*dphi.*cos(psi).*sin(phi)+(-1).*dpsi.*cos(phi).*sin(psi)+dtheta.*cos(theta).*sin(phi).*sin( ...
    psi)+dpsi.*cos(psi).*sin(phi).*sin(theta)+dphi.*cos(phi).*sin(psi) ...
    .*sin(theta)).*(dtheta.*cos(phi).*cos(psi).*cos(theta)+dpsi.*cos( ...
    psi).*sin(phi)+dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin( ...
    phi).*sin(theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin(theta))+(1/2) ...
    .*dphi.*dpsi.*L.^2.*m.*cos(phi).*cos(psi).*(cos(phi).*cos(psi)+( ...
    -1).*sin(phi).*sin(psi).*sin(theta))+(1/2).*dphi.*dtheta.*L.^2.* ...
    m.*cos(psi).*cos(theta).*sin(phi).*(cos(phi).*cos(psi)+(-1).*sin( ...
    phi).*sin(psi).*sin(theta))+(1/2).*dpsi.*dtheta.*L.^2.*m.*cos(phi) ...
    .*cos(theta).*sin(psi).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin( ...
    psi).*sin(theta))+(-1/4).*dphi.^2.*L.^2.*m.*sin(phi).*sin(psi).*( ...
    cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+(-1/4).* ...
    dpsi.^2.*L.^2.*m.*sin(phi).*sin(psi).*(cos(phi).*cos(psi)+(-1).* ...
    sin(phi).*sin(psi).*sin(theta))+(1/4).*dphi.^2.*L.^2.*m.*cos(phi) ...
    .*cos(psi).*sin(theta).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin( ...
    psi).*sin(theta))+(1/4).*dpsi.^2.*L.^2.*m.*cos(phi).*cos(psi).* ...
    sin(theta).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin( ...
    theta))+(1/4).*dtheta.^2.*L.^2.*m.*cos(phi).*cos(psi).*sin(theta) ...
    .*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+(-1/2) ...
    .*dphi.*dpsi.*L.^2.*m.*sin(phi).*sin(psi).*sin(theta).*(cos(phi).* ...
    cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+(-1/2).*dphi.* ...
    dpsi.*L.^2.*m.*cos(phi).*cos(psi).*(cos(phi).*cos(psi)+sin(phi).* ...
    sin(psi).*sin(theta))+(1/2).*dphi.*dtheta.*L.^2.*m.*cos(psi).*cos( ...
    theta).*sin(phi).*(cos(phi).*cos(psi)+sin(phi).*sin(psi).*sin( ...
    theta))+(1/2).*dpsi.*dtheta.*L.^2.*m.*cos(phi).*cos(theta).*sin( ...
    psi).*(cos(phi).*cos(psi)+sin(phi).*sin(psi).*sin(theta))+(1/4).* ...
    dphi.^2.*L.^2.*m.*sin(phi).*sin(psi).*(cos(phi).*cos(psi)+sin(phi) ...
    .*sin(psi).*sin(theta))+(1/4).*dpsi.^2.*L.^2.*m.*sin(phi).*sin( ...
    psi).*(cos(phi).*cos(psi)+sin(phi).*sin(psi).*sin(theta))+(1/4).* ...
    dphi.^2.*L.^2.*m.*cos(phi).*cos(psi).*sin(theta).*(cos(phi).*cos( ...
    psi)+sin(phi).*sin(psi).*sin(theta))+(1/4).*dpsi.^2.*L.^2.*m.*cos( ...
    phi).*cos(psi).*sin(theta).*(cos(phi).*cos(psi)+sin(phi).*sin(psi) ...
    .*sin(theta))+(1/4).*dtheta.^2.*L.^2.*m.*cos(phi).*cos(psi).*sin( ...
    theta).*(cos(phi).*cos(psi)+sin(phi).*sin(psi).*sin(theta))+(-1/2) ...
    .*dphi.*dpsi.*L.^2.*m.*sin(phi).*sin(psi).*sin(theta).*(cos(phi).* ...
    cos(psi)+sin(phi).*sin(psi).*sin(theta))+(-1/4).*L.^2.*m.*((-1).* ...
    dphi.*cos(phi).*cos(psi)+(-1).*dtheta.*cos(phi).*cos(theta).*sin( ...
    psi)+dpsi.*sin(phi).*sin(psi)+(-1).*dpsi.*cos(phi).*cos(psi).*sin( ...
    theta)+dphi.*sin(phi).*sin(psi).*sin(theta)).*(dpsi.*cos(phi).* ...
    cos(psi)+dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin( ...
    phi).*sin(psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.* ...
    sin(phi).*sin(psi).*sin(theta))+(-1/4).*L.^2.*m.*(dphi.*cos(phi).* ...
    cos(psi)+(-1).*dtheta.*cos(phi).*cos(theta).*sin(psi)+(-1).*dpsi.* ...
    sin(phi).*sin(psi)+(-1).*dpsi.*cos(phi).*cos(psi).*sin(theta)+ ...
    dphi.*sin(phi).*sin(psi).*sin(theta)).*(dpsi.*cos(phi).*cos(psi)+( ...
    -1).*dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).* ...
    sin(psi)+(-1).*dphi.*cos(phi).*cos(psi).*sin(theta)+dpsi.*sin(phi) ...
    .*sin(psi).*sin(theta))+(-1).*ddtheta.*((1/4).*L.^2.*m.*cos(psi).* ...
    cos(theta).*sin(phi).*((-1).*cos(psi).*sin(phi)+(-1).*cos(phi).* ...
    sin(psi).*sin(theta))+(-1/4).*L.^2.*m.*cos(psi).*cos(theta).*sin( ...
    phi).*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+( ...
    1/4).*L.^2.*m.*cos(phi).*cos(psi).*cos(theta).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+(1/4).*L.^2.*m.*cos(phi).* ...
    cos(psi).*cos(theta).*(cos(phi).*cos(psi)+sin(phi).*sin(psi).*sin( ...
    theta)))+(-1).*ddphi.*((-1/4).*L.^2.*m.*sin(phi).*sin(psi).*((-1) ...
    .*cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(1/4).* ...
    L.^2.*m.*cos(phi).*cos(psi).*sin(theta).*((-1).*cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(-1/4).*L.^2.*m.*sin(phi).* ...
    sin(psi).*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta) ...
    )+(-1/4).*L.^2.*m.*cos(phi).*cos(psi).*sin(theta).*(cos(psi).*sin( ...
    phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(-1/4).*L.^2.*m.*cos( ...
    phi).*sin(psi).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin( ...
    theta))+(-1/4).*L.^2.*m.*cos(psi).*sin(phi).*sin(theta).*(cos(phi) ...
    .*cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+(1/4).*L.^2.*m.* ...
    cos(phi).*sin(psi).*(cos(phi).*cos(psi)+sin(phi).*sin(psi).*sin( ...
    theta))+(-1/4).*L.^2.*m.*cos(psi).*sin(phi).*sin(theta).*(cos(phi) ...
    .*cos(psi)+sin(phi).*sin(psi).*sin(theta)))+(-1).*ddpsi.*((1/4).* ...
    L.^2.*m.*cos(phi).*cos(psi).*((-1).*cos(psi).*sin(phi)+(-1).*cos( ...
    phi).*sin(psi).*sin(theta))+(-1/4).*L.^2.*m.*sin(phi).*sin(psi).* ...
    sin(theta).*((-1).*cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).* ...
    sin(theta))+(1/4).*L.^2.*m.*cos(phi).*cos(psi).*(cos(psi).*sin( ...
    phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(1/4).*L.^2.*m.*sin( ...
    phi).*sin(psi).*sin(theta).*(cos(psi).*sin(phi)+(-1).*cos(phi).* ...
    sin(psi).*sin(theta))+(-1/4).*L.^2.*m.*cos(psi).*sin(phi).*(cos( ...
    phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+(-1/4).* ...
    L.^2.*m.*cos(phi).*sin(psi).*sin(theta).*(cos(phi).*cos(psi)+(-1) ...
    .*sin(phi).*sin(psi).*sin(theta))+(1/4).*L.^2.*m.*cos(psi).*sin( ...
    phi).*(cos(phi).*cos(psi)+sin(phi).*sin(psi).*sin(theta))+(-1/4).* ...
    L.^2.*m.*cos(phi).*sin(psi).*sin(theta).*(cos(phi).*cos(psi)+sin( ...
    phi).*sin(psi).*sin(theta)))+(1/2).*m.*((1/2).*L.^2.*((-1).*dphi.* ...
    cos(psi).*sin(phi)+(-1).*dpsi.*cos(phi).*sin(psi)+(-1).*dtheta.* ...
    cos(theta).*sin(phi).*sin(psi)+(-1).*dpsi.*cos(psi).*sin(phi).* ...
    sin(theta)+(-1).*dphi.*cos(phi).*sin(psi).*sin(theta)).*(dtheta.* ...
    cos(phi).*cos(psi).*cos(theta)+(-1).*dpsi.*cos(psi).*sin(phi)+(-1) ...
    .*dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin( ...
    theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin(theta))+(1/2).*L.^2.*(( ...
    -1).*dphi.*cos(psi).*sin(phi)+(-1).*dpsi.*cos(phi).*sin(psi)+ ...
    dtheta.*cos(theta).*sin(phi).*sin(psi)+dpsi.*cos(psi).*sin(phi).* ...
    sin(theta)+dphi.*cos(phi).*sin(psi).*sin(theta)).*(dtheta.*cos( ...
    phi).*cos(psi).*cos(theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi) ...
    .*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.* ...
    cos(phi).*sin(psi).*sin(theta))+(1/2).*L.^2.*((-1).*dphi.*cos(phi) ...
    .*cos(psi)+(-1).*dtheta.*cos(phi).*cos(theta).*sin(psi)+dpsi.*sin( ...
    phi).*sin(psi)+(-1).*dpsi.*cos(phi).*cos(psi).*sin(theta)+dphi.* ...
    sin(phi).*sin(psi).*sin(theta)).*(dpsi.*cos(phi).*cos(psi)+ ...
    dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin( ...
    psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).* ...
    sin(psi).*sin(theta))+(1/2).*L.^2.*(dphi.*cos(phi).*cos(psi)+(-1) ...
    .*dtheta.*cos(phi).*cos(theta).*sin(psi)+(-1).*dpsi.*sin(phi).* ...
    sin(psi)+(-1).*dpsi.*cos(phi).*cos(psi).*sin(theta)+dphi.*sin(phi) ...
    .*sin(psi).*sin(theta)).*(dpsi.*cos(phi).*cos(psi)+(-1).*dtheta.* ...
    cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin(psi)+(-1) ...
    .*dphi.*cos(phi).*cos(psi).*sin(theta)+dpsi.*sin(phi).*sin(psi).* ...
    sin(theta)))+b1.*cos(psi).*cos(theta).*(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).* ...
    sin(psi)+(-1).*a1.*sin(theta)).^2).^(-1/2).*((-6).*(a1.^2+b1.^2).* ...
    P1.*phi.*pi.*(phi+2.*N1.*pi).^(-2)+(a1.^2+b1.^2).*ks1.*phi.*(( ...
    a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin( ...
    theta)).^2).^(-1/2)+(-2).*P1.*pi.*(phi+2.*N1.*pi).^(-3).*(B1.^2+( ...
    -3).*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.* ...
    sin(theta)).^2)))+(-1).*b1.*(a1.^2+b1.^2).*phi.*cos(psi).*cos( ...
    theta).*(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).*(( ...
    a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin( ...
    theta)).^2).^(-3/2).*(ks1.*((-1).*L+((a1.^2+b1.^2).*phi.^2+(L+b1.* ...
    cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2).^(1/2))+P1.*pi.*( ...
    phi+2.*N1.*pi).^(-2).*(B1.^2+(-3).*((a1.^2+b1.^2).*phi.^2+(L+b1.* ...
    cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2)))+b2.*cos(psi).* ...
    cos(theta).*(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).*(( ...
    a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin( ...
    theta)).^2).^(-1/2).*((-6).*(a2.^2+b2.^2).*P2.*phi.*pi.*(phi+2.* ...
    N2.*pi).^(-2)+(a2.^2+b2.^2).*ks2.*phi.*((a2.^2+b2.^2).*phi.^2+(L+ ...
    b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^(-1/2)+(-2).* ...
    P2.*pi.*(phi+2.*N2.*pi).^(-3).*(B2.^2+(-3).*((a2.^2+b2.^2).* ...
    phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).^2)))+( ...
    -1).*b2.*(a2.^2+b2.^2).*phi.*cos(psi).*cos(theta).*(L+b2.*cos( ...
    theta).*sin(psi)+(-1).*a2.*sin(theta)).*((a2.^2+b2.^2).*phi.^2+(L+ ...
    b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^(-3/2).*(ks2.* ...
    ((-1).*L+((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).* ...
    a2.*sin(theta)).^2).^(1/2))+P2.*pi.*(phi+2.*N2.*pi).^(-2).*(B2.^2+ ...
    (-3).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).* ...
    a2.*sin(theta)).^2)))+b3.*cos(psi).*cos(theta).*(L+b3.*cos(theta) ...
    .*sin(psi)+(-1).*a3.*sin(theta)).*((a3.^2+b3.^2).*phi.^2+(L+b3.* ...
    cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^(-1/2).*((-6).*( ...
    a3.^2+b3.^2).*P3.*phi.*pi.*(phi+2.*N3.*pi).^(-2)+(a3.^2+b3.^2).* ...
    ks3.*phi.*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1) ...
    .*a3.*sin(theta)).^2).^(-1/2)+(-2).*P3.*pi.*(phi+2.*N3.*pi).^(-3) ...
    .*(B3.^2+(-3).*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+ ...
    (-1).*a3.*sin(theta)).^2)))+(-1).*b3.*(a3.^2+b3.^2).*phi.*cos(psi) ...
    .*cos(theta).*(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).*( ...
    (a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin( ...
    theta)).^2).^(-3/2).*(ks3.*((-1).*L+((a3.^2+b3.^2).*phi.^2+(L+b3.* ...
    cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^(1/2))+P3.*pi.*( ...
    phi+2.*N3.*pi).^(-2).*(B3.^2+(-3).*((a3.^2+b3.^2).*phi.^2+(L+b3.* ...
    cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2)))+b4.*cos(psi).* ...
    cos(theta).*(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).*(( ...
    a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin( ...
    theta)).^2).^(-1/2).*((-6).*(a4.^2+b4.^2).*P4.*phi.*pi.*(phi+2.* ...
    N4.*pi).^(-2)+(a4.^2+b4.^2).*ks4.*phi.*((a4.^2+b4.^2).*phi.^2+(L+ ...
    b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^(-1/2)+(-2).* ...
    P4.*pi.*(phi+2.*N4.*pi).^(-3).*(B4.^2+(-3).*((a4.^2+b4.^2).* ...
    phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2)))+( ...
    -1).*b4.*(a4.^2+b4.^2).*phi.*cos(psi).*cos(theta).*(L+b4.*cos( ...
    theta).*sin(psi)+(-1).*a4.*sin(theta)).*((a4.^2+b4.^2).*phi.^2+(L+ ...
    b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^(-3/2).*(ks4.* ...
    ((-1).*L+((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).* ...
    a4.*sin(theta)).^2).^(1/2))+P4.*pi.*(phi+2.*N4.*pi).^(-2).*(B4.^2+ ...
    (-3).*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).* ...
    a4.*sin(theta)).^2))),(-1).*damppsi+(-3/4).*dpsi.*L.^2.*m.*cos( ...
    psi).*cos(theta).^2.*sin(psi)+(3/4).*dtheta.*L.^2.*m.*cos(theta).* ...
    sin(psi).^2.*sin(theta)+(1/2).*L.*m.*cos(psi).*cos(theta).*((-1/2) ...
    .*dpsi.*L.*cos(theta).*sin(psi)+(-1/2).*dtheta.*L.*cos(psi).*sin( ...
    theta))+(-1/2).*dphi.*L.^2.*m.*cos(phi).*cos(psi).*(cos(psi).*sin( ...
    phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(1/2).*dtheta.*L.^2.* ...
    m.*cos(phi).*cos(theta).*sin(psi).*(cos(psi).*sin(phi)+(-1).*cos( ...
    phi).*sin(psi).*sin(theta))+(1/2).*dpsi.*L.^2.*m.*sin(phi).*sin( ...
    psi).*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+( ...
    1/2).*dpsi.*L.^2.*m.*cos(phi).*cos(psi).*sin(theta).*(cos(psi).* ...
    sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(-1/2).*dphi.* ...
    L.^2.*m.*sin(phi).*sin(psi).*sin(theta).*(cos(psi).*sin(phi)+(-1) ...
    .*cos(phi).*sin(psi).*sin(theta))+(-1/4).*L.^2.*m.*((-1).*sin(phi) ...
    .*sin(psi)+(-1).*cos(phi).*cos(psi).*sin(theta)).*(dtheta.*cos( ...
    phi).*cos(psi).*cos(theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi) ...
    .*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.* ...
    cos(phi).*sin(psi).*sin(theta))+(1/2).*dphi.*L.^2.*m.*cos(psi).* ...
    sin(phi).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta) ...
    )+(1/2).*dpsi.*L.^2.*m.*cos(phi).*sin(psi).*(cos(phi).*cos(psi)+( ...
    -1).*sin(phi).*sin(psi).*sin(theta))+(1/2).*dtheta.*L.^2.*m.*cos( ...
    theta).*sin(phi).*sin(psi).*(cos(phi).*cos(psi)+(-1).*sin(phi).* ...
    sin(psi).*sin(theta))+(1/2).*dpsi.*L.^2.*m.*cos(psi).*sin(phi).* ...
    sin(theta).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin( ...
    theta))+(1/2).*dphi.*L.^2.*m.*cos(phi).*sin(psi).*sin(theta).*( ...
    cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+(-1/4).* ...
    L.^2.*m.*((-1).*dphi.*cos(psi).*sin(phi)+(-1).*dpsi.*cos(phi).* ...
    sin(psi)+(-1).*dtheta.*cos(theta).*sin(phi).*sin(psi)+(-1).*dpsi.* ...
    cos(psi).*sin(phi).*sin(theta)+(-1).*dphi.*cos(phi).*sin(psi).* ...
    sin(theta)).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin( ...
    theta))+(-1/4).*L.^2.*m.*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin( ...
    psi).*sin(theta)).*(dphi.*cos(phi).*cos(psi)+(-1).*dtheta.*cos( ...
    phi).*cos(theta).*sin(psi)+(-1).*dpsi.*sin(phi).*sin(psi)+(-1).* ...
    dpsi.*cos(phi).*cos(psi).*sin(theta)+dphi.*sin(phi).*sin(psi).* ...
    sin(theta))+(-1/4).*L.^2.*m.*((-1).*cos(phi).*sin(psi)+(-1).*cos( ...
    psi).*sin(phi).*sin(theta)).*(dpsi.*cos(phi).*cos(psi)+dtheta.* ...
    cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin(psi)+ ...
    dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).*sin( ...
    psi).*sin(theta))+(1/2).*m.*((-1).*L.*cos(psi).*cos(theta).*(( ...
    -1/2).*dpsi.*L.*cos(theta).*sin(psi)+(-1/2).*dtheta.*L.*cos(psi).* ...
    sin(theta))+(-1).*L.*cos(theta).*sin(psi).*((-1/2).*dpsi.*L.*cos( ...
    psi).*cos(theta)+(1/2).*dtheta.*L.*sin(psi).*sin(theta))+(1/2).* ...
    L.^2.*((-1).*sin(phi).*sin(psi)+(-1).*cos(phi).*cos(psi).*sin( ...
    theta)).*(dtheta.*cos(phi).*cos(psi).*cos(theta)+dpsi.*cos(psi).* ...
    sin(phi)+dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).* ...
    sin(theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin(theta))+(1/2).* ...
    L.^2.*((-1).*dphi.*cos(psi).*sin(phi)+(-1).*dpsi.*cos(phi).*sin( ...
    psi)+(-1).*dtheta.*cos(theta).*sin(phi).*sin(psi)+(-1).*dpsi.*cos( ...
    psi).*sin(phi).*sin(theta)+(-1).*dphi.*cos(phi).*sin(psi).*sin( ...
    theta)).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+(1/2).*L.^2.*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin( ...
    theta)).*(dphi.*cos(phi).*cos(psi)+(-1).*dtheta.*cos(phi).*cos( ...
    theta).*sin(psi)+(-1).*dpsi.*sin(phi).*sin(psi)+(-1).*dpsi.*cos( ...
    phi).*cos(psi).*sin(theta)+dphi.*sin(phi).*sin(psi).*sin(theta))+( ...
    1/2).*L.^2.*((-1).*cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).* ...
    sin(theta)).*(dpsi.*cos(phi).*cos(psi)+dtheta.*cos(psi).*cos( ...
    theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin(psi)+dphi.*cos(phi).* ...
    cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).*sin(psi).*sin(theta))), ...
    (-1/2).*dtheta.*L.^2.*m.*cos(psi).*cos(theta).^2.*sin(psi)+(-1/4) ...
    .*dpsi.*L.^2.*m.*cos(psi).^2.*cos(theta).*sin(theta)+(1/2).*dpsi.* ...
    L.^2.*m.*cos(theta).*sin(psi).^2.*sin(theta)+(1/4).*dtheta.*L.^2.* ...
    m.*cos(psi).*sin(psi).*sin(theta).^2+(-1/2).*L.*m.*sin(psi).*sin( ...
    theta).*((-1/2).*dpsi.*L.*cos(theta).*sin(psi)+(-1/2).*dtheta.*L.* ...
    cos(psi).*sin(theta))+(1/2).*dphi.*L.^2.*m.*cos(psi).*cos(theta).* ...
    sin(phi).*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta) ...
    )+(1/2).*dpsi.*L.^2.*m.*cos(phi).*cos(theta).*sin(psi).*(cos(psi) ...
    .*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(1/2).*dtheta.* ...
    L.^2.*m.*cos(phi).*cos(psi).*sin(theta).*(cos(psi).*sin(phi)+(-1) ...
    .*cos(phi).*sin(psi).*sin(theta))+(-1/4).*L.^2.*m.*cos(psi).*cos( ...
    theta).*sin(phi).*((-1).*dphi.*cos(psi).*sin(phi)+(-1).*dpsi.*cos( ...
    phi).*sin(psi)+(-1).*dtheta.*cos(theta).*sin(phi).*sin(psi)+(-1).* ...
    dpsi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dphi.*cos(phi).*sin( ...
    psi).*sin(theta))+(1/4).*L.^2.*m.*cos(phi).*cos(theta).*sin(psi).* ...
    (dtheta.*cos(phi).*cos(psi).*cos(theta)+dpsi.*cos(psi).*sin(phi)+ ...
    dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin( ...
    theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin(theta))+(-1/2).*dphi.* ...
    L.^2.*m.*cos(phi).*cos(psi).*cos(theta).*(cos(phi).*cos(psi)+(-1) ...
    .*sin(phi).*sin(psi).*sin(theta))+(1/2).*dpsi.*L.^2.*m.*cos(theta) ...
    .*sin(phi).*sin(psi).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi) ...
    .*sin(theta))+(1/2).*dtheta.*L.^2.*m.*cos(psi).*sin(phi).*sin( ...
    theta).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+ ...
    (-1/4).*L.^2.*m.*cos(phi).*cos(psi).*cos(theta).*(dphi.*cos(phi).* ...
    cos(psi)+(-1).*dtheta.*cos(phi).*cos(theta).*sin(psi)+(-1).*dpsi.* ...
    sin(phi).*sin(psi)+(-1).*dpsi.*cos(phi).*cos(psi).*sin(theta)+ ...
    dphi.*sin(phi).*sin(psi).*sin(theta))+(1/4).*L.^2.*m.*cos(theta).* ...
    sin(phi).*sin(psi).*(dpsi.*cos(phi).*cos(psi)+dtheta.*cos(psi).* ...
    cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin(psi)+dphi.*cos(phi) ...
    .*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).*sin(psi).*sin(theta))+(1/2).*m.*(L.*sin(psi).*sin(theta).*((-1/2).*dpsi.*L.*cos(theta) ...
    .*sin(psi)+(-1/2).*dtheta.*L.*cos(psi).*sin(theta))+(-1).*L.*cos( ...
    psi).*sin(theta).*((-1/2).*dpsi.*L.*cos(psi).*cos(theta)+(1/2).* ...
    dtheta.*L.*sin(psi).*sin(theta))+(1/2).*L.^2.*cos(psi).*cos(theta) ...
    .*sin(phi).*((-1).*dphi.*cos(psi).*sin(phi)+(-1).*dpsi.*cos(phi).* ...
    sin(psi)+(-1).*dtheta.*cos(theta).*sin(phi).*sin(psi)+(-1).*dpsi.* ...
    cos(psi).*sin(phi).*sin(theta)+(-1).*dphi.*cos(phi).*sin(psi).* ...
    sin(theta))+(-1/2).*L.^2.*cos(phi).*cos(theta).*sin(psi).*( ...
    dtheta.*cos(phi).*cos(psi).*cos(theta)+dpsi.*cos(psi).*sin(phi)+ ...
    dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin( ...
    theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin(theta))+(1/2).*L.^2.* ...
    cos(phi).*cos(psi).*cos(theta).*(dphi.*cos(phi).*cos(psi)+(-1).* ...
    dtheta.*cos(phi).*cos(theta).*sin(psi)+(-1).*dpsi.*sin(phi).*sin( ...
    psi)+(-1).*dpsi.*cos(phi).*cos(psi).*sin(theta)+dphi.*sin(phi).* ...
    sin(psi).*sin(theta))+(-1/2).*L.^2.*cos(theta).*sin(phi).*sin(psi) ...
    .*(dpsi.*cos(phi).*cos(psi)+dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin(psi)+dphi.*cos(phi).*cos(psi).*sin( ...
    theta)+(-1).*dpsi.*sin(phi).*sin(psi).*sin(theta))),(-1/2).*dpsi.* ...
    L.^2.*m.*cos(phi).*cos(psi).*(cos(psi).*sin(phi)+(-1).*cos(phi).* ...
    sin(psi).*sin(theta))+(1/2).*dtheta.*L.^2.*m.*cos(psi).*cos(theta) ...
    .*sin(phi).*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin( ...
    theta))+(1/2).*dphi.*L.^2.*m.*sin(phi).*sin(psi).*(cos(psi).*sin( ...
    phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(1/2).*dphi.*L.^2.*m.* ...
    cos(phi).*cos(psi).*sin(theta).*(cos(psi).*sin(phi)+(-1).*cos(phi) ...
    .*sin(psi).*sin(theta))+(-1/2).*dpsi.*L.^2.*m.*sin(phi).*sin(psi) ...
    .*sin(theta).*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin( ...
    theta))+(-1/4).*L.^2.*m.*((-1).*sin(phi).*sin(psi)+cos(phi).*cos( ...
    psi).*sin(theta)).*((-1).*dphi.*cos(psi).*sin(phi)+(-1).*dpsi.* ...
    cos(phi).*sin(psi)+(-1).*dtheta.*cos(theta).*sin(phi).*sin(psi)+( ...
    -1).*dpsi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dphi.*cos(phi).* ...
    sin(psi).*sin(theta))+(-1/2).*dtheta.*L.^2.*m.*cos(phi).*cos(psi) ...
    .*cos(theta).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin( ...
    theta))+(1/2).*dpsi.*L.^2.*m.*cos(psi).*sin(phi).*(cos(phi).*cos( ...
    psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+(1/2).*dphi.*L.^2.*m.* ...
    cos(phi).*sin(psi).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).* ...
    sin(theta))+(1/2).*dphi.*L.^2.*m.*cos(psi).*sin(phi).*sin(theta).* ...
    (cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+(1/2).* ...
    dpsi.*L.^2.*m.*cos(phi).*sin(psi).*sin(theta).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+(-1/4).*L.^2.*m.*(dtheta.* ...
    cos(phi).*cos(psi).*cos(theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos( ...
    phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).* ...
    dpsi.*cos(phi).*sin(psi).*sin(theta)).*(cos(phi).*cos(psi)+sin( ...
    phi).*sin(psi).*sin(theta))+(-1/4).*L.^2.*m.*(cos(phi).*sin(psi)+( ...
    -1).*cos(psi).*sin(phi).*sin(theta)).*(dphi.*cos(phi).*cos(psi)+( ...
    -1).*dtheta.*cos(phi).*cos(theta).*sin(psi)+(-1).*dpsi.*sin(phi).* ...
    sin(psi)+(-1).*dpsi.*cos(phi).*cos(psi).*sin(theta)+dphi.*sin(phi) ...
    .*sin(psi).*sin(theta))+(-1/4).*L.^2.*m.*((-1).*cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta)).*(dpsi.*cos(phi).*cos(psi)+ ...
    dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin( ...
    psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).* ...
    sin(psi).*sin(theta))+(1/2).*m.*((1/2).*L.^2.*((-1).*sin(phi).* ...
    sin(psi)+cos(phi).*cos(psi).*sin(theta)).*((-1).*dphi.*cos(psi).* ...
    sin(phi)+(-1).*dpsi.*cos(phi).*sin(psi)+(-1).*dtheta.*cos(theta).* ...
    sin(phi).*sin(psi)+(-1).*dpsi.*cos(psi).*sin(phi).*sin(theta)+(-1) ...
    .*dphi.*cos(phi).*sin(psi).*sin(theta))+(1/2).*L.^2.*(dtheta.*cos( ...
    phi).*cos(psi).*cos(theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi) ...
    .*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.* ...
    cos(phi).*sin(psi).*sin(theta)).*(cos(phi).*cos(psi)+sin(phi).* ...
    sin(psi).*sin(theta))+(1/2).*L.^2.*(cos(phi).*sin(psi)+(-1).*cos( ...
    psi).*sin(phi).*sin(theta)).*(dphi.*cos(phi).*cos(psi)+(-1).* ...
    dtheta.*cos(phi).*cos(theta).*sin(psi)+(-1).*dpsi.*sin(phi).*sin( ...
    psi)+(-1).*dpsi.*cos(phi).*cos(psi).*sin(theta)+dphi.*sin(phi).* ...
    sin(psi).*sin(theta))+(1/2).*L.^2.*((-1).*cos(psi).*sin(phi)+(-1) ...
    .*cos(phi).*sin(psi).*sin(theta)).*(dpsi.*cos(phi).*cos(psi)+ ...
    dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin( ...
    psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).* ...
    sin(psi).*sin(theta)));(1/2).*dpsi.*dtheta.*L.^2.*m.*cos(phi).^2.* ...
    cos(psi).^2.*cos(theta).^2+(1/2).*dphi.^2.*L.^2.*m.*cos(phi).*cos( ...
    psi).^2.*cos(theta).*sin(phi)+(1/2).*dpsi.^2.*L.^2.*m.*cos(phi).* ...
    cos(psi).^2.*cos(theta).*sin(phi)+(1/2).*dpsi.*dtheta.*L.^2.*m.* ...
    cos(psi).^2.*cos(theta).^2.*sin(phi).^2+dphi.*dpsi.*L.^2.*m.*cos( ...
    phi).^2.*cos(psi).*cos(theta).*sin(psi)+(-1).*dphi.*dpsi.*L.^2.* ...
    m.*cos(psi).*cos(theta).*sin(phi).^2.*sin(psi)+(-1/2).*dpsi.* ...
    dtheta.*L.^2.*m.*cos(phi).^2.*cos(theta).^2.*sin(psi).^2+(-1/2).* ...
    dphi.^2.*L.^2.*m.*cos(phi).*cos(theta).*sin(phi).*sin(psi).^2+( ...
    -1/2).*dpsi.^2.*L.^2.*m.*cos(phi).*cos(theta).*sin(phi).*sin(psi) ...
    .^2+(-1/2).*dpsi.*dtheta.*L.^2.*m.*cos(theta).^2.*sin(phi).^2.* ...
    sin(psi).^2+(-1).*ddphi.*((1/4).*L.^2.*m.*cos(phi).^2.*cos(psi) ...
    .^2.*cos(theta)+(-1/4).*L.^2.*m.*cos(psi).^2.*cos(theta).*sin(phi) ...
    .^2+(-1/4).*L.^2.*m.*cos(phi).^2.*cos(theta).*sin(psi).^2+(1/4).* ...
    L.^2.*m.*cos(theta).*sin(phi).^2.*sin(psi).^2)+(1/2).*g.*L.*m.* ...
    sin(psi).*sin(theta)+(1/2).*dpsi.^2.*L.^2.*m.*cos(psi).*cos(theta) ...
    .*sin(psi).*sin(theta)+(1/2).*dtheta.^2.*L.^2.*m.*cos(psi).*cos( ...
    theta).*sin(psi).*sin(theta)+(-1/2).*dphi.^2.*L.^2.*m.*cos(phi) ...
    .^2.*cos(psi).*cos(theta).*sin(psi).*sin(theta)+(-1/2).*dpsi.^2.* ...
    L.^2.*m.*cos(phi).^2.*cos(psi).*cos(theta).*sin(psi).*sin(theta)+( ...
    -1/2).*dtheta.^2.*L.^2.*m.*cos(phi).^2.*cos(psi).*cos(theta).*sin( ...
    psi).*sin(theta)+(-1/2).*dphi.^2.*L.^2.*m.*cos(psi).*cos(theta).* ...
    sin(phi).^2.*sin(psi).*sin(theta)+(-1/2).*dpsi.^2.*L.^2.*m.*cos( ...
    psi).*cos(theta).*sin(phi).^2.*sin(psi).*sin(theta)+(-1/2).* ...
    dtheta.^2.*L.^2.*m.*cos(psi).*cos(theta).*sin(phi).^2.*sin(psi).* ...
    sin(theta)+(1/2).*dpsi.*dtheta.*L.^2.*m.*cos(psi).^2.*sin(theta) ...
    .^2+(-1/2).*dpsi.*dtheta.*L.^2.*m.*sin(psi).^2.*sin(theta).^2+( ...
    -1/2).*dtheta.*L.*m.*cos(theta).*sin(psi).*((-1/2).*dpsi.*L.*cos( ...
    theta).*sin(psi)+(-1/2).*dtheta.*L.*cos(psi).*sin(theta))+(-1/2).* ...
    dpsi.*L.*m.*cos(psi).*sin(theta).*((-1/2).*dpsi.*L.*cos(theta).* ...
    sin(psi)+(-1/2).*dtheta.*L.*cos(psi).*sin(theta))+(1/2).*dtheta.* ...
    L.*m.*cos(psi).*cos(theta).*((-1/2).*dpsi.*L.*cos(psi).*cos(theta)+(1/2).*dtheta.*L.*sin(psi).*sin(theta))+(-1/2).*dpsi.*L.*m.*sin( ...
    psi).*sin(theta).*((-1/2).*dpsi.*L.*cos(psi).*cos(theta)+(1/2).* ...
    dtheta.*L.*sin(psi).*sin(theta))+(-1/4).*dphi.*L.^2.*m.*cos(phi).* ...
    cos(psi).*cos(theta).*((-1).*dphi.*cos(psi).*sin(phi)+(-1).*dpsi.* ...
    cos(phi).*sin(psi)+(-1).*dtheta.*cos(theta).*sin(phi).*sin(psi)+( ...
    -1).*dpsi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dphi.*cos(phi).* ...
    sin(psi).*sin(theta))+(1/4).*dpsi.*L.^2.*m.*cos(theta).*sin(phi).* ...
    sin(psi).*((-1).*dphi.*cos(psi).*sin(phi)+(-1).*dpsi.*cos(phi).* ...
    sin(psi)+(-1).*dtheta.*cos(theta).*sin(phi).*sin(psi)+(-1).*dpsi.* ...
    cos(psi).*sin(phi).*sin(theta)+(-1).*dphi.*cos(phi).*sin(psi).* ...
    sin(theta))+(1/4).*dtheta.*L.^2.*m.*cos(psi).*sin(phi).*sin(theta) ...
    .*((-1).*dphi.*cos(psi).*sin(phi)+(-1).*dpsi.*cos(phi).*sin(psi)+( ...
    -1).*dtheta.*cos(theta).*sin(phi).*sin(psi)+(-1).*dpsi.*cos(psi).* ...
    sin(phi).*sin(theta)+(-1).*dphi.*cos(phi).*sin(psi).*sin(theta))+( ...
    1/4).*dpsi.*L.^2.*m.*cos(phi).*cos(psi).*cos(theta).*(dtheta.*cos( ...
    phi).*cos(psi).*cos(theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi) ...
    .*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.* ...
    cos(phi).*sin(psi).*sin(theta))+(-1/4).*dphi.*L.^2.*m.*cos(theta) ...
    .*sin(phi).*sin(psi).*(dtheta.*cos(phi).*cos(psi).*cos(theta)+ ...
    dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos( ...
    psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin( ...
    theta))+(-1/4).*dtheta.*L.^2.*m.*cos(phi).*sin(psi).*sin(theta).*( ...
    dtheta.*cos(phi).*cos(psi).*cos(theta)+dpsi.*cos(psi).*sin(phi)+ ...
    dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin( ...
    theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin(theta))+(1/4).*dphi.* ...
    L.^2.*m.*cos(psi).*cos(theta).*sin(phi).*(dphi.*cos(phi).*cos(psi)+(-1).*dtheta.*cos(phi).*cos(theta).*sin(psi)+(-1).*dpsi.*sin(phi) ...
    .*sin(psi)+(-1).*dpsi.*cos(phi).*cos(psi).*sin(theta)+dphi.*sin( ...
    phi).*sin(psi).*sin(theta))+(1/4).*dpsi.*L.^2.*m.*cos(phi).*cos( ...
    theta).*sin(psi).*(dphi.*cos(phi).*cos(psi)+(-1).*dtheta.*cos(phi) ...
    .*cos(theta).*sin(psi)+(-1).*dpsi.*sin(phi).*sin(psi)+(-1).*dpsi.* ...
    cos(phi).*cos(psi).*sin(theta)+dphi.*sin(phi).*sin(psi).*sin( ...
    theta))+(1/4).*dtheta.*L.^2.*m.*cos(phi).*cos(psi).*sin(theta).*( ...
    dphi.*cos(phi).*cos(psi)+(-1).*dtheta.*cos(phi).*cos(theta).*sin( ...
    psi)+(-1).*dpsi.*sin(phi).*sin(psi)+(-1).*dpsi.*cos(phi).*cos(psi) ...
    .*sin(theta)+dphi.*sin(phi).*sin(psi).*sin(theta))+(1/4).*dpsi.* ...
    L.^2.*m.*cos(psi).*cos(theta).*sin(phi).*(dpsi.*cos(phi).*cos(psi)+dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin( ...
    psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).* ...
    sin(psi).*sin(theta))+(1/4).*dphi.*L.^2.*m.*cos(phi).*cos(theta).* ...
    sin(psi).*(dpsi.*cos(phi).*cos(psi)+dtheta.*cos(psi).*cos(theta).* ...
    sin(phi)+(-1).*dphi.*sin(phi).*sin(psi)+dphi.*cos(phi).*cos(psi).* ...
    sin(theta)+(-1).*dpsi.*sin(phi).*sin(psi).*sin(theta))+(-1/4).* ...
    dtheta.*L.^2.*m.*sin(phi).*sin(psi).*sin(theta).*(dpsi.*cos(phi).* ...
    cos(psi)+dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin( ...
    phi).*sin(psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.* ...
    sin(phi).*sin(psi).*sin(theta))+(-1).*ddpsi.*((-1).*L.^2.*m.*cos( ...
    phi).*cos(psi).*cos(theta).*sin(phi).*sin(psi)+(1/4).*L.^2.*m.* ...
    cos(psi).^2.*cos(theta).*sin(theta)+(-1/4).*L.^2.*m.*cos(phi).^2.* ...
    cos(psi).^2.*cos(theta).*sin(theta)+(-1/4).*L.^2.*m.*cos(psi).^2.* ...
    cos(theta).*sin(phi).^2.*sin(theta)+(-1/4).*L.^2.*m.*cos(theta).* ...
    sin(psi).^2.*sin(theta)+(1/4).*L.^2.*m.*cos(phi).^2.*cos(theta).* ...
    sin(psi).^2.*sin(theta)+(1/4).*L.^2.*m.*cos(theta).*sin(phi).^2.* ...
    sin(psi).^2.*sin(theta))+(-1).*ddtheta.*((-1/2).*L.^2.*m.*cos(phi) ...
    .^2.*cos(psi).*cos(theta).^2.*sin(psi)+(-1/2).*L.^2.*m.*cos(psi).* ...
    cos(theta).^2.*sin(phi).^2.*sin(psi)+(-1/2).*L.^2.*m.*cos(psi).* ...
    sin(psi).*sin(theta).^2)+(1/2).*m.*(2.*((1/2).*dtheta.*L.*cos( ...
    theta).*sin(psi)+(-1/2).*dpsi.*L.*cos(psi).*sin(theta)).*((-1/2).* ...
    dpsi.*L.*cos(theta).*sin(psi)+(-1/2).*dtheta.*L.*cos(psi).*sin( ...
    theta))+2.*((-1/2).*dtheta.*L.*cos(psi).*cos(theta)+(-1/2).*dpsi.* ...
    L.*sin(psi).*sin(theta)).*((-1/2).*dpsi.*L.*cos(psi).*cos(theta)+( ...
    1/2).*dtheta.*L.*sin(psi).*sin(theta))+(1/2).*L.^2.*(dphi.*cos( ...
    phi).*cos(psi).*cos(theta)+(-1).*dpsi.*cos(theta).*sin(phi).*sin( ...
    psi)+(-1).*dtheta.*cos(psi).*sin(phi).*sin(theta)).*((-1).*dphi.* ...
    cos(psi).*sin(phi)+(-1).*dpsi.*cos(phi).*sin(psi)+(-1).*dtheta.* ...
    cos(theta).*sin(phi).*sin(psi)+(-1).*dpsi.*cos(psi).*sin(phi).* ...
    sin(theta)+(-1).*dphi.*cos(phi).*sin(psi).*sin(theta))+(1/2).* ...
    L.^2.*(dtheta.*cos(phi).*cos(psi).*cos(theta)+dpsi.*cos(psi).*sin( ...
    phi)+dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin( ...
    theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin(theta)).*((-1).*dpsi.* ...
    cos(phi).*cos(psi).*cos(theta)+dphi.*cos(theta).*sin(phi).*sin( ...
    psi)+dtheta.*cos(phi).*sin(psi).*sin(theta))+(1/2).*L.^2.*((-1).* ...
    dphi.*cos(psi).*cos(theta).*sin(phi)+(-1).*dpsi.*cos(phi).*cos( ...
    theta).*sin(psi)+(-1).*dtheta.*cos(phi).*cos(psi).*sin(theta)).*( ...
    dphi.*cos(phi).*cos(psi)+(-1).*dtheta.*cos(phi).*cos(theta).*sin( ...
    psi)+(-1).*dpsi.*sin(phi).*sin(psi)+(-1).*dpsi.*cos(phi).*cos(psi) ...
    .*sin(theta)+dphi.*sin(phi).*sin(psi).*sin(theta))+(1/2).*L.^2.*( ...
    dpsi.*cos(phi).*cos(psi)+dtheta.*cos(psi).*cos(theta).*sin(phi)+( ...
    -1).*dphi.*sin(phi).*sin(psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).*sin(psi).*sin(theta)).*((-1).*dpsi.*cos( ...
    psi).*cos(theta).*sin(phi)+(-1).*dphi.*cos(phi).*cos(theta).*sin( ...
    psi)+dtheta.*sin(phi).*sin(psi).*sin(theta)))+(L+b1.*cos(theta).* ...
    sin(psi)+(-1).*a1.*sin(theta)).*((-1).*a1.*cos(theta)+(-1).*b1.* ...
    sin(psi).*sin(theta)).*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).* ...
    sin(psi)+(-1).*a1.*sin(theta)).^2).^(-1/2).*((-6).*b1.*P1.*pi.*( ...
    phi+2.*N1.*pi).^(-2).*cos(psi).*cos(theta).*(L+b1.*cos(theta).* ...
    sin(psi)+(-1).*a1.*sin(theta))+b1.*ks1.*cos(psi).*cos(theta).*(L+ ...
    b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).*((a1.^2+b1.^2).* ...
    phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2).^( ...
    -1/2))+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).*((-1).* ...
    a2.*cos(theta)+(-1).*b2.*sin(psi).*sin(theta)).*((a2.^2+b2.^2).* ...
    phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^( ...
    -1/2).*((-6).*b2.*P2.*pi.*(phi+2.*N2.*pi).^(-2).*cos(psi).*cos( ...
    theta).*(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta))+b2.* ...
    ks2.*cos(psi).*cos(theta).*(L+b2.*cos(theta).*sin(psi)+(-1).*a2.* ...
    sin(theta)).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+( ...
    -1).*a2.*sin(theta)).^2).^(-1/2))+(L+b3.*cos(theta).*sin(psi)+(-1) ...
    .*a3.*sin(theta)).*((-1).*a3.*cos(theta)+(-1).*b3.*sin(psi).*sin( ...
    theta)).*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).* ...
    a3.*sin(theta)).^2).^(-1/2).*((-6).*b3.*P3.*pi.*(phi+2.*N3.*pi).^( ...
    -2).*cos(psi).*cos(theta).*(L+b3.*cos(theta).*sin(psi)+(-1).*a3.* ...
    sin(theta))+b3.*ks3.*cos(psi).*cos(theta).*(L+b3.*cos(theta).*sin( ...
    psi)+(-1).*a3.*sin(theta)).*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos( ...
    theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^(-1/2))+(L+b4.*cos( ...
    theta).*sin(psi)+(-1).*a4.*sin(theta)).*((-1).*a4.*cos(theta)+(-1) ...
    .*b4.*sin(psi).*sin(theta)).*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos( ...
    theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^(-1/2).*((-6).*b4.* ...
    P4.*pi.*(phi+2.*N4.*pi).^(-2).*cos(psi).*cos(theta).*(L+b4.*cos( ...
    theta).*sin(psi)+(-1).*a4.*sin(theta))+b4.*ks4.*cos(psi).*cos( ...
    theta).*(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).*(( ...
    a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin( ...
    theta)).^2).^(-1/2))+(-1).*b1.*cos(psi).*cos(theta).*(L+b1.*cos( ...
    theta).*sin(psi)+(-1).*a1.*sin(theta)).^2.*((-1).*a1.*cos(theta)+( ...
    -1).*b1.*sin(psi).*sin(theta)).*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos( ...
    theta).*sin(psi)+(-1).*a1.*sin(theta)).^2).^(-3/2).*(ks1.*((-1).* ...
    L+((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.* ...
    sin(theta)).^2).^(1/2))+P1.*pi.*(phi+2.*N1.*pi).^(-2).*(B1.^2+(-3) ...
    .*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.* ...
    sin(theta)).^2)))+(-1).*b1.*cos(psi).*sin(theta).*(L+b1.*cos( ...
    theta).*sin(psi)+(-1).*a1.*sin(theta)).*((a1.^2+b1.^2).*phi.^2+(L+ ...
    b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2).^(-1/2).*(ks1.* ...
    ((-1).*L+((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).* ...
    a1.*sin(theta)).^2).^(1/2))+P1.*pi.*(phi+2.*N1.*pi).^(-2).*(B1.^2+ ...
    (-3).*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).* ...
    a1.*sin(theta)).^2)))+b1.*cos(psi).*cos(theta).*((-1).*a1.*cos( ...
    theta)+(-1).*b1.*sin(psi).*sin(theta)).*((a1.^2+b1.^2).*phi.^2+(L+ ...
    b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2).^(-1/2).*(ks1.* ...
    ((-1).*L+((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).* ...
    a1.*sin(theta)).^2).^(1/2))+P1.*pi.*(phi+2.*N1.*pi).^(-2).*(B1.^2+ ...
    (-3).*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).* ...
    a1.*sin(theta)).^2)))+(-1).*b2.*cos(psi).*cos(theta).*(L+b2.*cos( ...
    theta).*sin(psi)+(-1).*a2.*sin(theta)).^2.*((-1).*a2.*cos(theta)+( ...
    -1).*b2.*sin(psi).*sin(theta)).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos( ...
    theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^(-3/2).*(ks2.*((-1).* ...
    L+((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.* ...
    sin(theta)).^2).^(1/2))+P2.*pi.*(phi+2.*N2.*pi).^(-2).*(B2.^2+(-3) ...
    .*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.* ...
    sin(theta)).^2)))+(-1).*b2.*cos(psi).*sin(theta).*(L+b2.*cos( ...
    theta).*sin(psi)+(-1).*a2.*sin(theta)).*((a2.^2+b2.^2).*phi.^2+(L+ ...
    b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^(-1/2).*(ks2.* ...
    ((-1).*L+((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).* ...
    a2.*sin(theta)).^2).^(1/2))+P2.*pi.*(phi+2.*N2.*pi).^(-2).*(B2.^2+ ...
    (-3).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).* ...
    a2.*sin(theta)).^2)))+b2.*cos(psi).*cos(theta).*((-1).*a2.*cos( ...
    theta)+(-1).*b2.*sin(psi).*sin(theta)).*((a2.^2+b2.^2).*phi.^2+(L+ ...
    b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^(-1/2).*(ks2.* ...
    ((-1).*L+((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).* ...
    a2.*sin(theta)).^2).^(1/2))+P2.*pi.*(phi+2.*N2.*pi).^(-2).*(B2.^2+ ...
    (-3).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).* ...
    a2.*sin(theta)).^2)))+(-1).*b3.*cos(psi).*cos(theta).*(L+b3.*cos( ...
    theta).*sin(psi)+(-1).*a3.*sin(theta)).^2.*((-1).*a3.*cos(theta)+( ...
    -1).*b3.*sin(psi).*sin(theta)).*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos( ...
    theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^(-3/2).*(ks3.*((-1).* ...
    L+((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.* ...
    sin(theta)).^2).^(1/2))+P3.*pi.*(phi+2.*N3.*pi).^(-2).*(B3.^2+(-3) ...
    .*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.* ...
    sin(theta)).^2)))+(-1).*b3.*cos(psi).*sin(theta).*(L+b3.*cos( ...
    theta).*sin(psi)+(-1).*a3.*sin(theta)).*((a3.^2+b3.^2).*phi.^2+(L+ ...
    b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^(-1/2).*(ks3.* ...
    ((-1).*L+((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).* ...
    a3.*sin(theta)).^2).^(1/2))+P3.*pi.*(phi+2.*N3.*pi).^(-2).*(B3.^2+ ...
    (-3).*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).* ...
    a3.*sin(theta)).^2)))+b3.*cos(psi).*cos(theta).*((-1).*a3.*cos( ...
    theta)+(-1).*b3.*sin(psi).*sin(theta)).*((a3.^2+b3.^2).*phi.^2+(L+ ...
    b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^(-1/2).*(ks3.* ...
    ((-1).*L+((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).* ...
    a3.*sin(theta)).^2).^(1/2))+P3.*pi.*(phi+2.*N3.*pi).^(-2).*(B3.^2+ ...
    (-3).*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).* ...
    a3.*sin(theta)).^2)))+(-1).*b4.*cos(psi).*cos(theta).*(L+b4.*cos( ...
    theta).*sin(psi)+(-1).*a4.*sin(theta)).^2.*((-1).*a4.*cos(theta)+( ...
    -1).*b4.*sin(psi).*sin(theta)).*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos( ...
    theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^(-3/2).*(ks4.*((-1).* ...
    L+((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.* ...
    sin(theta)).^2).^(1/2))+P4.*pi.*(phi+2.*N4.*pi).^(-2).*(B4.^2+(-3) ...
    .*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.* ...
    sin(theta)).^2)))+(-1).*b4.*cos(psi).*sin(theta).*(L+b4.*cos( ...
    theta).*sin(psi)+(-1).*a4.*sin(theta)).*((a4.^2+b4.^2).*phi.^2+(L+ ...
    b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^(-1/2).*(ks4.* ...
    ((-1).*L+((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).* ...
    a4.*sin(theta)).^2).^(1/2))+P4.*pi.*(phi+2.*N4.*pi).^(-2).*(B4.^2+ ...
    (-3).*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).* ...
    a4.*sin(theta)).^2)))+b4.*cos(psi).*cos(theta).*((-1).*a4.*cos( ...
    theta)+(-1).*b4.*sin(psi).*sin(theta)).*((a4.^2+b4.^2).*phi.^2+(L+ ...
    b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^(-1/2).*(ks4.* ...
    ((-1).*L+((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).* ...
    a4.*sin(theta)).^2).^(1/2))+P4.*pi.*(phi+2.*N4.*pi).^(-2).*(B4.^2+ ...
    (-3).*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).* ...
    a4.*sin(theta)).^2))),(-1/2).*g.*L.*m.*cos(psi).*cos(theta)+(-1/4) ...
    .*dpsi.^2.*L.^2.*m.*cos(psi).^2.*cos(theta).^2+(-1/4).*dtheta.^2.* ...
    L.^2.*m.*cos(psi).^2.*cos(theta).^2+(1/4).*dphi.^2.*L.^2.*m.*cos( ...
    phi).^2.*cos(psi).^2.*cos(theta).^2+(1/4).*dpsi.^2.*L.^2.*m.*cos( ...
    phi).^2.*cos(psi).^2.*cos(theta).^2+(1/4).*dtheta.^2.*L.^2.*m.* ...
    cos(phi).^2.*cos(psi).^2.*cos(theta).^2+(1/4).*dphi.^2.*L.^2.*m.* ...
    cos(psi).^2.*cos(theta).^2.*sin(phi).^2+(1/4).*dpsi.^2.*L.^2.*m.* ...
    cos(psi).^2.*cos(theta).^2.*sin(phi).^2+(1/4).*dtheta.^2.*L.^2.* ...
    m.*cos(psi).^2.*cos(theta).^2.*sin(phi).^2+(1/2).*dphi.*dpsi.* ...
    L.^2.*m.*cos(phi).^2.*cos(psi).^2.*sin(theta)+(-1/2).*dphi.*dpsi.* ...
    L.^2.*m.*cos(psi).^2.*sin(phi).^2.*sin(theta)+dpsi.*dtheta.*L.^2.* ...
    m.*cos(psi).*cos(theta).*sin(psi).*sin(theta)+(-1).*dpsi.*dtheta.* ...
    L.^2.*m.*cos(phi).^2.*cos(psi).*cos(theta).*sin(psi).*sin(theta)+( ...
    -1/2).*dphi.^2.*L.^2.*m.*cos(phi).*cos(psi).*sin(phi).*sin(psi).* ...
    sin(theta)+(-1/2).*dpsi.^2.*L.^2.*m.*cos(phi).*cos(psi).*sin(phi) ...
    .*sin(psi).*sin(theta)+(-1).*dpsi.*dtheta.*L.^2.*m.*cos(psi).*cos( ...
    theta).*sin(phi).^2.*sin(psi).*sin(theta)+(1/4).*dpsi.^2.*L.^2.* ...
    m.*cos(psi).^2.*sin(theta).^2+(1/4).*dtheta.^2.*L.^2.*m.*cos(psi) ...
    .^2.*sin(theta).^2+(-1/4).*dphi.^2.*L.^2.*m.*cos(phi).^2.*cos(psi) ...
    .^2.*sin(theta).^2+(-1/4).*dpsi.^2.*L.^2.*m.*cos(phi).^2.*cos(psi) ...
    .^2.*sin(theta).^2+(-1/4).*dtheta.^2.*L.^2.*m.*cos(phi).^2.*cos( ...
    psi).^2.*sin(theta).^2+(-1/4).*dphi.^2.*L.^2.*m.*cos(psi).^2.*sin( ...
    phi).^2.*sin(theta).^2+(-1/4).*dpsi.^2.*L.^2.*m.*cos(psi).^2.*sin( ...
    phi).^2.*sin(theta).^2+(-1/4).*dtheta.^2.*L.^2.*m.*cos(psi).^2.* ...
    sin(phi).^2.*sin(theta).^2+(-1/2).*dpsi.*L.*m.*cos(theta).*sin( ...
    psi).*((-1/2).*dpsi.*L.*cos(theta).*sin(psi)+(-1/2).*dtheta.*L.* ...
    cos(psi).*sin(theta))+(-1/2).*dtheta.*L.*m.*cos(psi).*sin(theta).* ...
    ((-1/2).*dpsi.*L.*cos(theta).*sin(psi)+(-1/2).*dtheta.*L.*cos(psi) ...
    .*sin(theta))+(1/4).*dphi.*L.^2.*m.*cos(psi).*cos(theta).*sin(phi) ...
    .*((-1).*dphi.*cos(psi).*cos(theta).*sin(phi)+(-1).*dpsi.*cos(phi) ...
    .*cos(theta).*sin(psi)+(-1).*dtheta.*cos(phi).*cos(psi).*sin( ...
    theta))+(1/4).*dpsi.*L.^2.*m.*cos(phi).*cos(theta).*sin(psi).*(( ...
    -1).*dphi.*cos(psi).*cos(theta).*sin(phi)+(-1).*dpsi.*cos(phi).* ...
    cos(theta).*sin(psi)+(-1).*dtheta.*cos(phi).*cos(psi).*sin(theta))+(1/4).*dtheta.*L.^2.*m.*cos(phi).*cos(psi).*sin(theta).*((-1).* ...
    dphi.*cos(psi).*cos(theta).*sin(phi)+(-1).*dpsi.*cos(phi).*cos( ...
    theta).*sin(psi)+(-1).*dtheta.*cos(phi).*cos(psi).*sin(theta))+( ...
    -1/4).*dphi.*L.^2.*m.*cos(phi).*cos(psi).*cos(theta).*(dphi.*cos( ...
    phi).*cos(psi).*cos(theta)+(-1).*dpsi.*cos(theta).*sin(phi).*sin( ...
    psi)+(-1).*dtheta.*cos(psi).*sin(phi).*sin(theta))+(1/4).*dpsi.* ...
    L.^2.*m.*cos(theta).*sin(phi).*sin(psi).*(dphi.*cos(phi).*cos(psi) ...
    .*cos(theta)+(-1).*dpsi.*cos(theta).*sin(phi).*sin(psi)+(-1).* ...
    dtheta.*cos(psi).*sin(phi).*sin(theta))+(1/4).*dtheta.*L.^2.*m.* ...
    cos(psi).*sin(phi).*sin(theta).*(dphi.*cos(phi).*cos(psi).*cos( ...
    theta)+(-1).*dpsi.*cos(theta).*sin(phi).*sin(psi)+(-1).*dtheta.* ...
    cos(psi).*sin(phi).*sin(theta))+(-1).*ddtheta.*((1/2).*L.^2.*m.* ...
    cos(psi).^2.*cos(theta).*sin(theta)+(-1/2).*L.^2.*m.*cos(phi).^2.* ...
    cos(psi).^2.*cos(theta).*sin(theta)+(-1/2).*L.^2.*m.*cos(psi).^2.* ...
    cos(theta).*sin(phi).^2.*sin(theta))+(1/2).*dtheta.*L.*m.*cos(psi) ...
    .*cos(theta).*((-1/2).*dtheta.*L.*cos(psi).*cos(theta)+(1/2).* ...
    dpsi.*L.*sin(psi).*sin(theta))+(-1/2).*dpsi.*L.*m.*sin(psi).*sin( ...
    theta).*((-1/2).*dtheta.*L.*cos(psi).*cos(theta)+(1/2).*dpsi.*L.* ...
    sin(psi).*sin(theta))+(1/4).*dtheta.*L.^2.*m.*cos(phi).*cos(psi).* ...
    cos(theta).*(dtheta.*cos(phi).*cos(psi).*cos(theta)+dpsi.*cos(psi) ...
    .*sin(phi)+dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi) ...
    .*sin(theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin(theta))+(-1/4).* ...
    dphi.*L.^2.*m.*cos(psi).*sin(phi).*sin(theta).*(dtheta.*cos(phi).* ...
    cos(psi).*cos(theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi).*sin( ...
    psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos( ...
    phi).*sin(psi).*sin(theta))+(-1/4).*dpsi.*L.^2.*m.*cos(phi).*sin( ...
    psi).*sin(theta).*(dtheta.*cos(phi).*cos(psi).*cos(theta)+dpsi.* ...
    cos(psi).*sin(phi)+dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos(psi).* ...
    sin(phi).*sin(theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin(theta))+( ...
    1/4).*dtheta.*L.^2.*m.*cos(psi).*cos(theta).*sin(phi).*(dpsi.*cos( ...
    phi).*cos(psi)+dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.* ...
    sin(phi).*sin(psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).* ...
    dpsi.*sin(phi).*sin(psi).*sin(theta))+(1/4).*dphi.*L.^2.*m.*cos( ...
    phi).*cos(psi).*sin(theta).*(dpsi.*cos(phi).*cos(psi)+dtheta.*cos( ...
    psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin(psi)+dphi.* ...
    cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).*sin(psi).* ...
    sin(theta))+(-1/4).*dpsi.*L.^2.*m.*sin(phi).*sin(psi).*sin(theta) ...
    .*(dpsi.*cos(phi).*cos(psi)+dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin(psi)+dphi.*cos(phi).*cos(psi).*sin( ...
    theta)+(-1).*dpsi.*sin(phi).*sin(psi).*sin(theta))+(-1).*ddphi.*(( ...
    -1/4).*L.^2.*m.*cos(phi).^2.*cos(psi).*sin(psi).*sin(theta)+(1/4) ...
    .*L.^2.*m.*cos(psi).*sin(phi).^2.*sin(psi).*sin(theta))+(-1).* ...
    ddpsi.*((1/4).*L.^2.*m.*cos(psi).*cos(theta).^2.*sin(psi)+(-1/4).* ...
    L.^2.*m.*cos(phi).^2.*cos(psi).*cos(theta).^2.*sin(psi)+(-1/4).* ...
    L.^2.*m.*cos(psi).*cos(theta).^2.*sin(phi).^2.*sin(psi)+(-1/2).* ...
    L.^2.*m.*cos(phi).*cos(psi).^2.*sin(phi).*sin(theta)+(-1/4).* ...
    L.^2.*m.*cos(psi).*sin(psi).*sin(theta).^2+(1/4).*L.^2.*m.*cos( ...
    phi).^2.*cos(psi).*sin(psi).*sin(theta).^2+(1/4).*L.^2.*m.*cos( ...
    psi).*sin(phi).^2.*sin(psi).*sin(theta).^2)+(1/2).*m.*(2.*((-1/2) ...
    .*dpsi.*L.*cos(theta).*sin(psi)+(-1/2).*dtheta.*L.*cos(psi).*sin( ...
    theta)).*((-1/2).*dpsi.*L.*cos(theta).*sin(psi)+(1/2).*dtheta.*L.* ...
    cos(psi).*sin(theta))+(1/2).*L.^2.*((-1).*dphi.*cos(psi).*cos( ...
    theta).*sin(phi)+(-1).*dpsi.*cos(phi).*cos(theta).*sin(psi)+(-1).* ...
    dtheta.*cos(phi).*cos(psi).*sin(theta)).^2+(1/2).*L.^2.*(dphi.* ...
    cos(phi).*cos(psi).*cos(theta)+(-1).*dpsi.*cos(theta).*sin(phi).* ...
    sin(psi)+(-1).*dtheta.*cos(psi).*sin(phi).*sin(theta)).^2+2.*(( ...
    -1/2).*dtheta.*L.*cos(psi).*cos(theta)+(-1/2).*dpsi.*L.*sin(psi).* ...
    sin(theta)).*((-1/2).*dtheta.*L.*cos(psi).*cos(theta)+(1/2).* ...
    dpsi.*L.*sin(psi).*sin(theta))+(1/2).*L.^2.*(dtheta.*cos(phi).* ...
    cos(psi).*cos(theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi).*sin( ...
    psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos( ...
    phi).*sin(psi).*sin(theta)).*((-1).*dtheta.*cos(phi).*cos(psi).* ...
    cos(theta)+dphi.*cos(psi).*sin(phi).*sin(theta)+dpsi.*cos(phi).* ...
    sin(psi).*sin(theta))+(1/2).*L.^2.*(dpsi.*cos(phi).*cos(psi)+ ...
    dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin( ...
    psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).* ...
    sin(psi).*sin(theta)).*((-1).*dtheta.*cos(psi).*cos(theta).*sin( ...
    phi)+(-1).*dphi.*cos(phi).*cos(psi).*sin(theta)+dpsi.*sin(phi).* ...
    sin(psi).*sin(theta)))+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin( ...
    theta)).*((-1).*a1.*cos(theta)+(-1).*b1.*sin(psi).*sin(theta)).*(( ...
    a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin( ...
    theta)).^2).^(-1/2).*((-6).*P1.*pi.*(phi+2.*N1.*pi).^(-2).*(L+b1.* ...
    cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).*((-1).*a1.*cos(theta)+ ...
    (-1).*b1.*sin(psi).*sin(theta))+ks1.*(L+b1.*cos(theta).*sin(psi)+( ...
    -1).*a1.*sin(theta)).*((-1).*a1.*cos(theta)+(-1).*b1.*sin(psi).* ...
    sin(theta)).*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+( ...
    -1).*a1.*sin(theta)).^2).^(-1/2))+(L+b2.*cos(theta).*sin(psi)+(-1) ...
    .*a2.*sin(theta)).*((-1).*a2.*cos(theta)+(-1).*b2.*sin(psi).*sin( ...
    theta)).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).* ...
    a2.*sin(theta)).^2).^(-1/2).*((-6).*P2.*pi.*(phi+2.*N2.*pi).^(-2) ...
    .*(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).*((-1).*a2.* ...
    cos(theta)+(-1).*b2.*sin(psi).*sin(theta))+ks2.*(L+b2.*cos(theta) ...
    .*sin(psi)+(-1).*a2.*sin(theta)).*((-1).*a2.*cos(theta)+(-1).*b2.* ...
    sin(psi).*sin(theta)).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).* ...
    sin(psi)+(-1).*a2.*sin(theta)).^2).^(-1/2))+(L+b3.*cos(theta).* ...
    sin(psi)+(-1).*a3.*sin(theta)).*((-1).*a3.*cos(theta)+(-1).*b3.* ...
    sin(psi).*sin(theta)).*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).* ...
    sin(psi)+(-1).*a3.*sin(theta)).^2).^(-1/2).*((-6).*P3.*pi.*(phi+ ...
    2.*N3.*pi).^(-2).*(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta) ...
    ).*((-1).*a3.*cos(theta)+(-1).*b3.*sin(psi).*sin(theta))+ks3.*(L+ ...
    b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).*((-1).*a3.*cos( ...
    theta)+(-1).*b3.*sin(psi).*sin(theta)).*((a3.^2+b3.^2).*phi.^2+(L+ ...
    b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^(-1/2))+(L+ ...
    b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).*((-1).*a4.*cos( ...
    theta)+(-1).*b4.*sin(psi).*sin(theta)).*((a4.^2+b4.^2).*phi.^2+(L+ ...
    b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^(-1/2).*((-6) ...
    .*P4.*pi.*(phi+2.*N4.*pi).^(-2).*(L+b4.*cos(theta).*sin(psi)+(-1) ...
    .*a4.*sin(theta)).*((-1).*a4.*cos(theta)+(-1).*b4.*sin(psi).*sin( ...
    theta))+ks4.*(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).*(( ...
    -1).*a4.*cos(theta)+(-1).*b4.*sin(psi).*sin(theta)).*((a4.^2+ ...
    b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)) ...
    .^2).^(-1/2))+(-1).*(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin( ...
    theta)).^2.*((-1).*a1.*cos(theta)+(-1).*b1.*sin(psi).*sin(theta)) ...
    .^2.*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.* ...
    sin(theta)).^2).^(-3/2).*(ks1.*((-1).*L+((a1.^2+b1.^2).*phi.^2+(L+ ...
    b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2).^(1/2))+P1.* ...
    pi.*(phi+2.*N1.*pi).^(-2).*(B1.^2+(-3).*((a1.^2+b1.^2).*phi.^2+(L+ ...
    b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2)))+(L+b1.*cos( ...
    theta).*sin(psi)+(-1).*a1.*sin(theta)).*((-1).*b1.*cos(theta).* ...
    sin(psi)+a1.*sin(theta)).*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta) ...
    .*sin(psi)+(-1).*a1.*sin(theta)).^2).^(-1/2).*(ks1.*((-1).*L+(( ...
    a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin( ...
    theta)).^2).^(1/2))+P1.*pi.*(phi+2.*N1.*pi).^(-2).*(B1.^2+(-3).*(( ...
    a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin( ...
    theta)).^2)))+((-1).*a1.*cos(theta)+(-1).*b1.*sin(psi).*sin(theta) ...
    ).^2.*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).* ...
    a1.*sin(theta)).^2).^(-1/2).*(ks1.*((-1).*L+((a1.^2+b1.^2).* ...
    phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2).^( ...
    1/2))+P1.*pi.*(phi+2.*N1.*pi).^(-2).*(B1.^2+(-3).*((a1.^2+b1.^2).* ...
    phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2)))+( ...
    -1).*(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).^2.*((-1).* ...
    a2.*cos(theta)+(-1).*b2.*sin(psi).*sin(theta)).^2.*((a2.^2+b2.^2) ...
    .*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^( ...
    -3/2).*(ks2.*((-1).*L+((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).* ...
    sin(psi)+(-1).*a2.*sin(theta)).^2).^(1/2))+P2.*pi.*(phi+2.*N2.*pi) ...
    .^(-2).*(B2.^2+(-3).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).* ...
    sin(psi)+(-1).*a2.*sin(theta)).^2)))+(L+b2.*cos(theta).*sin(psi)+( ...
    -1).*a2.*sin(theta)).*((-1).*b2.*cos(theta).*sin(psi)+a2.*sin( ...
    theta)).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).* ...
    a2.*sin(theta)).^2).^(-1/2).*(ks2.*((-1).*L+((a2.^2+b2.^2).* ...
    phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^( ...
    1/2))+P2.*pi.*(phi+2.*N2.*pi).^(-2).*(B2.^2+(-3).*((a2.^2+b2.^2).* ...
    phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).^2)))+(( ...
    -1).*a2.*cos(theta)+(-1).*b2.*sin(psi).*sin(theta)).^2.*((a2.^2+ ...
    b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)) ...
    .^2).^(-1/2).*(ks2.*((-1).*L+((a2.^2+b2.^2).*phi.^2+(L+b2.*cos( ...
    theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^(1/2))+P2.*pi.*(phi+ ...
    2.*N2.*pi).^(-2).*(B2.^2+(-3).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos( ...
    theta).*sin(psi)+(-1).*a2.*sin(theta)).^2)))+(-1).*(L+b3.*cos( ...
    theta).*sin(psi)+(-1).*a3.*sin(theta)).^2.*((-1).*a3.*cos(theta)+( ...
    -1).*b3.*sin(psi).*sin(theta)).^2.*((a3.^2+b3.^2).*phi.^2+(L+b3.* ...
    cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^(-3/2).*(ks3.*(( ...
    -1).*L+((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).* ...
    a3.*sin(theta)).^2).^(1/2))+P3.*pi.*(phi+2.*N3.*pi).^(-2).*(B3.^2+ ...
    (-3).*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).* ...
    a3.*sin(theta)).^2)))+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin( ...
    theta)).*((-1).*b3.*cos(theta).*sin(psi)+a3.*sin(theta)).*((a3.^2+ ...
    b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)) ...
    .^2).^(-1/2).*(ks3.*((-1).*L+((a3.^2+b3.^2).*phi.^2+(L+b3.*cos( ...
    theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^(1/2))+P3.*pi.*(phi+ ...
    2.*N3.*pi).^(-2).*(B3.^2+(-3).*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos( ...
    theta).*sin(psi)+(-1).*a3.*sin(theta)).^2)))+((-1).*a3.*cos(theta)+(-1).*b3.*sin(psi).*sin(theta)).^2.*((a3.^2+b3.^2).*phi.^2+(L+ ...
    b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^(-1/2).*(ks3.* ...
    ((-1).*L+((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).* ...
    a3.*sin(theta)).^2).^(1/2))+P3.*pi.*(phi+2.*N3.*pi).^(-2).*(B3.^2+ ...
    (-3).*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).* ...
    a3.*sin(theta)).^2)))+(-1).*(L+b4.*cos(theta).*sin(psi)+(-1).*a4.* ...
    sin(theta)).^2.*((-1).*a4.*cos(theta)+(-1).*b4.*sin(psi).*sin( ...
    theta)).^2.*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+( ...
    -1).*a4.*sin(theta)).^2).^(-3/2).*(ks4.*((-1).*L+((a4.^2+b4.^2).* ...
    phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^( ...
    1/2))+P4.*pi.*(phi+2.*N4.*pi).^(-2).*(B4.^2+(-3).*((a4.^2+b4.^2).* ...
    phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2)))+(L+ ...
    b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).*((-1).*b4.*cos( ...
    theta).*sin(psi)+a4.*sin(theta)).*((a4.^2+b4.^2).*phi.^2+(L+b4.* ...
    cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^(-1/2).*(ks4.*(( ...
    -1).*L+((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).* ...
    a4.*sin(theta)).^2).^(1/2))+P4.*pi.*(phi+2.*N4.*pi).^(-2).*(B4.^2+ ...
    (-3).*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).* ...
    a4.*sin(theta)).^2)))+((-1).*a4.*cos(theta)+(-1).*b4.*sin(psi).* ...
    sin(theta)).^2.*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^(-1/2).*(ks4.*((-1).*L+((a4.^2+b4.^2) ...
    .*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^( ...
    1/2))+P4.*pi.*(phi+2.*N4.*pi).^(-2).*(B4.^2+(-3).*((a4.^2+b4.^2).* ...
    phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2))),2.* ...
    dphi.*dpsi.*L.^2.*m.*cos(phi).*cos(psi).^2.*cos(theta).*sin(phi)+( ...
    -1).*ddpsi.*((1/2).*L.^2.*m.*cos(phi).^2.*cos(psi).^2.*cos(theta)+ ...
    (-1/2).*L.^2.*m.*cos(psi).^2.*cos(theta).*sin(phi).^2)+(1/2).* ...
    dphi.^2.*L.^2.*m.*cos(phi).^2.*cos(psi).*cos(theta).*sin(psi)+( ...
    1/2).*dpsi.^2.*L.^2.*m.*cos(phi).^2.*cos(psi).*cos(theta).*sin( ...
    psi)+ddphi.*L.^2.*m.*cos(phi).*cos(psi).*cos(theta).*sin(phi).* ...
    sin(psi)+(-1/2).*dphi.^2.*L.^2.*m.*cos(psi).*cos(theta).*sin(phi) ...
    .^2.*sin(psi)+(-1/2).*dpsi.^2.*L.^2.*m.*cos(psi).*cos(theta).*sin( ...
    phi).^2.*sin(psi)+(-1/4).*dphi.*L.^2.*m.*cos(phi).*cos(psi).*cos( ...
    theta).*(dtheta.*cos(phi).*cos(psi).*cos(theta)+(-1).*dpsi.*cos( ...
    psi).*sin(phi)+(-1).*dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos(psi) ...
    .*sin(phi).*sin(theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin(theta))+(1/4).*dpsi.*L.^2.*m.*cos(theta).*sin(phi).*sin(psi).*(dtheta.* ...
    cos(phi).*cos(psi).*cos(theta)+(-1).*dpsi.*cos(psi).*sin(phi)+(-1) ...
    .*dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin( ...
    theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin(theta))+(1/4).*dtheta.* ...
    L.^2.*m.*cos(psi).*sin(phi).*sin(theta).*(dtheta.*cos(phi).*cos( ...
    psi).*cos(theta)+(-1).*dpsi.*cos(psi).*sin(phi)+(-1).*dphi.*cos( ...
    phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).* ...
    dpsi.*cos(phi).*sin(psi).*sin(theta))+(1/4).*dphi.*L.^2.*m.*cos( ...
    phi).*cos(psi).*cos(theta).*(dtheta.*cos(phi).*cos(psi).*cos( ...
    theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi).*sin(psi)+(-1).* ...
    dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos(phi).*sin( ...
    psi).*sin(theta))+(-1/4).*dpsi.*L.^2.*m.*cos(theta).*sin(phi).* ...
    sin(psi).*(dtheta.*cos(phi).*cos(psi).*cos(theta)+dpsi.*cos(psi).* ...
    sin(phi)+dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).* ...
    sin(theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin(theta))+(-1/4).* ...
    dtheta.*L.^2.*m.*cos(psi).*sin(phi).*sin(theta).*(dtheta.*cos(phi) ...
    .*cos(psi).*cos(theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi).* ...
    sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.* ...
    cos(phi).*sin(psi).*sin(theta))+(1/4).*dphi.*L.^2.*m.*cos(psi).* ...
    cos(theta).*sin(phi).*(dpsi.*cos(phi).*cos(psi)+dtheta.*cos(psi).* ...
    cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin(psi)+dphi.*cos(phi) ...
    .*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).*sin(psi).*sin(theta))+(1/4).*dpsi.*L.^2.*m.*cos(phi).*cos(theta).*sin(psi).*(dpsi.*cos( ...
    phi).*cos(psi)+dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.* ...
    sin(phi).*sin(psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).* ...
    dpsi.*sin(phi).*sin(psi).*sin(theta))+(1/4).*dtheta.*L.^2.*m.*cos( ...
    phi).*cos(psi).*sin(theta).*(dpsi.*cos(phi).*cos(psi)+dtheta.*cos( ...
    psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin(psi)+dphi.* ...
    cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).*sin(psi).* ...
    sin(theta))+(1/4).*dphi.*L.^2.*m.*cos(psi).*cos(theta).*sin(phi).* ...
    (dpsi.*cos(phi).*cos(psi)+(-1).*dtheta.*cos(psi).*cos(theta).*sin( ...
    phi)+(-1).*dphi.*sin(phi).*sin(psi)+(-1).*dphi.*cos(phi).*cos(psi) ...
    .*sin(theta)+dpsi.*sin(phi).*sin(psi).*sin(theta))+(1/4).*dpsi.* ...
    L.^2.*m.*cos(phi).*cos(theta).*sin(psi).*(dpsi.*cos(phi).*cos(psi)+(-1).*dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi) ...
    .*sin(psi)+(-1).*dphi.*cos(phi).*cos(psi).*sin(theta)+dpsi.*sin( ...
    phi).*sin(psi).*sin(theta))+(1/4).*dtheta.*L.^2.*m.*cos(phi).*cos( ...
    psi).*sin(theta).*(dpsi.*cos(phi).*cos(psi)+(-1).*dtheta.*cos(psi) ...
    .*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin(psi)+(-1).*dphi.* ...
    cos(phi).*cos(psi).*sin(theta)+dpsi.*sin(phi).*sin(psi).*sin( ...
    theta))+(1/2).*m.*((1/2).*L.^2.*(dphi.*cos(phi).*cos(psi).*cos( ...
    theta)+(-1).*dpsi.*cos(theta).*sin(phi).*sin(psi)+(-1).*dtheta.* ...
    cos(psi).*sin(phi).*sin(theta)).*(dtheta.*cos(phi).*cos(psi).*cos( ...
    theta)+(-1).*dpsi.*cos(psi).*sin(phi)+(-1).*dphi.*cos(phi).*sin( ...
    psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos( ...
    phi).*sin(psi).*sin(theta))+(1/2).*L.^2.*((-1).*dphi.*cos(phi).* ...
    cos(psi).*cos(theta)+dpsi.*cos(theta).*sin(phi).*sin(psi)+dtheta.* ...
    cos(psi).*sin(phi).*sin(theta)).*(dtheta.*cos(phi).*cos(psi).*cos( ...
    theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi).*sin(psi)+(-1).* ...
    dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos(phi).*sin( ...
    psi).*sin(theta))+(1/2).*L.^2.*((-1).*dphi.*cos(psi).*cos(theta).* ...
    sin(phi)+(-1).*dpsi.*cos(phi).*cos(theta).*sin(psi)+(-1).*dtheta.* ...
    cos(phi).*cos(psi).*sin(theta)).*(dpsi.*cos(phi).*cos(psi)+ ...
    dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin( ...
    psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).* ...
    sin(psi).*sin(theta))+(1/2).*L.^2.*((-1).*dphi.*cos(psi).*cos( ...
    theta).*sin(phi)+(-1).*dpsi.*cos(phi).*cos(theta).*sin(psi)+(-1).* ...
    dtheta.*cos(phi).*cos(psi).*sin(theta)).*(dpsi.*cos(phi).*cos(psi)+(-1).*dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi) ...
    .*sin(psi)+(-1).*dphi.*cos(phi).*cos(psi).*sin(theta)+dpsi.*sin( ...
    phi).*sin(psi).*sin(theta)))+(L+b1.*cos(theta).*sin(psi)+(-1).* ...
    a1.*sin(theta)).*((-1).*a1.*cos(theta)+(-1).*b1.*sin(psi).*sin( ...
    theta)).*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).* ...
    a1.*sin(theta)).^2).^(-1/2).*((-6).*(a1.^2+b1.^2).*P1.*phi.*pi.*( ...
    phi+2.*N1.*pi).^(-2)+(a1.^2+b1.^2).*ks1.*phi.*((a1.^2+b1.^2).* ...
    phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2).^( ...
    -1/2)+(-2).*P1.*pi.*(phi+2.*N1.*pi).^(-3).*(B1.^2+(-3).*((a1.^2+ ...
    b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)) ...
    .^2)))+(-1).*(a1.^2+b1.^2).*phi.*(L+b1.*cos(theta).*sin(psi)+(-1) ...
    .*a1.*sin(theta)).*((-1).*a1.*cos(theta)+(-1).*b1.*sin(psi).*sin( ...
    theta)).*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).* ...
    a1.*sin(theta)).^2).^(-3/2).*(ks1.*((-1).*L+((a1.^2+b1.^2).* ...
    phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2).^( ...
    1/2))+P1.*pi.*(phi+2.*N1.*pi).^(-2).*(B1.^2+(-3).*((a1.^2+b1.^2).* ...
    phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2)))+(L+ ...
    b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).*((-1).*a2.*cos( ...
    theta)+(-1).*b2.*sin(psi).*sin(theta)).*((a2.^2+b2.^2).*phi.^2+(L+ ...
    b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^(-1/2).*((-6) ...
    .*(a2.^2+b2.^2).*P2.*phi.*pi.*(phi+2.*N2.*pi).^(-2)+(a2.^2+b2.^2) ...
    .*ks2.*phi.*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+( ...
    -1).*a2.*sin(theta)).^2).^(-1/2)+(-2).*P2.*pi.*(phi+2.*N2.*pi).^( ...
    -3).*(B2.^2+(-3).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin( ...
    psi)+(-1).*a2.*sin(theta)).^2)))+(-1).*(a2.^2+b2.^2).*phi.*(L+b2.* ...
    cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).*((-1).*a2.*cos(theta)+ ...
    (-1).*b2.*sin(psi).*sin(theta)).*((a2.^2+b2.^2).*phi.^2+(L+b2.* ...
    cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^(-3/2).*(ks2.*(( ...
    -1).*L+((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).* ...
    a2.*sin(theta)).^2).^(1/2))+P2.*pi.*(phi+2.*N2.*pi).^(-2).*(B2.^2+ ...
    (-3).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).* ...
    a2.*sin(theta)).^2)))+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin( ...
    theta)).*((-1).*a3.*cos(theta)+(-1).*b3.*sin(psi).*sin(theta)).*(( ...
    a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin( ...
    theta)).^2).^(-1/2).*((-6).*(a3.^2+b3.^2).*P3.*phi.*pi.*(phi+2.* ...
    N3.*pi).^(-2)+(a3.^2+b3.^2).*ks3.*phi.*((a3.^2+b3.^2).*phi.^2+(L+ ...
    b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^(-1/2)+(-2).* ...
    P3.*pi.*(phi+2.*N3.*pi).^(-3).*(B3.^2+(-3).*((a3.^2+b3.^2).* ...
    phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2)))+( ...
    -1).*(a3.^2+b3.^2).*phi.*(L+b3.*cos(theta).*sin(psi)+(-1).*a3.* ...
    sin(theta)).*((-1).*a3.*cos(theta)+(-1).*b3.*sin(psi).*sin(theta)) ...
    .*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.* ...
    sin(theta)).^2).^(-3/2).*(ks3.*((-1).*L+((a3.^2+b3.^2).*phi.^2+(L+ ...
    b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^(1/2))+P3.* ...
    pi.*(phi+2.*N3.*pi).^(-2).*(B3.^2+(-3).*((a3.^2+b3.^2).*phi.^2+(L+ ...
    b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2)))+(L+b4.*cos( ...
    theta).*sin(psi)+(-1).*a4.*sin(theta)).*((-1).*a4.*cos(theta)+(-1) ...
    .*b4.*sin(psi).*sin(theta)).*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos( ...
    theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^(-1/2).*((-6).*(a4.^2+ ...
    b4.^2).*P4.*phi.*pi.*(phi+2.*N4.*pi).^(-2)+(a4.^2+b4.^2).*ks4.* ...
    phi.*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.* ...
    sin(theta)).^2).^(-1/2)+(-2).*P4.*pi.*(phi+2.*N4.*pi).^(-3).*( ...
    B4.^2+(-3).*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+( ...
    -1).*a4.*sin(theta)).^2)))+(-1).*(a4.^2+b4.^2).*phi.*(L+b4.*cos( ...
    theta).*sin(psi)+(-1).*a4.*sin(theta)).*((-1).*a4.*cos(theta)+(-1) ...
    .*b4.*sin(psi).*sin(theta)).*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos( ...
    theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^(-3/2).*(ks4.*((-1).* ...
    L+((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.* ...
    sin(theta)).^2).^(1/2))+P4.*pi.*(phi+2.*N4.*pi).^(-2).*(B4.^2+(-3) ...
    .*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.* ...
    sin(theta)).^2))),(-1/2).*dphi.*L.^2.*m.*cos(phi).^2.*cos(psi) ...
    .^2.*cos(theta)+(1/2).*dphi.*L.^2.*m.*cos(psi).^2.*cos(theta).* ...
    sin(phi).^2+(-1/4).*dtheta.*L.^2.*m.*cos(psi).*cos(theta).^2.*sin( ...
    psi)+(1/2).*dtheta.*L.^2.*m.*cos(phi).^2.*cos(psi).*cos(theta) ...
    .^2.*sin(psi)+dpsi.*L.^2.*m.*cos(phi).*cos(psi).*cos(theta).*sin( ...
    phi).*sin(psi)+(1/2).*dtheta.*L.^2.*m.*cos(psi).*cos(theta).^2.* ...
    sin(phi).^2.*sin(psi)+(-1/2).*dpsi.*L.^2.*m.*cos(psi).^2.*cos( ...
    theta).*sin(theta)+(1/2).*dpsi.*L.^2.*m.*cos(phi).^2.*cos(psi) ...
    .^2.*cos(theta).*sin(theta)+(1/2).*dpsi.*L.^2.*m.*cos(psi).^2.* ...
    cos(theta).*sin(phi).^2.*sin(theta)+(1/4).*dpsi.*L.^2.*m.*cos( ...
    theta).*sin(psi).^2.*sin(theta)+(1/2).*dtheta.*L.^2.*m.*cos(psi).* ...
    sin(psi).*sin(theta).^2+(-1/2).*L.*m.*sin(psi).*sin(theta).*(( ...
    -1/2).*dpsi.*L.*cos(theta).*sin(psi)+(-1/2).*dtheta.*L.*cos(psi).* ...
    sin(theta))+(1/4).*dphi.*L.^2.*m.*cos(psi).*cos(theta).*sin(phi).* ...
    (cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(1/4).* ...
    dpsi.*L.^2.*m.*cos(phi).*cos(theta).*sin(psi).*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(1/4).*dtheta.*L.^2.*m.* ...
    cos(phi).*cos(psi).*sin(theta).*(cos(psi).*sin(phi)+(-1).*cos(phi) ...
    .*sin(psi).*sin(theta))+(1/4).*L.^2.*m.*cos(phi).*cos(theta).*sin( ...
    psi).*(dtheta.*cos(phi).*cos(psi).*cos(theta)+dpsi.*cos(psi).*sin( ...
    phi)+dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin( ...
    theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin(theta))+(-1/4).*dphi.* ...
    L.^2.*m.*cos(phi).*cos(psi).*cos(theta).*(cos(phi).*cos(psi)+(-1) ...
    .*sin(phi).*sin(psi).*sin(theta))+(1/4).*dpsi.*L.^2.*m.*cos(theta) ...
    .*sin(phi).*sin(psi).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi) ...
    .*sin(theta))+(1/4).*dtheta.*L.^2.*m.*cos(psi).*sin(phi).*sin( ...
    theta).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+ ...
    (1/4).*L.^2.*m.*cos(theta).*sin(phi).*sin(psi).*(dpsi.*cos(phi).* ...
    cos(psi)+dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin( ...
    phi).*sin(psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.* ...
    sin(phi).*sin(psi).*sin(theta))+(1/2).*m.*((-1).*L.*sin(psi).*sin( ...
    theta).*((-1/2).*dpsi.*L.*cos(theta).*sin(psi)+(-1/2).*dtheta.*L.* ...
    cos(psi).*sin(theta))+(-1).*L.*cos(theta).*sin(psi).*((-1/2).* ...
    dtheta.*L.*cos(psi).*cos(theta)+(-1/2).*dpsi.*L.*sin(psi).*sin( ...
    theta))+(1/2).*L.^2.*((-1).*dphi.*cos(psi).*cos(theta).*sin(phi)+( ...
    -1).*dpsi.*cos(phi).*cos(theta).*sin(psi)+(-1).*dtheta.*cos(phi).* ...
    cos(psi).*sin(theta)).*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin( ...
    psi).*sin(theta))+(-1/2).*L.^2.*cos(phi).*cos(theta).*sin(psi).*( ...
    dtheta.*cos(phi).*cos(psi).*cos(theta)+dpsi.*cos(psi).*sin(phi)+ ...
    dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin( ...
    theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin(theta))+(1/2).*L.^2.*( ...
    dphi.*cos(phi).*cos(psi).*cos(theta)+(-1).*dpsi.*cos(theta).*sin( ...
    phi).*sin(psi)+(-1).*dtheta.*cos(psi).*sin(phi).*sin(theta)).*( ...
    cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta))+(-1/2).* ...
    L.^2.*cos(theta).*sin(phi).*sin(psi).*(dpsi.*cos(phi).*cos(psi)+ ...
    dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin( ...
    psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).* ...
    sin(psi).*sin(theta))),(-1).*damptheta+(3/4).*dpsi.*L.^2.*m.*cos( ...
    phi).^2.*cos(psi).*cos(theta).^2.*sin(psi)+(3/4).*dpsi.*L.^2.*m.* ...
    cos(psi).*cos(theta).^2.*sin(phi).^2.*sin(psi)+(-3/4).*dtheta.* ...
    L.^2.*m.*cos(psi).^2.*cos(theta).*sin(theta)+(3/4).*dtheta.*L.^2.* ...
    m.*cos(phi).^2.*cos(psi).^2.*cos(theta).*sin(theta)+(3/4).* ...
    dtheta.*L.^2.*m.*cos(psi).^2.*cos(theta).*sin(phi).^2.*sin(theta)+ ...
    (3/4).*dpsi.*L.^2.*m.*cos(psi).*sin(psi).*sin(theta).^2+(1/2).*L.* ...
    m.*cos(psi).*cos(theta).*((-1/2).*dpsi.*L.*cos(theta).*sin(psi)+( ...
    -1/2).*dtheta.*L.*cos(psi).*sin(theta))+(1/4).*L.^2.*m.*cos(phi).* ...
    cos(psi).*sin(theta).*(dtheta.*cos(phi).*cos(psi).*cos(theta)+ ...
    dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos( ...
    psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin( ...
    theta))+(1/4).*L.^2.*m.*cos(psi).*sin(phi).*sin(theta).*(dpsi.* ...
    cos(phi).*cos(psi)+dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).* ...
    dphi.*sin(phi).*sin(psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1) ...
    .*dpsi.*sin(phi).*sin(psi).*sin(theta))+(1/2).*m.*((-1).*L.*cos( ...
    psi).*cos(theta).*((-1/2).*dpsi.*L.*cos(theta).*sin(psi)+(-1/2).* ...
    dtheta.*L.*cos(psi).*sin(theta))+(1/2).*L.^2.*cos(phi).*cos(psi).* ...
    cos(theta).*((-1).*dphi.*cos(psi).*cos(theta).*sin(phi)+(-1).* ...
    dpsi.*cos(phi).*cos(theta).*sin(psi)+(-1).*dtheta.*cos(phi).*cos( ...
    psi).*sin(theta))+(1/2).*L.^2.*cos(psi).*cos(theta).*sin(phi).*( ...
    dphi.*cos(phi).*cos(psi).*cos(theta)+(-1).*dpsi.*cos(theta).*sin( ...
    phi).*sin(psi)+(-1).*dtheta.*cos(psi).*sin(phi).*sin(theta))+(-1) ...
    .*L.*cos(psi).*sin(theta).*((-1/2).*dtheta.*L.*cos(psi).*cos( ...
    theta)+(-1/2).*dpsi.*L.*sin(psi).*sin(theta))+(-1/2).*L.^2.*cos( ...
    phi).*cos(psi).*sin(theta).*(dtheta.*cos(phi).*cos(psi).*cos( ...
    theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi).*sin(psi)+(-1).* ...
    dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos(phi).*sin( ...
    psi).*sin(theta))+(-1/2).*L.^2.*cos(psi).*sin(phi).*sin(theta).*( ...
    dpsi.*cos(phi).*cos(psi)+dtheta.*cos(psi).*cos(theta).*sin(phi)+( ...
    -1).*dphi.*sin(phi).*sin(psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).*sin(psi).*sin(theta))),(-1/2).*dpsi.*L.^2.* ...
    m.*cos(phi).^2.*cos(psi).^2.*cos(theta)+(1/2).*dpsi.*L.^2.*m.*cos( ...
    psi).^2.*cos(theta).*sin(phi).^2+dphi.*L.^2.*m.*cos(phi).*cos(psi) ...
    .*cos(theta).*sin(phi).*sin(psi)+(1/2).*dphi.*L.^2.*m.*cos(phi) ...
    .^2.*cos(psi).^2.*cos(theta).*sin(theta)+(1/2).*dphi.*L.^2.*m.* ...
    cos(psi).^2.*cos(theta).*sin(phi).^2.*sin(theta)+(-1/4).*dphi.* ...
    L.^2.*m.*cos(phi).*cos(psi).*cos(theta).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+(1/4).*dpsi.*L.^2.*m.*cos(theta) ...
    .*sin(phi).*sin(psi).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi) ...
    .*sin(theta))+(1/4).*dtheta.*L.^2.*m.*cos(psi).*sin(phi).*sin( ...
    theta).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+ ...
    (1/4).*dphi.*L.^2.*m.*cos(psi).*cos(theta).*sin(phi).*(cos(phi).* ...
    sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(1/4).*dpsi.*L.^2.* ...
    m.*cos(phi).*cos(theta).*sin(psi).*(cos(phi).*sin(psi)+(-1).*cos( ...
    psi).*sin(phi).*sin(theta))+(1/4).*dtheta.*L.^2.*m.*cos(phi).*cos( ...
    psi).*sin(theta).*(cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).* ...
    sin(theta))+(1/4).*L.^2.*m.*cos(psi).*cos(theta).*sin(phi).*( ...
    dtheta.*cos(phi).*cos(psi).*cos(theta)+dpsi.*cos(psi).*sin(phi)+ ...
    dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin( ...
    theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin(theta))+(-1/4).*L.^2.* ...
    m.*cos(phi).*cos(psi).*cos(theta).*(dpsi.*cos(phi).*cos(psi)+ ...
    dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin( ...
    psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).* ...
    sin(psi).*sin(theta))+(1/2).*m.*((1/2).*L.^2.*((-1).*dphi.*cos( ...
    psi).*cos(theta).*sin(phi)+(-1).*dpsi.*cos(phi).*cos(theta).*sin( ...
    psi)+(-1).*dtheta.*cos(phi).*cos(psi).*sin(theta)).*(cos(phi).* ...
    sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(1/2).*L.^2.*((-1) ...
    .*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta)).*(dphi.*cos( ...
    phi).*cos(psi).*cos(theta)+(-1).*dpsi.*cos(theta).*sin(phi).*sin( ...
    psi)+(-1).*dtheta.*cos(psi).*sin(phi).*sin(theta))+(-1/2).*L.^2.* ...
    cos(psi).*cos(theta).*sin(phi).*(dtheta.*cos(phi).*cos(psi).*cos( ...
    theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi).*sin(psi)+(-1).* ...
    dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos(phi).*sin( ...
    psi).*sin(theta))+(1/2).*L.^2.*cos(phi).*cos(psi).*cos(theta).*( ...
    dpsi.*cos(phi).*cos(psi)+dtheta.*cos(psi).*cos(theta).*sin(phi)+( ...
    -1).*dphi.*sin(phi).*sin(psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).*sin(psi).*sin(theta)));(1/4).*dphi.^2.* ...
    L.^2.*m.*cos(phi).*cos(psi).*((-1).*sin(phi).*sin(psi)+cos(phi).* ...
    cos(psi).*sin(theta))+(1/4).*dpsi.^2.*L.^2.*m.*cos(phi).*cos(psi) ...
    .*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+(1/2) ...
    .*dpsi.*dtheta.*L.^2.*m.*cos(psi).*cos(theta).*sin(phi).*((-1).* ...
    sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+(1/2).*dphi.* ...
    dtheta.*L.^2.*m.*cos(phi).*cos(theta).*sin(psi).*((-1).*sin(phi).* ...
    sin(psi)+cos(phi).*cos(psi).*sin(theta))+(-1/2).*dphi.*dpsi.* ...
    L.^2.*m.*sin(phi).*sin(psi).*((-1).*sin(phi).*sin(psi)+cos(phi).* ...
    cos(psi).*sin(theta))+(1/2).*dphi.*dpsi.*L.^2.*m.*cos(phi).*cos( ...
    psi).*sin(theta).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).* ...
    sin(theta))+(-1/4).*dphi.^2.*L.^2.*m.*sin(phi).*sin(psi).*sin( ...
    theta).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+ ...
    (-1/4).*dpsi.^2.*L.^2.*m.*sin(phi).*sin(psi).*sin(theta).*((-1).* ...
    sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+(-1/4).* ...
    dtheta.^2.*L.^2.*m.*sin(phi).*sin(psi).*sin(theta).*((-1).*sin( ...
    phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+(1/2).*dpsi.* ...
    dtheta.*L.^2.*m.*cos(phi).*cos(psi).*cos(theta).*(cos(phi).*sin( ...
    psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(1/4).*dphi.^2.*L.^2.* ...
    m.*cos(psi).*sin(phi).*(cos(phi).*sin(psi)+(-1).*cos(psi).*sin( ...
    phi).*sin(theta))+(1/4).*dpsi.^2.*L.^2.*m.*cos(psi).*sin(phi).*( ...
    cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(1/2).* ...
    dphi.*dpsi.*L.^2.*m.*cos(phi).*sin(psi).*(cos(phi).*sin(psi)+(-1) ...
    .*cos(psi).*sin(phi).*sin(theta))+(-1/2).*dphi.*dtheta.*L.^2.*m.* ...
    cos(theta).*sin(phi).*sin(psi).*(cos(phi).*sin(psi)+(-1).*cos(psi) ...
    .*sin(phi).*sin(theta))+(-1/2).*dphi.*dpsi.*L.^2.*m.*cos(psi).* ...
    sin(phi).*sin(theta).*(cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi) ...
    .*sin(theta))+(-1/4).*dphi.^2.*L.^2.*m.*cos(phi).*sin(psi).*sin( ...
    theta).*(cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+ ...
    (-1/4).*dpsi.^2.*L.^2.*m.*cos(phi).*sin(psi).*sin(theta).*(cos( ...
    phi).*sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(-1/4).* ...
    dtheta.^2.*L.^2.*m.*cos(phi).*sin(psi).*sin(theta).*(cos(phi).* ...
    sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(-1/2).*dphi.* ...
    dtheta.*L.^2.*m.*cos(phi).*cos(psi).*cos(theta).*((-1).*cos(psi).* ...
    sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(1/2).*dphi.*dpsi.* ...
    L.^2.*m.*cos(psi).*sin(phi).*((-1).*cos(psi).*sin(phi)+(-1).*cos( ...
    phi).*sin(psi).*sin(theta))+(1/4).*dphi.^2.*L.^2.*m.*cos(phi).* ...
    sin(psi).*((-1).*cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin( ...
    theta))+(1/4).*dpsi.^2.*L.^2.*m.*cos(phi).*sin(psi).*((-1).*cos( ...
    psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(1/2).*dpsi.* ...
    dtheta.*L.^2.*m.*cos(theta).*sin(phi).*sin(psi).*((-1).*cos(psi).* ...
    sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(1/4).*dphi.^2.* ...
    L.^2.*m.*cos(psi).*sin(phi).*sin(theta).*((-1).*cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(1/4).*dpsi.^2.*L.^2.*m.* ...
    cos(psi).*sin(phi).*sin(theta).*((-1).*cos(psi).*sin(phi)+(-1).* ...
    cos(phi).*sin(psi).*sin(theta))+(1/4).*dtheta.^2.*L.^2.*m.*cos( ...
    psi).*sin(phi).*sin(theta).*((-1).*cos(psi).*sin(phi)+(-1).*cos( ...
    phi).*sin(psi).*sin(theta))+(1/2).*dphi.*dpsi.*L.^2.*m.*cos(phi).* ...
    sin(psi).*sin(theta).*((-1).*cos(psi).*sin(phi)+(-1).*cos(phi).* ...
    sin(psi).*sin(theta))+(-1/4).*L.^2.*m.*((-1).*dphi.*cos(psi).*sin( ...
    phi)+(-1).*dpsi.*cos(phi).*sin(psi)+(-1).*dtheta.*cos(theta).*sin( ...
    phi).*sin(psi)+(-1).*dpsi.*cos(psi).*sin(phi).*sin(theta)+(-1).* ...
    dphi.*cos(phi).*sin(psi).*sin(theta)).*(dtheta.*cos(phi).*cos(psi) ...
    .*cos(theta)+(-1).*dpsi.*cos(psi).*sin(phi)+(-1).*dphi.*cos(phi).* ...
    sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.* ...
    cos(phi).*sin(psi).*sin(theta))+(-1/4).*L.^2.*m.*((-1).*dphi.*cos( ...
    psi).*sin(phi)+(-1).*dpsi.*cos(phi).*sin(psi)+dtheta.*cos(theta).* ...
    sin(phi).*sin(psi)+dpsi.*cos(psi).*sin(phi).*sin(theta)+dphi.*cos( ...
    phi).*sin(psi).*sin(theta)).*(dtheta.*cos(phi).*cos(psi).*cos( ...
    theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi).*sin(psi)+(-1).* ...
    dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos(phi).*sin( ...
    psi).*sin(theta))+(-1/2).*dphi.*dpsi.*L.^2.*m.*cos(phi).*cos(psi) ...
    .*(cos(phi).*cos(psi)+sin(phi).*sin(psi).*sin(theta))+(1/2).* ...
    dphi.*dtheta.*L.^2.*m.*cos(psi).*cos(theta).*sin(phi).*(cos(phi).* ...
    cos(psi)+sin(phi).*sin(psi).*sin(theta))+(1/2).*dpsi.*dtheta.* ...
    L.^2.*m.*cos(phi).*cos(theta).*sin(psi).*(cos(phi).*cos(psi)+sin( ...
    phi).*sin(psi).*sin(theta))+(1/4).*dphi.^2.*L.^2.*m.*sin(phi).* ...
    sin(psi).*(cos(phi).*cos(psi)+sin(phi).*sin(psi).*sin(theta))+( ...
    1/4).*dpsi.^2.*L.^2.*m.*sin(phi).*sin(psi).*(cos(phi).*cos(psi)+ ...
    sin(phi).*sin(psi).*sin(theta))+(1/4).*dphi.^2.*L.^2.*m.*cos(phi) ...
    .*cos(psi).*sin(theta).*(cos(phi).*cos(psi)+sin(phi).*sin(psi).* ...
    sin(theta))+(1/4).*dpsi.^2.*L.^2.*m.*cos(phi).*cos(psi).*sin( ...
    theta).*(cos(phi).*cos(psi)+sin(phi).*sin(psi).*sin(theta))+(1/4) ...
    .*dtheta.^2.*L.^2.*m.*cos(phi).*cos(psi).*sin(theta).*(cos(phi).* ...
    cos(psi)+sin(phi).*sin(psi).*sin(theta))+(-1/2).*dphi.*dpsi.* ...
    L.^2.*m.*sin(phi).*sin(psi).*sin(theta).*(cos(phi).*cos(psi)+sin( ...
    phi).*sin(psi).*sin(theta))+(-1/4).*L.^2.*m.*((-1).*dphi.*cos(phi) ...
    .*cos(psi)+(-1).*dtheta.*cos(phi).*cos(theta).*sin(psi)+dpsi.*sin( ...
    phi).*sin(psi)+(-1).*dpsi.*cos(phi).*cos(psi).*sin(theta)+dphi.* ...
    sin(phi).*sin(psi).*sin(theta)).*(dpsi.*cos(phi).*cos(psi)+ ...
    dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin( ...
    psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).* ...
    sin(psi).*sin(theta))+(-1/4).*L.^2.*m.*(dphi.*cos(phi).*cos(psi)+( ...
    -1).*dtheta.*cos(phi).*cos(theta).*sin(psi)+(-1).*dpsi.*sin(phi).* ...
    sin(psi)+(-1).*dpsi.*cos(phi).*cos(psi).*sin(theta)+dphi.*sin(phi) ...
    .*sin(psi).*sin(theta)).*(dpsi.*cos(phi).*cos(psi)+(-1).*dtheta.* ...
    cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin(psi)+(-1) ...
    .*dphi.*cos(phi).*cos(psi).*sin(theta)+dpsi.*sin(phi).*sin(psi).* ...
    sin(theta))+4.*b1.*P1.*pi.*(phi+2.*N1.*pi).^(-3).*cos(psi).*cos( ...
    theta).*(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).*(( ...
    a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin( ...
    theta)).^2).^(1/2)+2.*b1.*P1.*pi.*(phi+2.*N1.*pi).^(-3).*cos(psi) ...
    .*cos(theta).*(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).*( ...
    (a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin( ...
    theta)).^2).^(-1/2).*((-1).*B1.^2+(a1.^2+b1.^2).*phi.^2+(L+b1.* ...
    cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2)+4.*b2.*P2.*pi.*( ...
    phi+2.*N2.*pi).^(-3).*cos(psi).*cos(theta).*(L+b2.*cos(theta).* ...
    sin(psi)+(-1).*a2.*sin(theta)).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos( ...
    theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^(1/2)+2.*b2.*P2.*pi.*( ...
    phi+2.*N2.*pi).^(-3).*cos(psi).*cos(theta).*(L+b2.*cos(theta).* ...
    sin(psi)+(-1).*a2.*sin(theta)).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos( ...
    theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^(-1/2).*((-1).*B2.^2+( ...
    a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin( ...
    theta)).^2)+4.*b3.*P3.*pi.*(phi+2.*N3.*pi).^(-3).*cos(psi).*cos( ...
    theta).*(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).*(( ...
    a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin( ...
    theta)).^2).^(1/2)+2.*b3.*P3.*pi.*(phi+2.*N3.*pi).^(-3).*cos(psi) ...
    .*cos(theta).*(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).*( ...
    (a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin( ...
    theta)).^2).^(-1/2).*((-1).*B3.^2+(a3.^2+b3.^2).*phi.^2+(L+b3.* ...
    cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2)+4.*b4.*P4.*pi.*( ...
    phi+2.*N4.*pi).^(-3).*cos(psi).*cos(theta).*(L+b4.*cos(theta).* ...
    sin(psi)+(-1).*a4.*sin(theta)).*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos( ...
    theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^(1/2)+2.*b4.*P4.*pi.*( ...
    phi+2.*N4.*pi).^(-3).*cos(psi).*cos(theta).*(L+b4.*cos(theta).* ...
    sin(psi)+(-1).*a4.*sin(theta)).*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos( ...
    theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^(-1/2).*((-1).*B4.^2+( ...
    a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin( ...
    theta)).^2)+(-1).*ddtheta.*((-1/4).*L.^2.*m.*cos(theta).*sin(phi) ...
    .*sin(psi).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin( ...
    theta))+(-1/4).*L.^2.*m.*cos(phi).*cos(theta).*sin(psi).*(cos(phi) ...
    .*sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(1/4).*L.^2.*m.* ...
    cos(psi).*cos(theta).*sin(phi).*((-1).*cos(psi).*sin(phi)+(-1).* ...
    cos(phi).*sin(psi).*sin(theta))+(1/4).*L.^2.*m.*cos(phi).*cos(psi) ...
    .*cos(theta).*(cos(phi).*cos(psi)+sin(phi).*sin(psi).*sin(theta)))+(-1).*ddphi.*((-1/4).*L.^2.*m.*cos(psi).*sin(phi).*((-1).*sin( ...
    phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+(-1/4).*L.^2.*m.* ...
    cos(phi).*sin(psi).*sin(theta).*((-1).*sin(phi).*sin(psi)+cos(phi) ...
    .*cos(psi).*sin(theta))+(1/4).*L.^2.*m.*cos(phi).*cos(psi).*(cos( ...
    phi).*sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(1/4).*L.^2.* ...
    m.*sin(phi).*sin(psi).*sin(theta).*(cos(phi).*sin(psi)+(-1).*cos( ...
    psi).*sin(phi).*sin(theta))+(-1/4).*L.^2.*m.*sin(phi).*sin(psi).*( ...
    (-1).*cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+( ...
    1/4).*L.^2.*m.*cos(phi).*cos(psi).*sin(theta).*((-1).*cos(psi).* ...
    sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(1/4).*L.^2.*m.* ...
    cos(phi).*sin(psi).*(cos(phi).*cos(psi)+sin(phi).*sin(psi).*sin( ...
    theta))+(-1/4).*L.^2.*m.*cos(psi).*sin(phi).*sin(theta).*(cos(phi) ...
    .*cos(psi)+sin(phi).*sin(psi).*sin(theta)))+(-1).*ddpsi.*((-1/4).* ...
    L.^2.*m.*cos(phi).*sin(psi).*((-1).*sin(phi).*sin(psi)+cos(phi).* ...
    cos(psi).*sin(theta))+(-1/4).*L.^2.*m.*cos(psi).*sin(phi).*sin( ...
    theta).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+ ...
    (-1/4).*L.^2.*m.*sin(phi).*sin(psi).*(cos(phi).*sin(psi)+(-1).* ...
    cos(psi).*sin(phi).*sin(theta))+(-1/4).*L.^2.*m.*cos(phi).*cos( ...
    psi).*sin(theta).*(cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).* ...
    sin(theta))+(1/4).*L.^2.*m.*cos(phi).*cos(psi).*((-1).*cos(psi).* ...
    sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(-1/4).*L.^2.*m.* ...
    sin(phi).*sin(psi).*sin(theta).*((-1).*cos(psi).*sin(phi)+(-1).* ...
    cos(phi).*sin(psi).*sin(theta))+(1/4).*L.^2.*m.*cos(psi).*sin(phi) ...
    .*(cos(phi).*cos(psi)+sin(phi).*sin(psi).*sin(theta))+(-1/4).* ...
    L.^2.*m.*cos(phi).*sin(psi).*sin(theta).*(cos(phi).*cos(psi)+sin( ...
    phi).*sin(psi).*sin(theta)))+(1/2).*m.*((1/2).*L.^2.*((-1).*dphi.* ...
    cos(psi).*sin(phi)+(-1).*dpsi.*cos(phi).*sin(psi)+(-1).*dtheta.* ...
    cos(theta).*sin(phi).*sin(psi)+(-1).*dpsi.*cos(psi).*sin(phi).* ...
    sin(theta)+(-1).*dphi.*cos(phi).*sin(psi).*sin(theta)).*(dtheta.* ...
    cos(phi).*cos(psi).*cos(theta)+(-1).*dpsi.*cos(psi).*sin(phi)+(-1) ...
    .*dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin( ...
    theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin(theta))+(1/2).*L.^2.*(( ...
    -1).*dphi.*cos(psi).*sin(phi)+(-1).*dpsi.*cos(phi).*sin(psi)+ ...
    dtheta.*cos(theta).*sin(phi).*sin(psi)+dpsi.*cos(psi).*sin(phi).* ...
    sin(theta)+dphi.*cos(phi).*sin(psi).*sin(theta)).*(dtheta.*cos( ...
    phi).*cos(psi).*cos(theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi) ...
    .*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.* ...
    cos(phi).*sin(psi).*sin(theta))+(1/2).*L.^2.*((-1).*dphi.*cos(phi) ...
    .*cos(psi)+(-1).*dtheta.*cos(phi).*cos(theta).*sin(psi)+dpsi.*sin( ...
    phi).*sin(psi)+(-1).*dpsi.*cos(phi).*cos(psi).*sin(theta)+dphi.* ...
    sin(phi).*sin(psi).*sin(theta)).*(dpsi.*cos(phi).*cos(psi)+ ...
    dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin( ...
    psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).* ...
    sin(psi).*sin(theta))+(1/2).*L.^2.*(dphi.*cos(phi).*cos(psi)+(-1) ...
    .*dtheta.*cos(phi).*cos(theta).*sin(psi)+(-1).*dpsi.*sin(phi).* ...
    sin(psi)+(-1).*dpsi.*cos(phi).*cos(psi).*sin(theta)+dphi.*sin(phi) ...
    .*sin(psi).*sin(theta)).*(dpsi.*cos(phi).*cos(psi)+(-1).*dtheta.* ...
    cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin(psi)+(-1) ...
    .*dphi.*cos(phi).*cos(psi).*sin(theta)+dpsi.*sin(phi).*sin(psi).* ...
    sin(theta)))+(a1.^2+b1.^2).*phi.*((a1.^2+b1.^2).*phi.^2+(L+b1.* ...
    cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2).^(-1/2).*((-6).* ...
    b1.*P1.*pi.*(phi+2.*N1.*pi).^(-2).*cos(psi).*cos(theta).*(L+b1.* ...
    cos(theta).*sin(psi)+(-1).*a1.*sin(theta))+b1.*ks1.*cos(psi).*cos( ...
    theta).*(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).*(( ...
    a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin( ...
    theta)).^2).^(-1/2))+(a2.^2+b2.^2).*phi.*((a2.^2+b2.^2).*phi.^2+( ...
    L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^(-1/2).*(( ...
    -6).*b2.*P2.*pi.*(phi+2.*N2.*pi).^(-2).*cos(psi).*cos(theta).*(L+ ...
    b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta))+b2.*ks2.*cos(psi).* ...
    cos(theta).*(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).*(( ...
    a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin( ...
    theta)).^2).^(-1/2))+(a3.^2+b3.^2).*phi.*((a3.^2+b3.^2).*phi.^2+( ...
    L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^(-1/2).*(( ...
    -6).*b3.*P3.*pi.*(phi+2.*N3.*pi).^(-2).*cos(psi).*cos(theta).*(L+ ...
    b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta))+b3.*ks3.*cos(psi).* ...
    cos(theta).*(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).*(( ...
    a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin( ...
    theta)).^2).^(-1/2))+(a4.^2+b4.^2).*phi.*((a4.^2+b4.^2).*phi.^2+( ...
    L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^(-1/2).*(( ...
    -6).*b4.*P4.*pi.*(phi+2.*N4.*pi).^(-2).*cos(psi).*cos(theta).*(L+ ...
    b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta))+b4.*ks4.*cos(psi).* ...
    cos(theta).*(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).*(( ...
    a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin( ...
    theta)).^2).^(-1/2))+(-1).*b1.*(a1.^2+b1.^2).*phi.*cos(psi).*cos( ...
    theta).*(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).*(( ...
    a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin( ...
    theta)).^2).^(-3/2).*(ks1.*((-1).*L+((a1.^2+b1.^2).*phi.^2+(L+b1.* ...
    cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2).^(1/2))+P1.*pi.*( ...
    phi+2.*N1.*pi).^(-2).*(B1.^2+(-3).*((a1.^2+b1.^2).*phi.^2+(L+b1.* ...
    cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2)))+(-1).*b2.*(a2.^2+ ...
    b2.^2).*phi.*cos(psi).*cos(theta).*(L+b2.*cos(theta).*sin(psi)+( ...
    -1).*a2.*sin(theta)).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).* ...
    sin(psi)+(-1).*a2.*sin(theta)).^2).^(-3/2).*(ks2.*((-1).*L+(( ...
    a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin( ...
    theta)).^2).^(1/2))+P2.*pi.*(phi+2.*N2.*pi).^(-2).*(B2.^2+(-3).*(( ...
    a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin( ...
    theta)).^2)))+(-1).*b3.*(a3.^2+b3.^2).*phi.*cos(psi).*cos(theta).* ...
    (L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).*((a3.^2+b3.^2) ...
    .*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^( ...
    -3/2).*(ks3.*((-1).*L+((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).* ...
    sin(psi)+(-1).*a3.*sin(theta)).^2).^(1/2))+P3.*pi.*(phi+2.*N3.*pi) ...
    .^(-2).*(B3.^2+(-3).*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).* ...
    sin(psi)+(-1).*a3.*sin(theta)).^2)))+(-1).*b4.*(a4.^2+b4.^2).* ...
    phi.*cos(psi).*cos(theta).*(L+b4.*cos(theta).*sin(psi)+(-1).*a4.* ...
    sin(theta)).*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+( ...
    -1).*a4.*sin(theta)).^2).^(-3/2).*(ks4.*((-1).*L+((a4.^2+b4.^2).* ...
    phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^( ...
    1/2))+P4.*pi.*(phi+2.*N4.*pi).^(-2).*(B4.^2+(-3).*((a4.^2+b4.^2).* ...
    phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2))),( ...
    -1/2).*dphi.*dtheta.*L.^2.*m.*cos(phi).^2.*cos(psi).^2.*cos(theta) ...
    .^2+dphi.*dpsi.*L.^2.*m.*cos(phi).*cos(psi).^2.*cos(theta).*sin( ...
    phi)+(-1/2).*dphi.*dtheta.*L.^2.*m.*cos(psi).^2.*cos(theta).^2.* ...
    sin(phi).^2+(1/4).*dphi.^2.*L.^2.*m.*cos(phi).^2.*cos(psi).*cos( ...
    theta).*sin(psi)+(1/4).*dpsi.^2.*L.^2.*m.*cos(phi).^2.*cos(psi).* ...
    cos(theta).*sin(psi)+(-1/4).*dphi.^2.*L.^2.*m.*cos(psi).*cos( ...
    theta).*sin(phi).^2.*sin(psi)+(-1/4).*dpsi.^2.*L.^2.*m.*cos(psi).* ...
    cos(theta).*sin(phi).^2.*sin(psi)+(1/2).*dphi.*dpsi.*L.^2.*m.*cos( ...
    phi).^2.*cos(psi).*cos(theta).*sin(psi).*sin(theta)+(1/2).*dphi.* ...
    dpsi.*L.^2.*m.*cos(psi).*cos(theta).*sin(phi).^2.*sin(psi).*sin( ...
    theta)+(1/4).*dphi.^2.*L.^2.*m.*cos(psi).*cos(theta).*sin(phi).*(( ...
    -1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+(1/4).* ...
    dpsi.^2.*L.^2.*m.*cos(psi).*cos(theta).*sin(phi).*((-1).*sin(phi) ...
    .*sin(psi)+cos(phi).*cos(psi).*sin(theta))+(1/4).*dtheta.^2.* ...
    L.^2.*m.*cos(psi).*cos(theta).*sin(phi).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+(1/2).*dphi.*dpsi.*L.^2.*m.*cos( ...
    phi).*cos(theta).*sin(psi).*((-1).*sin(phi).*sin(psi)+cos(phi).* ...
    cos(psi).*sin(theta))+(1/2).*dphi.*dtheta.*L.^2.*m.*cos(phi).*cos( ...
    psi).*sin(theta).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).* ...
    sin(theta))+(-1/2).*dpsi.*dtheta.*L.^2.*m.*sin(phi).*sin(psi).* ...
    sin(theta).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin( ...
    theta))+(1/4).*dphi.^2.*L.^2.*m.*cos(phi).*cos(psi).*cos(theta).*( ...
    cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(1/4).* ...
    dpsi.^2.*L.^2.*m.*cos(phi).*cos(psi).*cos(theta).*(cos(phi).*sin( ...
    psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(1/4).*dtheta.^2.* ...
    L.^2.*m.*cos(phi).*cos(psi).*cos(theta).*(cos(phi).*sin(psi)+(-1) ...
    .*cos(psi).*sin(phi).*sin(theta))+(-1/2).*dphi.*dpsi.*L.^2.*m.* ...
    cos(theta).*sin(phi).*sin(psi).*(cos(phi).*sin(psi)+(-1).*cos(psi) ...
    .*sin(phi).*sin(theta))+(-1/2).*dphi.*dtheta.*L.^2.*m.*cos(psi).* ...
    sin(phi).*sin(theta).*(cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi) ...
    .*sin(theta))+(-1/2).*dpsi.*dtheta.*L.^2.*m.*cos(phi).*sin(psi).* ...
    sin(theta).*(cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).*sin( ...
    theta))+(-1/4).*L.^2.*m.*(dphi.*cos(phi).*cos(psi).*cos(theta)+( ...
    -1).*dpsi.*cos(theta).*sin(phi).*sin(psi)+(-1).*dtheta.*cos(psi).* ...
    sin(phi).*sin(theta)).*(dtheta.*cos(phi).*cos(psi).*cos(theta)+( ...
    -1).*dpsi.*cos(psi).*sin(phi)+(-1).*dphi.*cos(phi).*sin(psi)+(-1) ...
    .*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos(phi).*sin( ...
    psi).*sin(theta))+(-1/4).*L.^2.*m.*((-1).*dphi.*cos(phi).*cos(psi) ...
    .*cos(theta)+dpsi.*cos(theta).*sin(phi).*sin(psi)+dtheta.*cos(psi) ...
    .*sin(phi).*sin(theta)).*(dtheta.*cos(phi).*cos(psi).*cos(theta)+ ...
    dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos( ...
    psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin( ...
    theta))+(-1/4).*L.^2.*m.*((-1).*dphi.*cos(psi).*cos(theta).*sin( ...
    phi)+(-1).*dpsi.*cos(phi).*cos(theta).*sin(psi)+(-1).*dtheta.*cos( ...
    phi).*cos(psi).*sin(theta)).*(dpsi.*cos(phi).*cos(psi)+dtheta.* ...
    cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin(psi)+ ...
    dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).*sin( ...
    psi).*sin(theta))+(-1/4).*L.^2.*m.*((-1).*dphi.*cos(psi).*cos( ...
    theta).*sin(phi)+(-1).*dpsi.*cos(phi).*cos(theta).*sin(psi)+(-1).* ...
    dtheta.*cos(phi).*cos(psi).*sin(theta)).*(dpsi.*cos(phi).*cos(psi)+(-1).*dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi) ...
    .*sin(psi)+(-1).*dphi.*cos(phi).*cos(psi).*sin(theta)+dpsi.*sin( ...
    phi).*sin(psi).*sin(theta))+4.*P1.*pi.*(phi+2.*N1.*pi).^(-3).*(L+ ...
    b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).*((-1).*a1.*cos( ...
    theta)+(-1).*b1.*sin(psi).*sin(theta)).*((a1.^2+b1.^2).*phi.^2+(L+ ...
    b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2).^(1/2)+2.*P1.* ...
    pi.*(phi+2.*N1.*pi).^(-3).*(L+b1.*cos(theta).*sin(psi)+(-1).*a1.* ...
    sin(theta)).*((-1).*a1.*cos(theta)+(-1).*b1.*sin(psi).*sin(theta)) ...
    .*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.* ...
    sin(theta)).^2).^(-1/2).*((-1).*B1.^2+(a1.^2+b1.^2).*phi.^2+(L+ ...
    b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2)+4.*P2.*pi.*( ...
    phi+2.*N2.*pi).^(-3).*(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin( ...
    theta)).*((-1).*a2.*cos(theta)+(-1).*b2.*sin(psi).*sin(theta)).*(( ...
    a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin( ...
    theta)).^2).^(1/2)+2.*P2.*pi.*(phi+2.*N2.*pi).^(-3).*(L+b2.*cos( ...
    theta).*sin(psi)+(-1).*a2.*sin(theta)).*((-1).*a2.*cos(theta)+(-1) ...
    .*b2.*sin(psi).*sin(theta)).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos( ...
    theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^(-1/2).*((-1).*B2.^2+( ...
    a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin( ...
    theta)).^2)+4.*P3.*pi.*(phi+2.*N3.*pi).^(-3).*(L+b3.*cos(theta).* ...
    sin(psi)+(-1).*a3.*sin(theta)).*((-1).*a3.*cos(theta)+(-1).*b3.* ...
    sin(psi).*sin(theta)).*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).* ...
    sin(psi)+(-1).*a3.*sin(theta)).^2).^(1/2)+2.*P3.*pi.*(phi+2.*N3.* ...
    pi).^(-3).*(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).*(( ...
    -1).*a3.*cos(theta)+(-1).*b3.*sin(psi).*sin(theta)).*((a3.^2+ ...
    b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)) ...
    .^2).^(-1/2).*((-1).*B3.^2+(a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta) ...
    .*sin(psi)+(-1).*a3.*sin(theta)).^2)+4.*P4.*pi.*(phi+2.*N4.*pi).^( ...
    -3).*(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).*((-1).* ...
    a4.*cos(theta)+(-1).*b4.*sin(psi).*sin(theta)).*((a4.^2+b4.^2).* ...
    phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^( ...
    1/2)+2.*P4.*pi.*(phi+2.*N4.*pi).^(-3).*(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).*((-1).*a4.*cos(theta)+(-1).*b4.*sin(psi).* ...
    sin(theta)).*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+( ...
    -1).*a4.*sin(theta)).^2).^(-1/2).*((-1).*B4.^2+(a4.^2+b4.^2).* ...
    phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2)+(-1) ...
    .*ddphi.*((-1/2).*L.^2.*m.*cos(phi).*cos(psi).*cos(theta).*sin( ...
    phi).*sin(psi)+(1/4).*L.^2.*m.*cos(phi).^2.*cos(psi).^2.*cos( ...
    theta).*sin(theta)+(1/4).*L.^2.*m.*cos(psi).^2.*cos(theta).*sin( ...
    phi).^2.*sin(theta)+(1/4).*L.^2.*m.*cos(phi).*cos(psi).*cos(theta) ...
    .*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+(-1/4) ...
    .*L.^2.*m.*cos(psi).*cos(theta).*sin(phi).*(cos(phi).*sin(psi)+( ...
    -1).*cos(psi).*sin(phi).*sin(theta)))+(-1).*ddpsi.*((1/4).*L.^2.* ...
    m.*cos(phi).^2.*cos(psi).^2.*cos(theta)+(-1/4).*L.^2.*m.*cos(psi) ...
    .^2.*cos(theta).*sin(phi).^2+(-1/4).*L.^2.*m.*cos(theta).*sin(phi) ...
    .*sin(psi).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin( ...
    theta))+(-1/4).*L.^2.*m.*cos(phi).*cos(theta).*sin(psi).*(cos(phi) ...
    .*sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta)))+(-1).*ddtheta.*( ...
    (-1/4).*L.^2.*m.*cos(psi).*sin(phi).*sin(theta).*((-1).*sin(phi).* ...
    sin(psi)+cos(phi).*cos(psi).*sin(theta))+(-1/4).*L.^2.*m.*cos(phi) ...
    .*cos(psi).*sin(theta).*(cos(phi).*sin(psi)+(-1).*cos(psi).*sin( ...
    phi).*sin(theta)))+(1/2).*m.*((1/2).*L.^2.*(dphi.*cos(phi).*cos( ...
    psi).*cos(theta)+(-1).*dpsi.*cos(theta).*sin(phi).*sin(psi)+(-1).* ...
    dtheta.*cos(psi).*sin(phi).*sin(theta)).*(dtheta.*cos(phi).*cos( ...
    psi).*cos(theta)+(-1).*dpsi.*cos(psi).*sin(phi)+(-1).*dphi.*cos( ...
    phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).* ...
    dpsi.*cos(phi).*sin(psi).*sin(theta))+(1/2).*L.^2.*((-1).*dphi.* ...
    cos(phi).*cos(psi).*cos(theta)+dpsi.*cos(theta).*sin(phi).*sin( ...
    psi)+dtheta.*cos(psi).*sin(phi).*sin(theta)).*(dtheta.*cos(phi).* ...
    cos(psi).*cos(theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi).*sin( ...
    psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos( ...
    phi).*sin(psi).*sin(theta))+(1/2).*L.^2.*((-1).*dphi.*cos(psi).* ...
    cos(theta).*sin(phi)+(-1).*dpsi.*cos(phi).*cos(theta).*sin(psi)+( ...
    -1).*dtheta.*cos(phi).*cos(psi).*sin(theta)).*(dpsi.*cos(phi).* ...
    cos(psi)+dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin( ...
    phi).*sin(psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.* ...
    sin(phi).*sin(psi).*sin(theta))+(1/2).*L.^2.*((-1).*dphi.*cos(psi) ...
    .*cos(theta).*sin(phi)+(-1).*dpsi.*cos(phi).*cos(theta).*sin(psi)+ ...
    (-1).*dtheta.*cos(phi).*cos(psi).*sin(theta)).*(dpsi.*cos(phi).* ...
    cos(psi)+(-1).*dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.* ...
    sin(phi).*sin(psi)+(-1).*dphi.*cos(phi).*cos(psi).*sin(theta)+ ...
    dpsi.*sin(phi).*sin(psi).*sin(theta)))+(a1.^2+b1.^2).*phi.*(( ...
    a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin( ...
    theta)).^2).^(-1/2).*((-6).*P1.*pi.*(phi+2.*N1.*pi).^(-2).*(L+b1.* ...
    cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).*((-1).*a1.*cos(theta)+ ...
    (-1).*b1.*sin(psi).*sin(theta))+ks1.*(L+b1.*cos(theta).*sin(psi)+( ...
    -1).*a1.*sin(theta)).*((-1).*a1.*cos(theta)+(-1).*b1.*sin(psi).* ...
    sin(theta)).*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+( ...
    -1).*a1.*sin(theta)).^2).^(-1/2))+(a2.^2+b2.^2).*phi.*((a2.^2+ ...
    b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)) ...
    .^2).^(-1/2).*((-6).*P2.*pi.*(phi+2.*N2.*pi).^(-2).*(L+b2.*cos( ...
    theta).*sin(psi)+(-1).*a2.*sin(theta)).*((-1).*a2.*cos(theta)+(-1) ...
    .*b2.*sin(psi).*sin(theta))+ks2.*(L+b2.*cos(theta).*sin(psi)+(-1) ...
    .*a2.*sin(theta)).*((-1).*a2.*cos(theta)+(-1).*b2.*sin(psi).*sin( ...
    theta)).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).* ...
    a2.*sin(theta)).^2).^(-1/2))+(a3.^2+b3.^2).*phi.*((a3.^2+b3.^2).* ...
    phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^( ...
    -1/2).*((-6).*P3.*pi.*(phi+2.*N3.*pi).^(-2).*(L+b3.*cos(theta).* ...
    sin(psi)+(-1).*a3.*sin(theta)).*((-1).*a3.*cos(theta)+(-1).*b3.* ...
    sin(psi).*sin(theta))+ks3.*(L+b3.*cos(theta).*sin(psi)+(-1).*a3.* ...
    sin(theta)).*((-1).*a3.*cos(theta)+(-1).*b3.*sin(psi).*sin(theta)) ...
    .*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.* ...
    sin(theta)).^2).^(-1/2))+(a4.^2+b4.^2).*phi.*((a4.^2+b4.^2).* ...
    phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^( ...
    -1/2).*((-6).*P4.*pi.*(phi+2.*N4.*pi).^(-2).*(L+b4.*cos(theta).* ...
    sin(psi)+(-1).*a4.*sin(theta)).*((-1).*a4.*cos(theta)+(-1).*b4.* ...
    sin(psi).*sin(theta))+ks4.*(L+b4.*cos(theta).*sin(psi)+(-1).*a4.* ...
    sin(theta)).*((-1).*a4.*cos(theta)+(-1).*b4.*sin(psi).*sin(theta)) ...
    .*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.* ...
    sin(theta)).^2).^(-1/2))+(-1).*(a1.^2+b1.^2).*phi.*(L+b1.*cos( ...
    theta).*sin(psi)+(-1).*a1.*sin(theta)).*((-1).*a1.*cos(theta)+(-1) ...
    .*b1.*sin(psi).*sin(theta)).*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos( ...
    theta).*sin(psi)+(-1).*a1.*sin(theta)).^2).^(-3/2).*(ks1.*((-1).* ...
    L+((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.* ...
    sin(theta)).^2).^(1/2))+P1.*pi.*(phi+2.*N1.*pi).^(-2).*(B1.^2+(-3) ...
    .*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.* ...
    sin(theta)).^2)))+(-1).*(a2.^2+b2.^2).*phi.*(L+b2.*cos(theta).* ...
    sin(psi)+(-1).*a2.*sin(theta)).*((-1).*a2.*cos(theta)+(-1).*b2.* ...
    sin(psi).*sin(theta)).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).* ...
    sin(psi)+(-1).*a2.*sin(theta)).^2).^(-3/2).*(ks2.*((-1).*L+(( ...
    a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin( ...
    theta)).^2).^(1/2))+P2.*pi.*(phi+2.*N2.*pi).^(-2).*(B2.^2+(-3).*(( ...
    a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin( ...
    theta)).^2)))+(-1).*(a3.^2+b3.^2).*phi.*(L+b3.*cos(theta).*sin( ...
    psi)+(-1).*a3.*sin(theta)).*((-1).*a3.*cos(theta)+(-1).*b3.*sin( ...
    psi).*sin(theta)).*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin( ...
    psi)+(-1).*a3.*sin(theta)).^2).^(-3/2).*(ks3.*((-1).*L+((a3.^2+ ...
    b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)) ...
    .^2).^(1/2))+P3.*pi.*(phi+2.*N3.*pi).^(-2).*(B3.^2+(-3).*((a3.^2+ ...
    b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)) ...
    .^2)))+(-1).*(a4.^2+b4.^2).*phi.*(L+b4.*cos(theta).*sin(psi)+(-1) ...
    .*a4.*sin(theta)).*((-1).*a4.*cos(theta)+(-1).*b4.*sin(psi).*sin( ...
    theta)).*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).* ...
    a4.*sin(theta)).^2).^(-3/2).*(ks4.*((-1).*L+((a4.^2+b4.^2).* ...
    phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^( ...
    1/2))+P4.*pi.*(phi+2.*N4.*pi).^(-2).*(B4.^2+(-3).*((a4.^2+b4.^2).* ...
    phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2))), ...
    kw1+kw2+kw3+kw4+(-1/2).*dphi.*dpsi.*L.^2.*m.*cos(phi).*cos(psi).*( ...
    (-1).*sin(phi).*sin(psi)+(-1).*cos(phi).*cos(psi).*sin(theta))+( ...
    1/2).*dphi.*dtheta.*L.^2.*m.*cos(psi).*cos(theta).*sin(phi).*((-1) ...
    .*sin(phi).*sin(psi)+(-1).*cos(phi).*cos(psi).*sin(theta))+(1/2).* ...
    dpsi.*dtheta.*L.^2.*m.*cos(phi).*cos(theta).*sin(psi).*((-1).*sin( ...
    phi).*sin(psi)+(-1).*cos(phi).*cos(psi).*sin(theta))+(1/4).* ...
    dphi.^2.*L.^2.*m.*sin(phi).*sin(psi).*((-1).*sin(phi).*sin(psi)+( ...
    -1).*cos(phi).*cos(psi).*sin(theta))+(1/4).*dpsi.^2.*L.^2.*m.*sin( ...
    phi).*sin(psi).*((-1).*sin(phi).*sin(psi)+(-1).*cos(phi).*cos(psi) ...
    .*sin(theta))+(1/4).*dphi.^2.*L.^2.*m.*cos(phi).*cos(psi).*sin( ...
    theta).*((-1).*sin(phi).*sin(psi)+(-1).*cos(phi).*cos(psi).*sin( ...
    theta))+(1/4).*dpsi.^2.*L.^2.*m.*cos(phi).*cos(psi).*sin(theta).*( ...
    (-1).*sin(phi).*sin(psi)+(-1).*cos(phi).*cos(psi).*sin(theta))+( ...
    1/4).*dtheta.^2.*L.^2.*m.*cos(phi).*cos(psi).*sin(theta).*((-1).* ...
    sin(phi).*sin(psi)+(-1).*cos(phi).*cos(psi).*sin(theta))+(-1/2).* ...
    dphi.*dpsi.*L.^2.*m.*sin(phi).*sin(psi).*sin(theta).*((-1).*sin( ...
    phi).*sin(psi)+(-1).*cos(phi).*cos(psi).*sin(theta))+(1/2).*dphi.* ...
    dpsi.*L.^2.*m.*cos(phi).*cos(psi).*((-1).*sin(phi).*sin(psi)+cos( ...
    phi).*cos(psi).*sin(theta))+(1/2).*dphi.*dtheta.*L.^2.*m.*cos(psi) ...
    .*cos(theta).*sin(phi).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos( ...
    psi).*sin(theta))+(1/2).*dpsi.*dtheta.*L.^2.*m.*cos(phi).*cos( ...
    theta).*sin(psi).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).* ...
    sin(theta))+(-1/4).*dphi.^2.*L.^2.*m.*sin(phi).*sin(psi).*((-1).* ...
    sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+(-1/4).* ...
    dpsi.^2.*L.^2.*m.*sin(phi).*sin(psi).*((-1).*sin(phi).*sin(psi)+ ...
    cos(phi).*cos(psi).*sin(theta))+(1/4).*dphi.^2.*L.^2.*m.*cos(phi) ...
    .*cos(psi).*sin(theta).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos( ...
    psi).*sin(theta))+(1/4).*dpsi.^2.*L.^2.*m.*cos(phi).*cos(psi).* ...
    sin(theta).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin( ...
    theta))+(1/4).*dtheta.^2.*L.^2.*m.*cos(phi).*cos(psi).*sin(theta) ...
    .*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+(-1/2) ...
    .*dphi.*dpsi.*L.^2.*m.*sin(phi).*sin(psi).*sin(theta).*((-1).*sin( ...
    phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+(-1/2).*dphi.* ...
    dtheta.*L.^2.*m.*cos(phi).*cos(psi).*cos(theta).*((-1).*cos(phi).* ...
    sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(1/2).*dphi.*dpsi.* ...
    L.^2.*m.*cos(psi).*sin(phi).*((-1).*cos(phi).*sin(psi)+(-1).*cos( ...
    psi).*sin(phi).*sin(theta))+(1/4).*dphi.^2.*L.^2.*m.*cos(phi).* ...
    sin(psi).*((-1).*cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).*sin( ...
    theta))+(1/4).*dpsi.^2.*L.^2.*m.*cos(phi).*sin(psi).*((-1).*cos( ...
    phi).*sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(1/2).*dpsi.* ...
    dtheta.*L.^2.*m.*cos(theta).*sin(phi).*sin(psi).*((-1).*cos(phi).* ...
    sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(1/4).*dphi.^2.* ...
    L.^2.*m.*cos(psi).*sin(phi).*sin(theta).*((-1).*cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(1/4).*dpsi.^2.*L.^2.*m.* ...
    cos(psi).*sin(phi).*sin(theta).*((-1).*cos(phi).*sin(psi)+(-1).* ...
    cos(psi).*sin(phi).*sin(theta))+(1/4).*dtheta.^2.*L.^2.*m.*cos( ...
    psi).*sin(phi).*sin(theta).*((-1).*cos(phi).*sin(psi)+(-1).*cos( ...
    psi).*sin(phi).*sin(theta))+(1/2).*dphi.*dpsi.*L.^2.*m.*cos(phi).* ...
    sin(psi).*sin(theta).*((-1).*cos(phi).*sin(psi)+(-1).*cos(psi).* ...
    sin(phi).*sin(theta))+(1/2).*dphi.*dtheta.*L.^2.*m.*cos(phi).*cos( ...
    psi).*cos(theta).*(cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).* ...
    sin(theta))+(1/2).*dphi.*dpsi.*L.^2.*m.*cos(psi).*sin(phi).*(cos( ...
    phi).*sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(1/4).* ...
    dphi.^2.*L.^2.*m.*cos(phi).*sin(psi).*(cos(phi).*sin(psi)+(-1).* ...
    cos(psi).*sin(phi).*sin(theta))+(1/4).*dpsi.^2.*L.^2.*m.*cos(phi) ...
    .*sin(psi).*(cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).*sin( ...
    theta))+(-1/2).*dpsi.*dtheta.*L.^2.*m.*cos(theta).*sin(phi).*sin( ...
    psi).*(cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+( ...
    -1/4).*dphi.^2.*L.^2.*m.*cos(psi).*sin(phi).*sin(theta).*(cos(phi) ...
    .*sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(-1/4).*dpsi.^2.* ...
    L.^2.*m.*cos(psi).*sin(phi).*sin(theta).*(cos(phi).*sin(psi)+(-1) ...
    .*cos(psi).*sin(phi).*sin(theta))+(-1/4).*dtheta.^2.*L.^2.*m.*cos( ...
    psi).*sin(phi).*sin(theta).*(cos(phi).*sin(psi)+(-1).*cos(psi).* ...
    sin(phi).*sin(theta))+(-1/2).*dphi.*dpsi.*L.^2.*m.*cos(phi).*sin( ...
    psi).*sin(theta).*(cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).* ...
    sin(theta))+(-1/4).*L.^2.*m.*(dtheta.*cos(phi).*cos(psi).*cos( ...
    theta)+(-1).*dpsi.*cos(psi).*sin(phi)+(-1).*dphi.*cos(phi).*sin( ...
    psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos( ...
    phi).*sin(psi).*sin(theta)).^2+(-1/4).*L.^2.*m.*(dtheta.*cos(phi) ...
    .*cos(psi).*cos(theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi).* ...
    sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.* ...
    cos(phi).*sin(psi).*sin(theta)).*((-1).*dtheta.*cos(phi).*cos(psi) ...
    .*cos(theta)+(-1).*dpsi.*cos(psi).*sin(phi)+(-1).*dphi.*cos(phi).* ...
    sin(psi)+dphi.*cos(psi).*sin(phi).*sin(theta)+dpsi.*cos(phi).*sin( ...
    psi).*sin(theta))+(-1/4).*L.^2.*m.*(dpsi.*cos(phi).*cos(psi)+(-1) ...
    .*dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).* ...
    sin(psi)+(-1).*dphi.*cos(phi).*cos(psi).*sin(theta)+dpsi.*sin(phi) ...
    .*sin(psi).*sin(theta)).^2+(-1/4).*L.^2.*m.*(dpsi.*cos(phi).*cos( ...
    psi)+dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).* ...
    sin(psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi) ...
    .*sin(psi).*sin(theta)).*((-1).*dpsi.*cos(phi).*cos(psi)+(-1).* ...
    dtheta.*cos(psi).*cos(theta).*sin(phi)+dphi.*sin(phi).*sin(psi)+( ...
    -1).*dphi.*cos(phi).*cos(psi).*sin(theta)+dpsi.*sin(phi).*sin(psi) ...
    .*sin(theta))+4.*(a1.^2+b1.^2).*P1.*phi.*pi.*(phi+2.*N1.*pi).^(-3) ...
    .*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.* ...
    sin(theta)).^2).^(1/2)+2.*(a1.^2+b1.^2).*P1.*phi.*pi.*(phi+2.*N1.* ...
    pi).^(-3).*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1) ...
    .*a1.*sin(theta)).^2).^(-1/2).*((-1).*B1.^2+(a1.^2+b1.^2).*phi.^2+ ...
    (L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2)+(-6).*P1.* ...
    pi.*(phi+2.*N1.*pi).^(-4).*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos( ...
    theta).*sin(psi)+(-1).*a1.*sin(theta)).^2).^(1/2).*((-1).*B1.^2+( ...
    a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin( ...
    theta)).^2)+4.*(a2.^2+b2.^2).*P2.*phi.*pi.*(phi+2.*N2.*pi).^(-3).* ...
    ((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin( ...
    theta)).^2).^(1/2)+2.*(a2.^2+b2.^2).*P2.*phi.*pi.*(phi+2.*N2.*pi) ...
    .^(-3).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).* ...
    a2.*sin(theta)).^2).^(-1/2).*((-1).*B2.^2+(a2.^2+b2.^2).*phi.^2+( ...
    L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).^2)+(-6).*P2.* ...
    pi.*(phi+2.*N2.*pi).^(-4).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos( ...
    theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^(1/2).*((-1).*B2.^2+( ...
    a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin( ...
    theta)).^2)+4.*(a3.^2+b3.^2).*P3.*phi.*pi.*(phi+2.*N3.*pi).^(-3).* ...
    ((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin( ...
    theta)).^2).^(1/2)+2.*(a3.^2+b3.^2).*P3.*phi.*pi.*(phi+2.*N3.*pi) ...
    .^(-3).*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).* ...
    a3.*sin(theta)).^2).^(-1/2).*((-1).*B3.^2+(a3.^2+b3.^2).*phi.^2+( ...
    L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2)+(-6).*P3.* ...
    pi.*(phi+2.*N3.*pi).^(-4).*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos( ...
    theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^(1/2).*((-1).*B3.^2+( ...
    a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin( ...
    theta)).^2)+4.*(a4.^2+b4.^2).*P4.*phi.*pi.*(phi+2.*N4.*pi).^(-3).* ...
    ((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin( ...
    theta)).^2).^(1/2)+2.*(a4.^2+b4.^2).*P4.*phi.*pi.*(phi+2.*N4.*pi) ...
    .^(-3).*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).* ...
    a4.*sin(theta)).^2).^(-1/2).*((-1).*B4.^2+(a4.^2+b4.^2).*phi.^2+( ...
    L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2)+(-6).*P4.* ...
    pi.*(phi+2.*N4.*pi).^(-4).*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos( ...
    theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^(1/2).*((-1).*B4.^2+( ...
    a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin( ...
    theta)).^2)+(-1).*ddtheta.*((1/4).*L.^2.*m.*cos(phi).*cos(psi).* ...
    cos(theta).*((-1).*sin(phi).*sin(psi)+(-1).*cos(phi).*cos(psi).* ...
    sin(theta))+(1/4).*L.^2.*m.*cos(phi).*cos(psi).*cos(theta).*((-1) ...
    .*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+(1/4).*L.^2.* ...
    m.*cos(psi).*cos(theta).*sin(phi).*((-1).*cos(phi).*sin(psi)+(-1) ...
    .*cos(psi).*sin(phi).*sin(theta))+(-1/4).*L.^2.*m.*cos(psi).*cos( ...
    theta).*sin(phi).*(cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).* ...
    sin(theta)))+(-1).*ddphi.*((1/4).*L.^2.*m.*cos(phi).*sin(psi).*(( ...
    -1).*sin(phi).*sin(psi)+(-1).*cos(phi).*cos(psi).*sin(theta))+( ...
    -1/4).*L.^2.*m.*cos(psi).*sin(phi).*sin(theta).*((-1).*sin(phi).* ...
    sin(psi)+(-1).*cos(phi).*cos(psi).*sin(theta))+(-1/4).*L.^2.*m.* ...
    cos(phi).*sin(psi).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).* ...
    sin(theta))+(-1/4).*L.^2.*m.*cos(psi).*sin(phi).*sin(theta).*((-1) ...
    .*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+(-1/4).* ...
    L.^2.*m.*sin(phi).*sin(psi).*((-1).*cos(phi).*sin(psi)+(-1).*cos( ...
    psi).*sin(phi).*sin(theta))+(1/4).*L.^2.*m.*cos(phi).*cos(psi).* ...
    sin(theta).*((-1).*cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).* ...
    sin(theta))+(-1/4).*L.^2.*m.*sin(phi).*sin(psi).*(cos(phi).*sin( ...
    psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(-1/4).*L.^2.*m.*cos( ...
    phi).*cos(psi).*sin(theta).*(cos(phi).*sin(psi)+(-1).*cos(psi).* ...
    sin(phi).*sin(theta)))+(-1).*ddpsi.*((1/4).*L.^2.*m.*cos(psi).* ...
    sin(phi).*((-1).*sin(phi).*sin(psi)+(-1).*cos(phi).*cos(psi).*sin( ...
    theta))+(-1/4).*L.^2.*m.*cos(phi).*sin(psi).*sin(theta).*((-1).* ...
    sin(phi).*sin(psi)+(-1).*cos(phi).*cos(psi).*sin(theta))+(-1/4).* ...
    L.^2.*m.*cos(psi).*sin(phi).*((-1).*sin(phi).*sin(psi)+cos(phi).* ...
    cos(psi).*sin(theta))+(-1/4).*L.^2.*m.*cos(phi).*sin(psi).*sin( ...
    theta).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+ ...
    (1/4).*L.^2.*m.*cos(phi).*cos(psi).*((-1).*cos(phi).*sin(psi)+(-1) ...
    .*cos(psi).*sin(phi).*sin(theta))+(-1/4).*L.^2.*m.*sin(phi).*sin( ...
    psi).*sin(theta).*((-1).*cos(phi).*sin(psi)+(-1).*cos(psi).*sin( ...
    phi).*sin(theta))+(1/4).*L.^2.*m.*cos(phi).*cos(psi).*(cos(phi).* ...
    sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(1/4).*L.^2.*m.* ...
    sin(phi).*sin(psi).*sin(theta).*(cos(phi).*sin(psi)+(-1).*cos(psi) ...
    .*sin(phi).*sin(theta)))+(1/2).*m.*((1/2).*L.^2.*(dtheta.*cos(phi) ...
    .*cos(psi).*cos(theta)+(-1).*dpsi.*cos(psi).*sin(phi)+(-1).*dphi.* ...
    cos(phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1) ...
    .*dpsi.*cos(phi).*sin(psi).*sin(theta)).^2+(1/2).*L.^2.*(dtheta.* ...
    cos(phi).*cos(psi).*cos(theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos( ...
    phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).* ...
    dpsi.*cos(phi).*sin(psi).*sin(theta)).*((-1).*dtheta.*cos(phi).* ...
    cos(psi).*cos(theta)+(-1).*dpsi.*cos(psi).*sin(phi)+(-1).*dphi.* ...
    cos(phi).*sin(psi)+dphi.*cos(psi).*sin(phi).*sin(theta)+dpsi.*cos( ...
    phi).*sin(psi).*sin(theta))+(1/2).*L.^2.*(dpsi.*cos(phi).*cos(psi)+(-1).*dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi) ...
    .*sin(psi)+(-1).*dphi.*cos(phi).*cos(psi).*sin(theta)+dpsi.*sin( ...
    phi).*sin(psi).*sin(theta)).^2+(1/2).*L.^2.*(dpsi.*cos(phi).*cos( ...
    psi)+dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).* ...
    sin(psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi) ...
    .*sin(psi).*sin(theta)).*((-1).*dpsi.*cos(phi).*cos(psi)+(-1).* ...
    dtheta.*cos(psi).*cos(theta).*sin(phi)+dphi.*sin(phi).*sin(psi)+( ...
    -1).*dphi.*cos(phi).*cos(psi).*sin(theta)+dpsi.*sin(phi).*sin(psi) ...
    .*sin(theta)))+(a1.^2+b1.^2).*phi.*((a1.^2+b1.^2).*phi.^2+(L+b1.* ...
    cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2).^(-1/2).*((-6).*( ...
    a1.^2+b1.^2).*P1.*phi.*pi.*(phi+2.*N1.*pi).^(-2)+(a1.^2+b1.^2).* ...
    ks1.*phi.*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1) ...
    .*a1.*sin(theta)).^2).^(-1/2)+(-2).*P1.*pi.*(phi+2.*N1.*pi).^(-3) ...
    .*(B1.^2+(-3).*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+ ...
    (-1).*a1.*sin(theta)).^2)))+(-1).*(a1.^2+b1.^2).^2.*phi.^2.*(( ...
    a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin( ...
    theta)).^2).^(-3/2).*(ks1.*((-1).*L+((a1.^2+b1.^2).*phi.^2+(L+b1.* ...
    cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2).^(1/2))+P1.*pi.*( ...
    phi+2.*N1.*pi).^(-2).*(B1.^2+(-3).*((a1.^2+b1.^2).*phi.^2+(L+b1.* ...
    cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2)))+(a1.^2+b1.^2).*(( ...
    a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin( ...
    theta)).^2).^(-1/2).*(ks1.*((-1).*L+((a1.^2+b1.^2).*phi.^2+(L+b1.* ...
    cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2).^(1/2))+P1.*pi.*( ...
    phi+2.*N1.*pi).^(-2).*(B1.^2+(-3).*((a1.^2+b1.^2).*phi.^2+(L+b1.* ...
    cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2)))+(a2.^2+b2.^2).* ...
    phi.*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.* ...
    sin(theta)).^2).^(-1/2).*((-6).*(a2.^2+b2.^2).*P2.*phi.*pi.*(phi+ ...
    2.*N2.*pi).^(-2)+(a2.^2+b2.^2).*ks2.*phi.*((a2.^2+b2.^2).*phi.^2+( ...
    L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^(-1/2)+(-2) ...
    .*P2.*pi.*(phi+2.*N2.*pi).^(-3).*(B2.^2+(-3).*((a2.^2+b2.^2).* ...
    phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).^2)))+( ...
    -1).*(a2.^2+b2.^2).^2.*phi.^2.*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos( ...
    theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^(-3/2).*(ks2.*((-1).* ...
    L+((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.* ...
    sin(theta)).^2).^(1/2))+P2.*pi.*(phi+2.*N2.*pi).^(-2).*(B2.^2+(-3) ...
    .*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).*a2.* ...
    sin(theta)).^2)))+(a2.^2+b2.^2).*((a2.^2+b2.^2).*phi.^2+(L+b2.* ...
    cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^(-1/2).*(ks2.*(( ...
    -1).*L+((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).* ...
    a2.*sin(theta)).^2).^(1/2))+P2.*pi.*(phi+2.*N2.*pi).^(-2).*(B2.^2+ ...
    (-3).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(psi)+(-1).* ...
    a2.*sin(theta)).^2)))+(a3.^2+b3.^2).*phi.*((a3.^2+b3.^2).*phi.^2+( ...
    L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^(-1/2).*(( ...
    -6).*(a3.^2+b3.^2).*P3.*phi.*pi.*(phi+2.*N3.*pi).^(-2)+(a3.^2+ ...
    b3.^2).*ks3.*phi.*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin( ...
    psi)+(-1).*a3.*sin(theta)).^2).^(-1/2)+(-2).*P3.*pi.*(phi+2.*N3.* ...
    pi).^(-3).*(B3.^2+(-3).*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).* ...
    sin(psi)+(-1).*a3.*sin(theta)).^2)))+(-1).*(a3.^2+b3.^2).^2.* ...
    phi.^2.*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).* ...
    a3.*sin(theta)).^2).^(-3/2).*(ks3.*((-1).*L+((a3.^2+b3.^2).* ...
    phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^( ...
    1/2))+P3.*pi.*(phi+2.*N3.*pi).^(-2).*(B3.^2+(-3).*((a3.^2+b3.^2).* ...
    phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2)))+( ...
    a3.^2+b3.^2).*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(psi)+( ...
    -1).*a3.*sin(theta)).^2).^(-1/2).*(ks3.*((-1).*L+((a3.^2+b3.^2).* ...
    phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^( ...
    1/2))+P3.*pi.*(phi+2.*N3.*pi).^(-2).*(B3.^2+(-3).*((a3.^2+b3.^2).* ...
    phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2)))+( ...
    a4.^2+b4.^2).*phi.*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin( ...
    psi)+(-1).*a4.*sin(theta)).^2).^(-1/2).*((-6).*(a4.^2+b4.^2).*P4.* ...
    phi.*pi.*(phi+2.*N4.*pi).^(-2)+(a4.^2+b4.^2).*ks4.*phi.*((a4.^2+ ...
    b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)) ...
    .^2).^(-1/2)+(-2).*P4.*pi.*(phi+2.*N4.*pi).^(-3).*(B4.^2+(-3).*(( ...
    a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin( ...
    theta)).^2)))+(-1).*(a4.^2+b4.^2).^2.*phi.^2.*((a4.^2+b4.^2).* ...
    phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^( ...
    -3/2).*(ks4.*((-1).*L+((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).* ...
    sin(psi)+(-1).*a4.*sin(theta)).^2).^(1/2))+P4.*pi.*(phi+2.*N4.*pi) ...
    .^(-2).*(B4.^2+(-3).*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).* ...
    sin(psi)+(-1).*a4.*sin(theta)).^2)))+(a4.^2+b4.^2).*((a4.^2+b4.^2) ...
    .*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).^2).^( ...
    -1/2).*(ks4.*((-1).*L+((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).* ...
    sin(psi)+(-1).*a4.*sin(theta)).^2).^(1/2))+P4.*pi.*(phi+2.*N4.*pi) ...
    .^(-2).*(B4.^2+(-3).*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).* ...
    sin(psi)+(-1).*a4.*sin(theta)).^2))),(1/2).*dphi.*L.^2.*m.*cos( ...
    psi).*sin(phi).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin( ...
    theta))+(1/2).*dpsi.*L.^2.*m.*cos(phi).*sin(psi).*((-1).*sin(phi) ...
    .*sin(psi)+cos(phi).*cos(psi).*sin(theta))+(1/2).*dtheta.*L.^2.* ...
    m.*cos(theta).*sin(phi).*sin(psi).*((-1).*sin(phi).*sin(psi)+cos( ...
    phi).*cos(psi).*sin(theta))+(1/2).*dpsi.*L.^2.*m.*cos(psi).*sin( ...
    phi).*sin(theta).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).* ...
    sin(theta))+(1/2).*dphi.*L.^2.*m.*cos(phi).*sin(psi).*sin(theta).* ...
    ((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+(-1/2).* ...
    dphi.*L.^2.*m.*cos(phi).*cos(psi).*(cos(phi).*sin(psi)+(-1).*cos( ...
    psi).*sin(phi).*sin(theta))+(1/2).*dtheta.*L.^2.*m.*cos(phi).*cos( ...
    theta).*sin(psi).*(cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).* ...
    sin(theta))+(1/2).*dpsi.*L.^2.*m.*sin(phi).*sin(psi).*(cos(phi).* ...
    sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(1/2).*dpsi.*L.^2.* ...
    m.*cos(phi).*cos(psi).*sin(theta).*(cos(phi).*sin(psi)+(-1).*cos( ...
    psi).*sin(phi).*sin(theta))+(-1/2).*dphi.*L.^2.*m.*sin(phi).*sin( ...
    psi).*sin(theta).*(cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).* ...
    sin(theta))+(-1/4).*L.^2.*m.*(dtheta.*cos(phi).*cos(psi).*cos( ...
    theta)+(-1).*dpsi.*cos(psi).*sin(phi)+(-1).*dphi.*cos(phi).*sin( ...
    psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos( ...
    phi).*sin(psi).*sin(theta)).*(cos(phi).*cos(psi)+(-1).*sin(phi).* ...
    sin(psi).*sin(theta))+(-1/4).*L.^2.*m.*(dtheta.*cos(phi).*cos(psi) ...
    .*cos(theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi).*sin(psi)+( ...
    -1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos(phi).* ...
    sin(psi).*sin(theta)).*(cos(phi).*cos(psi)+sin(phi).*sin(psi).* ...
    sin(theta))+(-1/4).*L.^2.*m.*((-1).*cos(psi).*sin(phi)+(-1).*cos( ...
    phi).*sin(psi).*sin(theta)).*(dpsi.*cos(phi).*cos(psi)+dtheta.* ...
    cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin(psi)+ ...
    dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).*sin( ...
    psi).*sin(theta))+(-1/4).*L.^2.*m.*(cos(psi).*sin(phi)+(-1).*cos( ...
    phi).*sin(psi).*sin(theta)).*(dpsi.*cos(phi).*cos(psi)+(-1).* ...
    dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin( ...
    psi)+(-1).*dphi.*cos(phi).*cos(psi).*sin(theta)+dpsi.*sin(phi).* ...
    sin(psi).*sin(theta))+(1/2).*m.*((1/2).*L.^2.*(dtheta.*cos(phi).* ...
    cos(psi).*cos(theta)+(-1).*dpsi.*cos(psi).*sin(phi)+(-1).*dphi.* ...
    cos(phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1) ...
    .*dpsi.*cos(phi).*sin(psi).*sin(theta)).*(cos(phi).*cos(psi)+(-1) ...
    .*sin(phi).*sin(psi).*sin(theta))+(1/2).*L.^2.*(dtheta.*cos(phi).* ...
    cos(psi).*cos(theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi).*sin( ...
    psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos( ...
    phi).*sin(psi).*sin(theta)).*(cos(phi).*cos(psi)+sin(phi).*sin( ...
    psi).*sin(theta))+(1/2).*L.^2.*((-1).*cos(psi).*sin(phi)+(-1).* ...
    cos(phi).*sin(psi).*sin(theta)).*(dpsi.*cos(phi).*cos(psi)+ ...
    dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin( ...
    psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).* ...
    sin(psi).*sin(theta))+(1/2).*L.^2.*(cos(psi).*sin(phi)+(-1).*cos( ...
    phi).*sin(psi).*sin(theta)).*(dpsi.*cos(phi).*cos(psi)+(-1).* ...
    dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin( ...
    psi)+(-1).*dphi.*cos(phi).*cos(psi).*sin(theta)+dpsi.*sin(phi).* ...
    sin(psi).*sin(theta))),(-1/2).*dphi.*L.^2.*m.*cos(phi).*cos(psi).* ...
    cos(theta).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin( ...
    theta))+(1/2).*dpsi.*L.^2.*m.*cos(theta).*sin(phi).*sin(psi).*(( ...
    -1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+(1/2).* ...
    dtheta.*L.^2.*m.*cos(psi).*sin(phi).*sin(theta).*((-1).*sin(phi).* ...
    sin(psi)+cos(phi).*cos(psi).*sin(theta))+(1/2).*dphi.*L.^2.*m.* ...
    cos(psi).*cos(theta).*sin(phi).*(cos(phi).*sin(psi)+(-1).*cos(psi) ...
    .*sin(phi).*sin(theta))+(1/2).*dpsi.*L.^2.*m.*cos(phi).*cos(theta) ...
    .*sin(psi).*(cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).*sin( ...
    theta))+(1/2).*dtheta.*L.^2.*m.*cos(phi).*cos(psi).*sin(theta).*( ...
    cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(-1/4).* ...
    L.^2.*m.*cos(psi).*cos(theta).*sin(phi).*(dtheta.*cos(phi).*cos( ...
    psi).*cos(theta)+(-1).*dpsi.*cos(psi).*sin(phi)+(-1).*dphi.*cos( ...
    phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).* ...
    dpsi.*cos(phi).*sin(psi).*sin(theta))+(1/4).*L.^2.*m.*cos(psi).* ...
    cos(theta).*sin(phi).*(dtheta.*cos(phi).*cos(psi).*cos(theta)+ ...
    dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos( ...
    psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin( ...
    theta))+(-1/4).*L.^2.*m.*cos(phi).*cos(psi).*cos(theta).*(dpsi.* ...
    cos(phi).*cos(psi)+dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).* ...
    dphi.*sin(phi).*sin(psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1) ...
    .*dpsi.*sin(phi).*sin(psi).*sin(theta))+(-1/4).*L.^2.*m.*cos(phi) ...
    .*cos(psi).*cos(theta).*(dpsi.*cos(phi).*cos(psi)+(-1).*dtheta.* ...
    cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin(psi)+(-1) ...
    .*dphi.*cos(phi).*cos(psi).*sin(theta)+dpsi.*sin(phi).*sin(psi).* ...
    sin(theta))+(1/2).*m.*((1/2).*L.^2.*cos(psi).*cos(theta).*sin(phi) ...
    .*(dtheta.*cos(phi).*cos(psi).*cos(theta)+(-1).*dpsi.*cos(psi).* ...
    sin(phi)+(-1).*dphi.*cos(phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin( ...
    phi).*sin(theta)+(-1).*dpsi.*cos(phi).*sin(psi).*sin(theta))+( ...
    -1/2).*L.^2.*cos(psi).*cos(theta).*sin(phi).*(dtheta.*cos(phi).* ...
    cos(psi).*cos(theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi).*sin( ...
    psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos( ...
    phi).*sin(psi).*sin(theta))+(1/2).*L.^2.*cos(phi).*cos(psi).*cos( ...
    theta).*(dpsi.*cos(phi).*cos(psi)+dtheta.*cos(psi).*cos(theta).* ...
    sin(phi)+(-1).*dphi.*sin(phi).*sin(psi)+dphi.*cos(phi).*cos(psi).* ...
    sin(theta)+(-1).*dpsi.*sin(phi).*sin(psi).*sin(theta))+(1/2).* ...
    L.^2.*cos(phi).*cos(psi).*cos(theta).*(dpsi.*cos(phi).*cos(psi)+( ...
    -1).*dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).* ...
    sin(psi)+(-1).*dphi.*cos(phi).*cos(psi).*sin(theta)+dpsi.*sin(phi) ...
    .*sin(psi).*sin(theta))),(-1).*dampphi+(-1/2).*dtheta.*L.^2.*m.* ...
    cos(phi).*cos(psi).*cos(theta).*((-1).*sin(phi).*sin(psi)+cos(phi) ...
    .*cos(psi).*sin(theta))+(1/2).*dpsi.*L.^2.*m.*cos(psi).*sin(phi).* ...
    ((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+(1/2).* ...
    dphi.*L.^2.*m.*cos(phi).*sin(psi).*((-1).*sin(phi).*sin(psi)+cos( ...
    phi).*cos(psi).*sin(theta))+(1/2).*dphi.*L.^2.*m.*cos(psi).*sin( ...
    phi).*sin(theta).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).* ...
    sin(theta))+(1/2).*dpsi.*L.^2.*m.*cos(phi).*sin(psi).*sin(theta).* ...
    ((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta))+(-1/2).* ...
    dpsi.*L.^2.*m.*cos(phi).*cos(psi).*(cos(phi).*sin(psi)+(-1).*cos( ...
    psi).*sin(phi).*sin(theta))+(1/2).*dtheta.*L.^2.*m.*cos(psi).*cos( ...
    theta).*sin(phi).*(cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).* ...
    sin(theta))+(1/2).*dphi.*L.^2.*m.*sin(phi).*sin(psi).*(cos(phi).* ...
    sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(1/2).*dphi.*L.^2.* ...
    m.*cos(phi).*cos(psi).*sin(theta).*(cos(phi).*sin(psi)+(-1).*cos( ...
    psi).*sin(phi).*sin(theta))+(-1/2).*dpsi.*L.^2.*m.*sin(phi).*sin( ...
    psi).*sin(theta).*(cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).* ...
    sin(theta))+(-1/4).*L.^2.*m.*((-1).*sin(phi).*sin(psi)+cos(phi).* ...
    cos(psi).*sin(theta)).*(dtheta.*cos(phi).*cos(psi).*cos(theta)+( ...
    -1).*dpsi.*cos(psi).*sin(phi)+(-1).*dphi.*cos(phi).*sin(psi)+(-1) ...
    .*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos(phi).*sin( ...
    psi).*sin(theta))+(-1/4).*L.^2.*m.*((-1).*sin(phi).*sin(psi)+(-1) ...
    .*cos(phi).*cos(psi).*sin(theta)).*(dtheta.*cos(phi).*cos(psi).* ...
    cos(theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi).*sin(psi)+(-1) ...
    .*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.*cos(phi).*sin( ...
    psi).*sin(theta))+(-1/4).*L.^2.*m.*((-1).*cos(phi).*sin(psi)+(-1) ...
    .*cos(psi).*sin(phi).*sin(theta)).*(dpsi.*cos(phi).*cos(psi)+ ...
    dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin( ...
    psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi).* ...
    sin(psi).*sin(theta))+(-1/4).*L.^2.*m.*(cos(phi).*sin(psi)+(-1).* ...
    cos(psi).*sin(phi).*sin(theta)).*(dpsi.*cos(phi).*cos(psi)+(-1).* ...
    dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin( ...
    psi)+(-1).*dphi.*cos(phi).*cos(psi).*sin(theta)+dpsi.*sin(phi).* ...
    sin(psi).*sin(theta))+(1/2).*m.*((1/2).*L.^2.*((-1).*sin(phi).* ...
    sin(psi)+cos(phi).*cos(psi).*sin(theta)).*(dtheta.*cos(phi).*cos( ...
    psi).*cos(theta)+(-1).*dpsi.*cos(psi).*sin(phi)+(-1).*dphi.*cos( ...
    phi).*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).* ...
    dpsi.*cos(phi).*sin(psi).*sin(theta))+(1/2).*L.^2.*((-1).*sin(phi) ...
    .*sin(psi)+(-1).*cos(phi).*cos(psi).*sin(theta)).*(dtheta.*cos( ...
    phi).*cos(psi).*cos(theta)+dpsi.*cos(psi).*sin(phi)+dphi.*cos(phi) ...
    .*sin(psi)+(-1).*dphi.*cos(psi).*sin(phi).*sin(theta)+(-1).*dpsi.* ...
    cos(phi).*sin(psi).*sin(theta))+(1/2).*L.^2.*((-1).*cos(phi).*sin( ...
    psi)+(-1).*cos(psi).*sin(phi).*sin(theta)).*(dpsi.*cos(phi).*cos( ...
    psi)+dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).* ...
    sin(psi)+dphi.*cos(phi).*cos(psi).*sin(theta)+(-1).*dpsi.*sin(phi) ...
    .*sin(psi).*sin(theta))+(1/2).*L.^2.*(cos(phi).*sin(psi)+(-1).* ...
    cos(psi).*sin(phi).*sin(theta)).*(dpsi.*cos(phi).*cos(psi)+(-1).* ...
    dtheta.*cos(psi).*cos(theta).*sin(phi)+(-1).*dphi.*sin(phi).*sin( ...
    psi)+(-1).*dphi.*cos(phi).*cos(psi).*sin(theta)+dpsi.*sin(phi).* ...
    sin(psi).*sin(theta)))];

%% dfdxdot
dfdxdot = [...
    1, 0, 0, 0, 0, 0;...
    0, 1, 0, 0, 0, 0;...
    0, 0, 1, 0, 0, 0;...
    0,0,0,(-1).*Ipsi+(-1/4).*L.^2.*m.*cos(theta).^2.*sin(psi).^2+( ...
    -1/4).*L.^2.*m.*cos(psi).*sin(phi).*(cos(psi).*sin(phi)+(-1).*cos( ...
    phi).*sin(psi).*sin(theta))+(1/4).*L.^2.*m.*cos(phi).*sin(psi).* ...
    sin(theta).*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin( ...
    theta))+(-1/4).*L.^2.*m.*cos(phi).*cos(psi).*(cos(phi).*cos(psi)+( ...
    -1).*sin(phi).*sin(psi).*sin(theta))+(1/4).*L.^2.*m.*sin(phi).* ...
    sin(psi).*sin(theta).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi) ...
    .*sin(theta)),(-1/4).*L.^2.*m.*cos(psi).*cos(theta).*sin(psi).* ...
    sin(theta)+(-1/4).*L.^2.*m.*cos(phi).*cos(psi).*cos(theta).*(cos( ...
    psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(-1/4).* ...
    L.^2.*m.*cos(psi).*cos(theta).*sin(phi).*(cos(phi).*cos(psi)+(-1) ...
    .*sin(phi).*sin(psi).*sin(theta)),(-1/4).*L.^2.*m.*cos(phi).*sin( ...
    psi).*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+( ...
    1/4).*L.^2.*m.*cos(psi).*sin(phi).*sin(theta).*(cos(psi).*sin(phi)+(-1).*cos(phi).*sin(psi).*sin(theta))+(1/4).*L.^2.*m.*sin(phi).* ...
    sin(psi).*(cos(phi).*cos(psi)+(-1).*sin(phi).*sin(psi).*sin(theta) ...
    )+(-1/4).*L.^2.*m.*cos(phi).*cos(psi).*sin(theta).*(cos(phi).*cos( ...
    psi)+(-1).*sin(phi).*sin(psi).*sin(theta));0,0,0,(-1/2).*L.^2.*m.* ...
    cos(phi).*cos(psi).^2.*cos(theta).*sin(phi)+(-1/4).*L.^2.*m.*cos( ...
    psi).*cos(theta).*sin(psi).*sin(theta)+(1/4).*L.^2.*m.*cos(phi) ...
    .^2.*cos(psi).*cos(theta).*sin(psi).*sin(theta)+(1/4).*L.^2.*m.* ...
    cos(psi).*cos(theta).*sin(phi).^2.*sin(psi).*sin(theta),(-1).* ...
    Itheta+(-1/4).*L.^2.*m.*cos(phi).^2.*cos(psi).^2.*cos(theta).^2+( ...
    -1/4).*L.^2.*m.*cos(psi).^2.*cos(theta).^2.*sin(phi).^2+(-1/4).* ...
    L.^2.*m.*cos(psi).^2.*sin(theta).^2,(-1/4).*L.^2.*m.*cos(phi).^2.* ...
    cos(psi).*cos(theta).*sin(psi)+(1/4).*L.^2.*m.*cos(psi).*cos( ...
    theta).*sin(phi).^2.*sin(psi);0,0,0,(-1/4).*L.^2.*m.*cos(phi).* ...
    cos(psi).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos(psi).*sin(theta) ...
    )+(1/4).*L.^2.*m.*sin(phi).*sin(psi).*sin(theta).*((-1).*sin(phi) ...
    .*sin(psi)+cos(phi).*cos(psi).*sin(theta))+(-1/4).*L.^2.*m.*cos( ...
    psi).*sin(phi).*(cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).*sin( ...
    theta))+(1/4).*L.^2.*m.*cos(phi).*sin(psi).*sin(theta).*(cos(phi) ...
    .*sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta)),(-1/4).*L.^2.*m.* ...
    cos(psi).*cos(theta).*sin(phi).*((-1).*sin(phi).*sin(psi)+cos(phi) ...
    .*cos(psi).*sin(theta))+(-1/4).*L.^2.*m.*cos(phi).*cos(psi).*cos( ...
    theta).*(cos(phi).*sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta)), ...
    (-1).*Iphi+(1/4).*L.^2.*m.*sin(phi).*sin(psi).*((-1).*sin(phi).* ...
    sin(psi)+cos(phi).*cos(psi).*sin(theta))+(-1/4).*L.^2.*m.*cos(phi) ...
    .*cos(psi).*sin(theta).*((-1).*sin(phi).*sin(psi)+cos(phi).*cos( ...
    psi).*sin(theta))+(-1/4).*L.^2.*m.*cos(phi).*sin(psi).*(cos(phi).* ...
    sin(psi)+(-1).*cos(psi).*sin(phi).*sin(theta))+(1/4).*L.^2.*m.* ...
    cos(psi).*sin(phi).*sin(theta).*(cos(phi).*sin(psi)+(-1).*cos(psi) ...
    .*sin(phi).*sin(theta))];

%% dfdu
dfdu(1:5,:) = [...
    0, 0, 0, 0;...
    0, 0, 0, 0;...
    0, 0, 0, 0;...
    b1.*pi.*(B1.^2+(-3).*(L+s1).^2).*(2.*N1.*pi+w1).^(-2).*cos(psi).*...
    cos(theta).*(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).*((...
    a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(...
    theta)).^2).^(-1/2), b2.*pi.*(B2.^2+(-3).*(L+s2).^2).*(2.*N2.*pi+...
    w2).^(-2).*cos(psi).*cos(theta).*(L+b2.*cos(theta).*sin(psi)+(-1)...
    .*a2.*sin(theta)).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos(theta).*sin(...
    psi)+(-1).*a2.*sin(theta)).^2).^(-1/2), b3.*pi.*(B3.^2+(-3).*(L+s3)...
    .^2).*(2.*N3.*pi+w3).^(-2).*cos(psi).*cos(theta).*(L+b3.*cos(...
    theta).*sin(psi)+(-1).*a3.*sin(theta)).*((a3.^2+b3.^2).*phi.^2+(L+...
    b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^(-1/2), b4.*...
    pi.*(B4.^2+(-3).*(L+s4).^2).*(2.*N4.*pi+w4).^(-2).*cos(psi).*cos(...
    theta).*(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(theta)).*((...
    a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(...
    theta)).^2).^(-1/2);...
    pi.*(B1.^2+(-3).*(L+s1).^2).*(2.*N1.*pi+w1).^(...
    -2).*(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).*((-1).*...
    a1.*cos(theta)+(-1).*b1.*sin(psi).*sin(theta)).*((a1.^2+b1.^2).*...
    phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.*sin(theta)).^2).^(...
    -1/2), pi.*(B2.^2+(-3).*(L+s2).^2).*(2.*N2.*pi+w2).^(-2).*(L+b2.*...
    cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).*((-1).*a2.*cos(theta)+...
    (-1).*b2.*sin(psi).*sin(theta)).*((a2.^2+b2.^2).*phi.^2+(L+b2.*...
    cos(theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^(-1/2), pi.*(B3.^2+...
    (-3).*(L+s3).^2).*(2.*N3.*pi+w3).^(-2).*(L+b3.*cos(theta).*sin(...
    psi)+(-1).*a3.*sin(theta)).*((-1).*a3.*cos(theta)+(-1).*b3.*sin(...
    psi).*sin(theta)).*((a3.^2+b3.^2).*phi.^2+(L+b3.*cos(theta).*sin(...
    psi)+(-1).*a3.*sin(theta)).^2).^(-1/2), pi.*(B4.^2+(-3).*(L+s4).^2)...
    .*(2.*N4.*pi+w4).^(-2).*(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(...
    theta)).*((-1).*a4.*cos(theta)+(-1).*b4.*sin(psi).*sin(theta)).*((...
    a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).*a4.*sin(...
    theta)).^2).^(-1/2)];
dfdu(6,1) = 2.*pi.*(L+s1).*((-1).*B1.^2+(L+s1).^2).*(2.*N1.*pi+w1).^(-3)+( ...
  a1.^2+b1.^2).*phi.*pi.*(B1.^2+(-3).*(L+s1).^2).*(2.*N1.*pi+w1).^( ...
  -2).*((a1.^2+b1.^2).*phi.^2+(L+b1.*cos(theta).*sin(psi)+(-1).*a1.* ...
  sin(theta)).^2).^(-1/2);
dfdu(6,2) = 2.*pi.*(L+s2).*((-1).*B2.^2+(L+s2).^2).*( ...
  2.*N2.*pi+w2).^(-3)+(a2.^2+b2.^2).*phi.*pi.*(B2.^2+(-3).*(L+s2) ...
  .^2).*(2.*N2.*pi+w2).^(-2).*((a2.^2+b2.^2).*phi.^2+(L+b2.*cos( ...
  theta).*sin(psi)+(-1).*a2.*sin(theta)).^2).^(-1/2);
dfdu(6,3) = 2.*pi.*(L+s3).* ...
  ((-1).*B3.^2+(L+s3).^2).*(2.*N3.*pi+w3).^(-3)+(a3.^2+b3.^2).*phi.* ...
  pi.*(B3.^2+(-3).*(L+s3).^2).*(2.*N3.*pi+w3).^(-2).*((a3.^2+b3.^2) ...
  .*phi.^2+(L+b3.*cos(theta).*sin(psi)+(-1).*a3.*sin(theta)).^2).^( ...
  -1/2);
dfdu(6,4) = 2.*pi.*(L+s4).*((-1).*B4.^2+(L+s4).^2).*(2.*N4.*pi+w4).^(-3)+(a4.^2+b4.^2).*phi.*pi.*(B4.^2+(-3).*(L+s4).^2).*(2.*N4.*pi+w4) ...
  .^(-2).*((a4.^2+b4.^2).*phi.^2+(L+b4.*cos(theta).*sin(psi)+(-1).* ...
  a4.*sin(theta)).^2).^(-1/2);

end
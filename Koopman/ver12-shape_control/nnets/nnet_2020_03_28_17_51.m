function [Y,Xf,Af] = nnet_2020_03_28_17_51(X,~,~)
%NNET_2020_03_28_17_51 neural network simulation function.
%
% Auto-generated by MATLAB, 28-Mar-2020 17:51:37.
% 
% [Y] = nnet_2020_03_28_17_51(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 5xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 2xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.839850465810637;-1.03422683344817;-1.44592660432169;-1;-1];
x1_step1.gain = [0.648775378438431;0.917548526541205;0.890300987919638;1;1];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.7867896872058457447;3.4461500510672751219;2.8996154111302927525;1.5681942981243239821;-0.86343580724669277693;-0.63224993558572084584;-1.4433860024743105921;2.7022461376703308389;-2.2684344302584156239;-0.0014893917928614709874;3.4205085301651827479;0.81709918037852369288;-1.1602908724122062978;3.0715209477606042476;0.60137505307181049474;-2.0723787732033436271;-0.62065175690235152572;0.98636680600604986768;0.36117302309806481597;-1.1259242643529072669;-2.4507157198016655819;0.67684462398501132885;-2.6189542520707393969;2.5873992968375412183;-4.2159795553256396161;-4.2211549026752157587;-2.643332691660111422;3.031890961059823919;4.4027789285653939899;-5.9340455743834992219];
IW1_1 = [-2.6984947160541423727 0.22559038609662931951 -0.73935749450890275725 -3.7311464396499882668 -2.6384504149885974478;-1.5084820085007666357 -3.0849544851464290041 -0.0066243603380892780719 0.085293252930575602644 -3.9489108923770124271;-0.044359005914588155173 0.92356285144263483566 0.25594068350869442208 -2.9192551673517690425 1.1470417713488234579;-1.9666015983024973668 -0.41022091946541527907 0.48021218910484536613 -2.2934581438460286407 2.1193065034204132679;0.26005424811869670698 -1.4870889903619650685 1.1005315859397566403 0.80299748000485404731 -2.4353357753262527829;-0.28532586187288394575 -1.037276541993916501 -1.2362331367386205638 0.33788959656930084297 -2.63262785508749797;1.2268183450858154426 0.47880898762849877226 2.2602226923224431054 1.61091625305796593 -2.4034237736081647263;-0.54313528290345813865 -0.25132460543149814924 0.31621046280866688116 2.095229918555341353 -3.8567543387194369586;2.1351049970932418631 -0.87507679351598788298 -0.33848454561876639701 2.4350282476763558392 0.49064688446198395644;1.3299152951855461868 -3.4357167312473948506 -2.640734163516775812 0.54518263897589325229 -2.9590671997555149098;-0.034096491724668082091 -2.1363850304591962548 0.11987749910519657215 4.9910168240885912638 -0.80824366652922174925;1.4646956099876629054 0.99972250526347727906 3.3839133397265293013 -0.86262744990082529384 -3.8998608341170997171;-0.46988514715543283629 2.1003700661531965466 0.25627826216874344256 -2.3450305051174562543 -1.1238497228042985121;-0.55084623022531475911 1.3457865894661851236 -0.17295411687958434088 -6.7917473105306589432 -1.3592186562231660663;-1.1920670907612753719 0.75046233107005522189 -0.55705782097870515379 -4.8773178534668009121 0.74264175329173753859;-1.8790007489911617622 1.4014038450101731215 -1.4377604633919884858 2.3634271790288807757 1.3580798374562454978;-1.1932594960575195753 -2.4627781518592133381 -1.5915545159111670337 -1.2826156838701328056 3.6217498026207235462;-2.5271044798698305556 -1.5679364266591555577 0.050767082772295468729 4.3550208953073425988 0.3464444375880596505;0.98925879485747181263 -0.70083555577959644189 2.6935487755108078467 1.4143052577212709142 -1.4080900010271344414;-1.1258863551491056221 2.2117396892846286072 -0.58667734137814708806 1.6209847202219980211 -0.52410784011083777489;0.38943968770499659549 -1.9313625927796236326 1.5196005144596693714 -0.2375398882232845621 6.0637136827233657499;0.88032143781553418016 -1.6856490686914136212 1.8749508654581072964 1.4270687391817138412 -1.7834714115249357125;-0.59340748812360466502 -0.7218669214333457429 1.7445931105801848471 0.48561366868746441705 4.5058315785558837874;2.1435229837747025172 -0.32465926734662936548 1.649690302051565638 -1.0802463885409354649 -1.6671154793294387098;-2.1858883811574232325 -0.30592983207982316074 -0.90606777366230939474 -2.9494197227883471868 5.4456812428828813566;-4.6087774855310721378 -1.9751291397445478459 -2.4313844514857345658 1.2442694531989388906 3.2805899148141950405;-0.79453292924319796064 -1.8740944920875082236 -1.1025503736315585002 -0.9021592556503512661 -0.72038572059909911083;0.48203110137385984935 -1.6218430577988742769 -0.90714209924153588194 1.5850620134779291881 0.19338087844863233178;0.47397324752399433434 -0.83852556383865506362 1.7859228326983722646 -4.3031055682472754143 -4.0492334426076297405;-4.050924963847950977 1.1272376262608592157 -1.1852139823784779704 -2.6185731339897637682 6.4776744070000980003];

% Layer 2
b2 = [0.85969621739435975183;-0.61783307017909983028];
LW2_1 = [1.8553880381322247484 -1.0344584068394149234 -0.24424292551682405539 0.57432257268671582651 -0.13049170656113417976 -1.018078923213848519 0.8351820876809374905 1.118657126649181377 2.4034335422236243751 0.44940010884841491423 1.4837305882888616182 -1.0851183055324222781 1.1045266037220433653 1.5236318763096630136 -2.7325457931774841391 -1.2039970876396908217 -0.82560159777394548364 -1.6137025092921009062 0.97964076787320764073 0.24194475987409116979 -0.79405905734713189137 -0.94883768199984286351 1.2734024499962965926 0.75931571999617097912 2.1929996871323522711 0.55010659375972859042 -0.56504512398580475363 0.8616440940035208218 -1.4221028183334487593 -1.1943778041865695805;-2.3728893119970244641 1.5403789903341187362 2.2790268488002811686 -0.71723350760216442179 1.6357505019876370511 1.607907215506202192 -0.65070053081432743802 -2.1002760319603712702 -2.1801546950305432659 -0.76083615515613978175 -3.229524381800501498 1.6241478846191041985 -3.3720987972219202966 -2.7958519245133093278 4.8297491418929716644 3.2042322124713664699 1.8063686849233873133 2.3803711367929691889 -0.71281835967999984671 -1.3064095200598042634 1.9371369285452724185 1.0193055219809428191 -3.0492510917248765168 -2.0987429942362063606 -4.101430898563756422 -1.2939774577460076976 0.43733211731227816799 -1.9658527834797108191 2.613258568938558124 2.1340570786500632217];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [1;1];
y1_step1.xoffset = [-1;-1];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end

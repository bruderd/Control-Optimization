function [Y,Xf,Af] = nnet_2020_03_28_17_50(X,~,~)
%NNET_2020_03_28_17_50 neural network simulation function.
%
% Auto-generated by MATLAB, 28-Mar-2020 17:50:11.
% 
% [Y] = nnet_2020_03_28_17_50(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 5xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 2xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.892633324332468;-0.832780495489597;-0.162269317743096;-1;-1];
x1_step1.gain = [1.08987642585018;1.03300012619045;3.88699450445204;1;1];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.8451811730735392381;-1.7748202117800759847;-0.20829477447104832732;11.346532576992940378;1.937713799197438691;-4.199703134455764264;3.4820696654779217383;0.55463007772193728684;-1.3862143667074482423;-3.6816516211424836769;-1.8338095895726325146;-0.84565218591681257099;3.5971744055367156356;-0.22727305605981557024;-0.51409345198950573419;3.1437385871068745935;4.732310474010446022;-3.4665998849714445562;1.9841332605845956039;-3.6725576248413482894;-1.0098931945904114915;1.8333095310828304569;2.3071483054747012886;-1.6114104580717960591;3.9290850946574074065;-4.9360957433071526168;1.3719299193741367748;-6.7460526071781581336;-3.8677794805611087625;6.2790863706294128832];
IW1_1 = [0.31008055043036575338 -1.2341314579664677265 0.017572603608352332927 3.5077408021055664911 -2.2278416398789655517;-1.4305908747527626979 0.0062752518700178441455 0.21540983662048424074 -0.62316126675934457868 -1.2532042189593508574;-0.7490344558888981652 1.3335074930105781377 -0.11402545614167149124 -0.84674724710223292501 3.1052384497570173494;1.6866513925309232214 -1.8478722593352170378 -0.65085654170109374927 -2.7980010229552014778 -17.617340928091742569;-1.8957061964689476685 2.2282061052756807484 -0.79693324936348908238 1.3589607679027997378 0.16110397354447142382;-0.79228532968579112872 1.6136332097839571897 -0.055686590044826789203 5.6398124243647673737 3.1624615700233928983;-1.665697807524130436 2.289599554037873741 -0.36932600888059069488 0.3265508621329974992 -4.3087553073610616039;-0.78404555586005864054 0.5518107897634149106 -0.33134998600566856197 -0.37180902531093684704 0.39393999435338822313;0.33459441963996783276 -2.1248888846507845152 -0.2675016506264629168 -4.9092937488115557798 -3.1211562572427506979;0.56754459617542207805 0.35330368420884949998 -0.067686375084190383844 0.29897893645005724217 3.6884227651373366896;-0.063292940135429895387 -1.2963455562429733181 0.17945952237575782395 4.9572336710737809895 0.84865728744323809529;-1.8051223469325445858 3.5087438395574164218 0.76331521247808331587 8.1860813845639945896 10.519154421022014034;-0.09641189040963644985 -5.7480422900971017697 -2.6728819618109289635 15.162365124022150198 -25.697272732802186823;8.489698746677113661 -5.9219538908551152545 0.2985343513623432421 0.60155815965538461665 0.96206878746262636248;-0.18874753805775706939 1.2802854795912470554 -0.23027262121370620229 -4.131470230258044829 1.6242101602650842462;-1.6006822205300261786 5.6647564278382205316 2.9386032519119775763 -24.34034747698162704 24.426974069396994338;5.6945617895802573827 14.839058528730497244 -1.548363814923788162 -6.6799716660830306125 -4.2676129675736502733;-0.42367923439606025582 0.32140362201987970892 0.0064997198379138903385 -1.8839964959970001424 3.8691666515395484183;1.8037590856843765952 -0.58572828810851251813 -0.078179424524933760487 -1.3595818579876255416 -3.5066939385934836615;0.59067114029301570621 -10.779571247092460951 1.5462897840279699047 2.4169339987179232487 7.0600796970297956534;-1.4194756018010343812 2.1788121548145422679 -0.35187171350071572151 1.719558480212928675 1.3490347431110045751;0.88712383783856940678 -0.84812114903157631574 -0.030891012703963976332 -0.73089010743634807987 -4.362275300145707746;0.79049627318244819474 -0.87283157821144230493 0.17673955738321736608 3.9114371717886529112 -3.5634464246985237956;-1.2410045240421647694 3.9724992139484260889 -0.5212593750916098001 0.97680972313147196306 2.8045706806661354626;1.0640338732612766304 0.39228033140489576569 -0.092032580264749627719 3.2754589552589474799 1.5779372257714927574;0.12364598943564766853 4.7949378901583203927 -0.25781454394617209225 -2.6243878857581512953 4.4697569968675541219;2.4947349200320054763 -1.8545719577139669898 0.79263404108336021903 -2.9887484798125414365 -1.2791890066036242235;-0.73868595135415793251 -2.2337926204899019034 -0.5748294210515262348 -9.414443047230115269 1.2606641337585171581;-1.4170796036458959133 3.060238474280333687 -0.22204658483494124632 5.3362135028285404559 2.4067225948958683723;1.2884669467253777597 -4.0893006070107791317 0.22297231158240260473 3.7323881433214136649 -5.8654223568213295081];

% Layer 2
b2 = [1.3122639442849046709;-2.8340263904708820064];
LW2_1 = [0.86607507316114407114 -0.35568712262384977185 -2.1265595638610159668 -0.40562208784329106814 -0.73735988734571356051 1.1300919981794890212 0.70056613145452750757 1.5492688500318407829 2.0719759984164274336 2.1170019599956400036 -2.9575222044321591852 0.59635065291323163805 0.44181099646814908644 0.12003457305547086953 -5.4017249272297940266 0.34738806959054774337 -0.12671124350086016008 -1.6841465496020091575 1.2206675337823740257 -0.18966883660414993185 2.4032095924618550598 -2.5652039962932065009 -3.2302328915011822019 -1.0627554159363123976 0.28749034690437946793 -2.2183421297918219928 1.3505424727146797537 -0.81396933542814531304 -1.1218290299918707298 -2.1544713964626773794;-1.5722689102759030977 -1.5160964639117637809 3.8828068915998605881 0.71789120297178821151 2.0558740461640314656 -2.5324777902184689715 -1.5254469715463800927 -4.52758527749253048 -4.2057448417382126138 -4.0684649031809039244 6.4105360938745139521 -1.2968260344947200036 -0.82355561339738436732 -0.39859097599546700064 10.306221984639536871 -0.66824301398374819083 0.24328205923021462009 2.980715450071070638 -1.6589932294291118708 0.35978223809677922773 -3.6110481529667990408 4.2599481366898643842 5.9762691422370668448 1.8795501995486589841 -2.0704790769106011794 3.5534179972512438539 -2.5815951968474917244 1.5895277114236023852 1.8606263617810050448 3.4553985510217803956];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [1;1];
y1_step1.xoffset = [-1;-1];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end

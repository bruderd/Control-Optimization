function [Y,Xf,Af] = nnet_2020_03_06_18_57(X,~,~)
%NNET_2020_03_06_18_57 neural network simulation function.
%
% Auto-generated by MATLAB, 06-Mar-2020 18:57:38.
% 
% [Y] = nnet_2020_03_06_18_57(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 4xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 3xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.803042463556428;-0.378115243835457;-1;-1];
x1_step1.gain = [1.60862919628863;2.6432050033675;1;1];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.5961581470499357494;19.583289359286521147;-2.7651225144997484406;3.2893540586261962311;0.87359770387832480498;1.0103550273010952765;-8.2639221890940639526;1.5153165469180918112;1.1028708398953497305;5.093886066767035814;-3.4174535349112273863;1.6783053741580709062;8.1151432300523289598;-2.4004517210056564025;4.4165593076985452115;0.82993522180307865987;-2.2904221101208142031;0.26797696748046717641;-1.197001467897261584;4.7890358617642290184;-1.3644695105831317061;1.6847341869336278641;-1.40642393359768203;-2.0866674495562103075;1.8593717666230942243;-10.947635701632657756;9.1484152865857222281;0.92540582085159062142;-2.339337526164934733;9.7797306141535536028];
IW1_1 = [1.3540167974353001235 0.84974439160674941629 -1.3257540106870653318 -2.5822832480842587977;1.040007055162698979 0.10044160280588709799 -15.398110899272529295 -18.282493359922334264;0.81140864360822073653 0.30047577158010202458 -0.70462235406291517936 -3.0076646816861409839;0.87739026318125379333 -0.26383249015840898322 -8.0262373826405131183 -0.55275557451246837282;-0.092098724833918885202 0.090200547425875798879 -0.43068345029889848474 1.1547771229098446888;0.0047547108769950205409 0.099549144292869318207 -0.11881898210704180952 -1.5992218333301344568;-0.71231424589609948494 -0.75689936160300408385 9.8360024812957824736 6.7283451943744232437;-0.2080822351282826943 -0.071746993781230491982 -0.84016695766726612327 -1.9611420052551324922;-4.5730812143309380602 0.39838674391354073068 -3.4274522344149898068 5.8219279062993738449;0.95662838311956577275 0.09184977501241745057 8.3696498862461599089 -11.308901248933770134;0.18429553317018812497 0.10948082110354664942 -6.1424978761291280094 7.1457343082008719648;-0.36495566562194037274 -0.065755781199043419893 -1.4955309018061850868 -2.0217015266289801723;1.2026706119942229822 -1.6381418467042783149 -24.442834742288841454 -10.370363309919341077;-0.58618489693145503505 -2.6837930274661077057 1.4310534029549049073 1.406851306925967382;-0.42419374946050214525 -0.2035957552634281853 7.9143861788976019866 -8.6641639964084955494;0.48658196371088902055 -3.0301630729669559727 33.911566003338030839 -10.683541335364667546;0.30943677484230303065 -0.038011184991855732906 -4.3585581710482541595 5.379663764087445621;2.0765320540742457922 -0.62670545745725347864 1.6935949692458436289 5.1228679834789732084;-3.9287748734231979775 -7.2454639668472129443 4.0399742690313544813 5.5534887090943705346;2.8277492065144218536 -0.013041100213738089642 11.373533812985098024 1.5352922025720423527;0.54910392575012356708 -0.51148313138830125979 -8.0206450616834708001 -1.257697645398627273;-1.8752372586606422811 -0.36095567550161788972 -41.886072103450437965 24.14057477065006907;-5.5040616816713034964 1.7256767892259927688 -4.8826326929540933008 -10.906681927453261594;-0.74582536776119978672 0.10721573263908751317 6.0359693464078230107 -0.22217719687249756766;0.93628833904116559594 -0.1766361325443016328 -8.07456989558578897 3.0889221074024710845;0.58012263829839794127 0.32415249967149695198 -14.925529099441028791 8.3683363390066141108;-0.97858281633780774822 1.3800726182243354678 10.89478673118660268 -2.8317578520421911037;-0.00092148547002046839183 0.27136418186389360541 0.1774775736897413192 1.9559272382558416936;-1.1332082913306156247 -2.599247266011007973 1.7843621051422284829 1.8909723103574287428;0.97801559836510032486 -1.7004666093068063759 10.458735512368502185 -7.097444786659121263];

% Layer 2
b2 = [-0.21203688759197619751;-0.046646519597134505908;-1.6317217795743883535];
LW2_1 = [0.11407536630227586849 -0.15779265535371678197 -1.6678350899284668518 -0.43408718718325378649 -3.9172737944930449139 -1.5952767247224692859 -0.21960922331365079208 4.2511963012150495445 0.31544876934196330875 -1.8709346483138724615 -6.4999849434252103819 -3.7878911491079314544 0.17262259557640635688 -3.3416480882457815227 -1.732353363266486701 -0.15745514425414416926 2.9301326940066565463 -0.29380105394102906669 -0.17497782829578661934 0.30094790938860471741 0.6380363743315908831 0.066531606859960859546 -0.18720642089064110092 -1.0554764136650334194 -0.90648619059962909361 -0.22627927026725727644 -0.29555263793331909561 1.3117113415735104365 2.8925869693029508944 0.36493524284986594841;-3.099774580922104672 0.37794228530385548526 3.0844354769274628936 2.0893958555218823392 0.97709146197848295579 3.6483255200470541268 0.49065103868458087577 -9.8433074301012801754 -0.18395573399270173653 1.7859972237184360555 4.3265896074429734952 7.4150357014721395288 -0.28123688012733571995 4.1510652735508237754 0.055453856602051737612 0.10184674078273955877 -2.6579771317447273837 0.78661795195937544989 0.16706141103691218852 -0.35562846057486274809 -0.80218547892832514634 0.22596699958064470071 0.40137909822899792145 3.8292185668583389457 1.5297240174456407935 0.13061105971359099343 0.099530745881613050252 0.19012195609520557427 -3.8149257554448108287 -0.44219295807697039935;1.2029123732702646787 -0.23907074333832448176 -1.5663334382487787977 0.60241138117914938555 3.2920952086671446679 -2.1485734419144018048 -0.35340184903458710108 4.3957240436199720435 0.00036500868740229133746 1.8151621113398781482 10.085383379274984961 -1.8181135971727258038 -0.12342339754664903573 1.626395662830901756 4.6520279343424482121 0.26819496827081606982 -3.2022590027888053754 -0.33323457079475182763 0.0066054546241050256586 0.14411099678920863409 -0.74824312337181109189 -0.40647276175197538661 -0.27153244601157267013 1.2384177764996335824 0.49142033873245616338 0.38422741655231862357 0.47949170880400665551 -2.2159327968442856793 -1.6500969720326978951 -0.086622980609688732256];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [1;1;1];
y1_step1.xoffset = [-1;-1;-1];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end

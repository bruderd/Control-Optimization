function [Y,Xf,Af] = nnet_2019_12_11_12_55(X,~,~)
%NNET_2019_12_11_12_55 neural network simulation function.
%
% Auto-generated by MATLAB, 11-Dec-2019 12:55:43.
% 
% [Y] = nnet_2019_12_11_12_55(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 4xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.673459208760459;-1.61208545600988;-1;-1];
x1_step1.gain = [0.826501556435452;0.924628525346708;1;1];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.3667515044439868532;-3.598234700506792727;-2.0699446840399020608;3.1297688646649635125;-1.3728807525168604808;1.106214365604403671;-2.5587182572551201432;2.6669356986098931017;1.4155225407742075827;-1.4275882313881718133;0.78536416136960796042;-0.76798175385801736859;1.449854597460944472;0.32724132173378511768;-0.65868745642023007747;-0.59332599895632520681;0.80498983567903215075;-0.3956344778627326475;-1.5909160461095990247;-2.0013933049549614829;0.96109960627909141184;2.4723967628899958804;0.43317745143617819581;2.580517346106837806;-1.7263350633122558353;-2.8229628593480322607;4.6532876937805252027;-2.3939544266563324015;4.053233669790177629;3.3396412027225004238];
IW1_1 = [3.0483708775162021709 1.8849277962929049668 -2.3557213317096885596 3.2428954299238252901;1.9045944978280588966 -0.58909466067284366186 0.866760384622602853 2.7498798295998256869;0.47630996273689563125 1.6999145826171702112 0.86831945082584149898 -2.7747440929953630651;-1.4891824565068962904 -4.6988188934436170285 4.6624855602347317074 1.1492033891338917506;0.92767948950911138795 -1.9575231966676578388 -1.2129359765988376729 -1.25438094981505599;-2.0353332914323369884 -1.0134329330347671139 -1.5392112290274424513 2.2928200829913172321;2.9733441270068308171 2.9485529209958478702 -0.033123948657987394018 0.22720750856178681398;-1.8329425400443830618 2.0387142362179346833 1.687771001068607557 2.5199777474910480812;-0.019588021142569810723 -2.5887538886578305153 2.4263800067570411301 2.4678294648030054681;2.293924871987593761 1.0979823358461233695 -0.50541744329132742841 -1.6058608693893821062;-3.5510446923482255066 0.19703468094581122472 -0.67133539166304467827 -1.8921786222421279611;1.2656213297585359179 0.71407640449663456472 -3.1758472842470104602 -0.066106580272695364409;0.17468461756233652493 0.091717115498214887848 -1.6708260510559707068 1.7918426713821047347;-1.4366582945399377635 -0.16194162046747673234 -1.8691827890272163515 0.43427928191156695004;-2.7683383940294734593 -2.9260421038241264391 -3.8704645554782612926 1.1139075069132278184;-3.1200782166775855586 -1.6726124915517339709 -1.8518465906806367283 -0.64046684041688806133;1.0755461070791392242 3.7457488468000632587 0.013464311634624298933 -3.2818338760912046936;2.2990763645103307056 3.9520612484099584272 4.8608498427861981384 -1.6257805009516583805;-2.2570761585025707063 -0.7111644250740604134 2.3863493652963749803 0.09616819030249385003;-0.33028233144729374215 -4.4309522352441916837 1.7957132947330658457 4.8552066544552285876;2.3794029212377907356 0.0095044714631234150648 2.2385610561596895884 0.19771304222049587707;0.91318173694051874012 0.67545982932312498281 -0.57207901157029961148 2.0365789891109469245;-1.8208795155526709131 -1.8819722955830446853 -4.4061029062460024264 -0.30753707872511276689;2.7722425593105701758 1.4268155718930359832 -0.78680705019362640051 -0.21702988074891282899;-1.6198447676887297586 0.36027968260015746926 -1.7700544230800163703 -2.655124208763454341;-2.1804981148228339549 3.2294550076565529118 0.63415771726282044174 -0.11885735535898743487;2.8918764079615728591 0.62674037586192654636 -2.5782490261332613457 -2.7611201636451827568;-1.5785905929205386045 -3.1407718310253165406 -1.5525671192066250459 1.1096506570331381436;1.589154913655246526 -2.0470658042883997929 1.7307648554861705392 -1.4028629287580216545;0.96337380835040575811 0.89455999173693145909 2.9344919748801552295 0.94189723347176856905];

% Layer 2
b2 = 0.14166356341627253657;
LW2_1 = [0.92245724712417598301 1.0270598482956823094 0.88204224160436517366 -0.52731945839983707103 -1.1970548448202689151 1.621695957414713396 -3.173765469993655941 -0.90229798261975868723 -0.63625076039845618325 0.41581618577743267862 1.0789341674598345033 -1.3011447252090420079 -0.73635937569249110268 -2.2440282263559980791 -2.9451570372954956056 1.2113465489168033784 -0.77609067515697893747 -0.89588229504973448947 -2.0922188753025903196 -0.58959052067844730516 1.9592109891890705509 -0.50448284713323365835 1.9857100775123031067 2.0749527908700975409 0.45990894962221356979 -0.14566864128359338637 -2.3743540986601372467 1.432682770447209375 -0.3605280546540208797 0.93786292598320164515];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 1;
y1_step1.xoffset = -1;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end

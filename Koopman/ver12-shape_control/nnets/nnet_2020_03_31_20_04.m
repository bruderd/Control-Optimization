function [Y,Xf,Af] = nnet_2020_03_31_20_04(X,~,~)
%NNET_2020_03_31_20_04 neural network simulation function.
%
% Auto-generated by MATLAB, 31-Mar-2020 20:04:24.
% 
% [Y] = nnet_2020_03_31_20_04(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 18xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 9xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-2.11539670279995;-2.34951027847574;-2.00132699040284;-1.71530941413599;-1.05608586735447;-1.40972149731311;-0.74357599843105;-1.06851179951818;-1.21710599558449;-1;-1;-1;-1;-1;-1;-1;-0.920044027805395;-1];
x1_step1.gain = [0.469310311706223;0.475574732879508;0.645675062841973;0.719213373744626;0.753291214629661;0.826101007881081;0.962611735215903;1.05895398522916;1.03241071401558;1;1;1;1;1;1;1;1.04164278060123;1.04603083642506];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.80145968512681486917;-1.7101150689025161888;0.77256422633398269539;-0.85166607731960086713;0.9230268272047021938;2.3097520909872892858;2.2958462202237104322;-0.54161015699196801698;-0.037789835793033514644;-0.71001704881394112068;0.38279852964962118866;0.02709661204880753696;-0.4041001061156965779;-0.56570182938448476673;0.44050301126820490261;1.267274639382088175;-1.393514097720805367;-0.45442052455246534359;-0.08681664866227165045;-0.26777220823030167818;0.71204483771949289572;0.85392001976376563643;0.9821029058714004778;-1.5919627307418899864;-2.3664593800428601611;-0.76153229281002143836;1.0896359451995425438;2.0405511366755697544;-1.3558984860856484467;-1.7245779471189530696];
IW1_1 = [0.7325486552083045888 0.28971558720679163601 -0.16849937034609760445 -0.60584970184434305818 0.094534576707154704955 -0.13452394085271462965 0.40719666580721841642 -0.98827779320926423257 -0.065411879270864739522 1.6451063591105941075 2.5840327998487837569 0.72236515411630441985 -1.5734744748919600177 -0.74903000509861672462 1.5768602333358314738 0.17434491919618466671 -0.53235471370521159074 -1.1718260071138986156;1.6394935667870746965 -1.1993234239433481214 0.59000456635123144089 1.1509506943649154831 -0.39591453175736729397 -0.35163200488466878069 0.26200727529746148381 0.59201091257742255447 0.098793847706304588341 -0.8019946289221908664 -0.22252645604766499443 -0.23125794394764306872 -0.26675191802069980751 -0.82079287566890235528 0.9842629424517589376 0.026077225674060455773 -0.073623457213010765066 1.61876089323331529;-0.36147300605726595535 0.29668256300576456574 1.0108080810173600828 0.54364148215124219465 0.56358844722952039508 -0.19882558718753465254 0.44325791491139449052 0.25853533539580397793 0.22243421664257678749 -0.89003721321274542611 -0.47203483041960536681 -0.70576026316251760928 -0.47225604658312003714 0.097994709828952600295 -0.47174496690525175024 0.17450256246667739113 0.82010622718433057177 1.171756832467541809;-0.085558719277615630228 -0.11276074507375173639 0.42811682392725619595 1.0867710464712752039 -0.52659048130389363163 -0.48070439149051169547 0.11902829735980424708 -1.3224787935837041264 -0.33811985323991061714 -0.95706893897143130445 0.49426508554309955823 0.9409011008533330056 -0.78984964211027686165 0.22175671451013270752 0.27889312232789309487 0.42574691571375183896 1.0638524969989093805 0.57031441363516255372;0.38508974514375327036 0.15817560191652094148 -0.35814225362935536712 -0.73580798094124999498 -0.22152874429831417857 0.023513328761254483068 -0.26593153592181284495 0.066986852654187883926 0.23437285372886318413 1.3635689845651346452 0.58613370402363251799 1.333144725553061738 -0.27935543510056470851 -0.63232726880248357748 0.0032654804200801289607 0.099387079833518993111 -1.094037864722846809 -0.4820343668103065915;0.54242621012899483457 -0.93510184519194183839 -0.22774773000374451404 -0.51048017425206582143 0.82554897566349583204 -0.6558750669866734162 -0.26154254440411445204 -0.085034694637296653896 -0.51945866835721721255 -2.0005276144895889345 -1.5859353460585237094 -1.878863856398813148 -1.1800656518252585769 -0.58600239528173847514 0.41134421113043556639 -0.6602357822918375474 1.2241791653974427589 1.3604869699783850301;0.86219578581737654766 -0.60515019583456763907 -0.3651340236051239807 0.19487405394680232251 0.39653803453307134852 -0.55576969839221312952 -0.2747276757756246246 -0.3421897367104921317 0.73204159250276967796 -1.2163971486295641622 -1.3602660545791498414 -1.8002530116877077937 -1.5756272752930655656 1.9221065304860236456 2.7781650817977303625 -0.70604175010043301874 0.97311441884577443151 0.24786563885512902239;0.17545330337541323318 -0.90702423610176197144 -1.0407645604234270209 0.14918210551853061663 -0.56126092492504364717 -0.096177325750587738806 -0.94899962583869967858 -0.61275806703694746247 -0.38122875585999199677 0.57852426149791469356 -0.4643269887916839922 -0.45959572685831545646 -1.7547347543617457521 -2.6009355467421952923 -0.9327713306623480749 0.12163648721593756097 -0.7232174367877177712 -0.61904325038392793434;0.7466879117098382812 -0.33743370186644594533 -0.19141467674108939012 -0.95223783663824645984 0.216428999665851024 -0.26488748734579325994 -0.083815261926412171212 0.57463862394154996416 -0.37750170814507216788 0.56455077737361747392 0.63825983758820192815 0.17748080569867136225 -1.264701059982932918 -0.40637164788194185538 0.45986818219607039637 0.43538205431918047816 1.1770094188359263576 0.60530430398480050691;0.074490705985074665008 -0.55251721432793954314 0.36418598775730925965 0.68496611931750728264 0.11000111452454604255 -0.32844650243720091565 0.14758314209289530305 -0.25056302193682389312 0.31561078285586285919 -0.78158079966019489149 0.40259724719939010695 0.86447826904511171353 -0.092591089252201108639 -0.29564907211012464439 -0.59930063863389981815 -0.51316450813800629227 -1.7949357542344301919 -0.5677967267657569872;0.81399955721307193368 -0.71093570320086618697 0.17090980286258522503 -0.86066564157178493399 0.3192925561910898713 -0.3898660383630818127 0.24136632439379834825 0.11586627662274187611 0.33072336063673585249 0.1411640027115766971 1.2572655802138146264 0.71364048726939277589 -0.53269228963566384039 1.6574265919509076905 1.2643405821122359889 0.98388122787931253654 0.92135698954503675306 1.0379097047454377556;-0.39969026216316660971 0.11346787439498597083 0.24381336146922699681 0.676707637929853556 0.028514447269836533383 -0.10576318633134022817 0.038742675693503980661 0.14223554762857931744 -0.45623366537641601992 -0.44366999552676977814 -0.18233587208268675628 -0.0049567113702338946868 0.52814367421906305289 -0.11043531014942371826 -0.10140446125287128076 -0.052839919021071747596 -0.18034869040606951729 0.16852500504535924963;-0.36938771594861313785 -0.10728712013859692531 1.1077733868875865308 1.0722497754188100583 -0.02211018500698878203 -0.55992536500739320537 -0.51897275867271674965 -0.77614611316067072533 -0.74109447901368097344 0.20297455501689617985 0.94150925634327597979 -0.087059540087278203258 0.74849756697967295693 0.32235933207768008302 -0.20783677978370906914 -0.27225048090812120627 -0.86501007299789867133 0.46536812882567130112;0.1758408127792815967 0.73551305312540293802 0.45424375759930718521 -0.3387022861807912899 -0.56378426665975589493 -0.88664933536167278572 -0.013016824703340158439 -0.099640238221907095895 1.2009818970675070204 0.22570483718486736291 -0.13035582815829660497 -0.90572584297607783288 0.80609759478594800175 0.57718591229051974256 -0.83883427791133946538 0.19589510994280909251 0.15532351228114302244 1.5319007664479076247;-0.16486548561462688323 -1.1903301748215444622 -0.60959194036999087007 0.029129631436249921184 0.14383363964735013107 -0.35455172544571572635 -0.041217535671029432998 -0.39878159659528761294 0.010142384104142750795 0.58041967844217690065 1.1103289861369605163 1.1449113099107115499 -1.4266258165068399499 0.058389562165431341256 0.023295950801872980507 0.50867923063905629011 0.3129373480806387775 0.0084470845810271297238;0.11911137347844644174 -1.3219011531746687194 0.0098644342726782689029 1.0233843853391908496 0.36927704605725564235 -0.2187129698129458566 0.26546841518234287616 -0.21733533031895224674 -2.3659794808705978397 0.47948491172445145692 -1.0775932128027549961 -0.70987615645209956039 -1.1161136819410919507 1.244158577953313527 2.8673541163671258936 0.22751909420658417149 2.2403150689515252125 1.2889970895447211419;-1.3284271802987965838 1.9912496780013979603 0.75112208426375048909 -0.66451572994703489439 -0.03677301984119275835 1.4961808276984398525 0.68427301062592471581 1.2921709332281370308 -0.57208990602899034705 -0.90994951070148444305 -2.5830986147293120148 -2.8326931923215363796 -1.0682518427562084362 -0.13688396465855470763 0.68019854948911617765 -1.3121452383222738103 1.689737131618503474 0.62369220368800304399;-0.52212540676300933651 0.85310647815162432561 -0.61981016104252339982 0.8623475587808694387 -0.24240153861071633834 0.088703371012397835838 -1.2057286483874236627 -0.083529974684422192421 -0.42819751155719287805 0.74808994198121558927 -0.67462299662183711213 -0.92001767928450406409 0.92354216762281649 -0.46044276658522531598 -1.2752518408383006765 0.29914373690109996584 -0.68977691458106760169 -0.86297233037678766632;-0.1298817394346570564 0.15780418664639278559 0.16179979322378024165 0.020616934972133901111 -0.028556102021589733347 -1.2831643297750192634 0.35976780895473475796 -0.019519868157636923595 0.5821315130719642017 0.9047463604526421177 1.6632394585047178825 0.99460004767358922706 -0.77552969905498359005 0.4292019136193834794 -0.26908012127758579313 1.0140612776122936989 -0.25431877641024031034 0.61239702114481131545;0.088080251648347401838 0.8493922967883057451 0.26929600627313143857 -0.60830947664582624146 -0.50823493638578409737 0.2888154786708821975 0.38366065027267359788 0.61815455465426083492 -0.48546218327730039643 0.59148307999335036911 0.43938920877528314657 0.096011687381550303577 -1.0753106883189460508 -1.207573373133189687 -0.3534990311796162854 0.30779391968403108093 1.0141167513047364412 0.34267168830377731092;0.46678362055450750567 0.94994053507207887321 -0.20804501635796632253 0.56883405729983060883 -0.034613410293648991245 0.51007025255238647166 0.30827191169819345706 0.41899928513286310849 -0.38972249515104345763 0.15472818441973895665 -1.295631295327292154 -1.7109806042480404376 1.4012223995570860513 0.67766231196566573125 0.48890360320921799619 -0.44156431228707776482 -0.39078452324130980022 -0.58437047462393776343;0.40894404423775376767 0.25566307347803157723 0.48390089697648086542 0.47775213254701592858 -0.073553719851377694083 0.5398871979023684986 0.86966058856946226729 0.45999430719803391376 -0.72746441456405197545 0.0021630895635992167594 0.27067734938229204289 0.36335196167522876287 0.86765162901061376743 -0.79598997057909803843 -0.29456093222596291259 -0.37982110952358999478 1.2014049199932792522 0.82901784201111461403;-4.7786505214586928042e-05 -0.152380489984269063 -0.10420992536060295908 0.45339684245891165304 0.32911863704612182024 0.18044412972486001401 0.23341812325571140163 -1.1091461790806986798 -0.38036523963869806053 0.55516722731336554109 1.2077036115423496199 0.96720405937199938062 0.90573489204373514028 2.0805950184398214198 0.7845241849186658234 0.094093910791715057451 -0.42608266642192799134 -0.41142505774256959983;-0.42670090508022479048 -0.88515313816689733528 0.88196475070657698314 -0.56029195536775544539 -0.33589133391479408797 -0.27980521882703413006 -0.73302704067843282854 0.36965650150289075526 0.20778313712246421208 0.70028828622060623754 -1.6834893898088025832 -2.1810160090491477192 -1.0221064913659363427 -1.2832442756193289668 -1.4276604865675901479 0.86963575489606292912 -0.63234866522350885454 -0.71744604790540056349;-0.4534383531855570304 0.54747527530461292944 0.13081220554966785374 0.48697043810806589503 -0.45719583392708251779 0.0064524930845705902316 0.48666347149914684911 0.92382414749102970131 0.39389007160191330525 0.94040731911211328242 -1.851217333389797437 -1.3719074790876484293 1.620994831990576035 1.6266561693815815293 1.0784375480190004915 0.55701955048732099129 1.7339382605503357304 0.94631114937493454597;-0.49255954744706109683 -0.25659033845529011231 0.55009335740782450141 -0.53999060506938711956 -0.36752098822458584282 -0.63846789385339741685 -0.5353956767079730561 0.91503381158622010272 -0.053346830035825798522 0.026891339041614358008 -1.0795176352845763379 -1.5793245109441800267 -0.72629402936716347394 -2.3897402073379430121 -2.212661938443568399 0.14103225828153895249 1.272171347390496754 1.4489766263268997193;0.93871880449186795303 -0.43312069798902363971 -0.67102448831393157747 0.2991062021261731152 0.21900333586270764874 0.61671983154907072944 0.046026168322003770117 -0.34046154184134791443 -0.14737544484515627263 -0.82875107604694642216 -0.72993382395754924374 0.27194772340174083736 0.43047119484029627845 0.26011000782387794228 0.24346075256869514902 0.011957747432765498258 0.096089239418712196761 -0.25330954976260727785;0.83658904841320747003 -1.2549914669483284158 -1.1816517788812874734 0.058864445193265349521 0.9215483827352963786 -0.09973368180507249936 -0.28541154970389853718 -0.32503432875959287207 -0.38470048395256351004 -0.99034024509957807592 0.40445421924321589557 1.1677130641778965536 0.19159146779313290798 0.21265699565323548104 0.17108052951241969897 0.0018997596398113020255 0.96748778457473560977 0.70892296241626195918;0.00046124902364970063462 0.22634422249692887075 0.26242277503202859901 -0.81398787058050725562 0.32652406804860151235 0.17515732688170687625 -0.29199056921942867504 -0.72792294143219293812 -0.34619048685797609854 1.4054694455987011281 2.6026748132934200974 2.1426818226821389146 0.87756916435057752413 0.26587181277668947565 0.69239779697783188084 0.15292403962021489106 -1.0800765255922255559 -1.0083347327249099212;0.36131288507004433175 -0.028186407053454230753 0.37449235154222948463 -0.36317193086798582602 0.78333155431007817082 -0.19125533390406077028 0.61714979761803323566 -0.26875376628446406846 -0.012390806417787954274 1.2413947287432784972 1.3445878495340319869 -0.95392867532916192364 -1.9454016499668591589 -3.0028278191777415529 -0.43518629279012599476 0.24044465031653985965 0.77285719300286326305 0.37355997651464256659];

% Layer 2
b2 = [0.33178424039573412019;1.9295054278541128312;0.14565769388745869461;0.82179625377102827333;0.49165088901729553372;-0.8872071992025335474;0.41941518964298557526;-1.912295647503864382;-0.8901940880846170856];
LW2_1 = [-0.19178554690669938343 0.44937427624934650483 -0.010741724458871265008 -0.19861691555032259804 -0.28379318306609813138 -0.67969711615528827231 0.085172452675589316318 0.65210014309370400998 1.0491201955870894658 0.25921305590110066408 -0.61051094280871631703 0.13010713757206662788 -0.33585728446658208446 0.55052730179256170739 -0.72723138678021614911 0.060572221073817808512 0.40069663598861793297 0.011904648435663594055 0.15827852920219376287 -0.66213453939082578259 -1.0867080782671456607 1.0420846363386508937 0.26978717556438686076 0.57419315396536607654 0.14108160660318616597 -0.7491051363586083145 -0.89056390400907881055 1.1990799446627715685 0.5492742991297528965 -0.73602681201048392179;0.1186634328793216564 -0.2208910396903951967 -0.1811067847235114936 -0.30175947215801607326 -0.92029433944436866977 0.39315653446113174585 0.14775746824014618364 -0.21205377673615230516 -0.30620829143216837798 0.88589831364523619062 0.41787265409711926711 -0.32920997013245995033 0.066810786911583958103 -0.44270151079946662431 -0.015794988367033128973 0.15574378747091691122 -0.52570488351910049651 0.2268823032747295243 -0.23744712802062242774 0.53136094934097011233 0.22162623624056068672 -0.70083138925271826203 0.23890596880663811374 -0.87952343577950642395 0.9459204787146746618 1.2199649191176469287 0.35942734698684392081 -1.036369468259925597 0.94964527631231998583 -0.0019445338771774981976;-0.28544523875615507302 -0.23556909270597792272 -0.71157796884091262246 0.41751903560791503445 -0.27974856367942763091 -0.15017268605167849449 -0.11907396237058501254 -0.41901888723585417607 -0.47972344436330804918 0.37695934228820937584 0.51872967986377183092 0.081623220293363427102 -0.31425671260236853755 -0.0061510263515107566762 -0.24177716165141727167 0.18113922911918806102 -0.17322780062833892378 0.18585324387645618671 -0.010549820917466402881 0.18629979322019712962 0.72853331049629799221 -0.51851894689610589229 -0.79897846544152772985 0.70374176199353377648 -0.73065725213591770082 -0.56917256725551634844 0.19456031964792425137 -0.18447977892993544513 -0.52504388502278664941 0.35881893650874846502;0.17241744051093974011 -0.63526370473802695749 -0.81145379783252913342 0.74608831919471407801 -0.18707812939002019248 -0.5360950205457294393 -0.017017011848667273899 -0.24992826152121586092 -0.043311736721872967637 0.79206082678266764852 0.44150402074326333679 -0.48816245678359015958 0.30230852485960879594 -0.61776957659076892071 -0.60342801059884798587 -0.15149295048790420437 0.22759057347024577722 0.075988565906530525229 0.78098575934234726326 -0.098854605731037908933 -0.14121689055053990303 0.098896886771164482788 -0.38666361755325334704 -0.11743323897863339189 0.018708205549896956416 0.62404963929082479801 0.34568131665420598342 0.34546454842215690295 0.0014178626775754321621 -0.033753619463701478587;0.20602535335258848059 0.70888133831053090628 0.54894963117068584779 0.054902072524840736523 -0.34142166734203260869 -0.58166348808986834129 -0.50714258788761046315 -0.32328416271641347013 -0.34229996195323514341 0.33754777862112506082 0.17342124003963996226 -1.0402710466779503395 0.057535946370330333377 0.21991027054320233525 0.48673580318813458589 0.12587088985412783759 0.16555937308560295107 0.75975092660626242225 -0.49819589373257500142 0.13663863380081567311 0.50015565384581639474 -0.10451578171219232105 -0.56065711961068165348 0.95397705236891994218 0.45014345069990091552 -0.67713696744605400557 -1.0407621525766970194 1.4301762316316293244 0.44362843256861972385 -1.0550168420922243495;-1.2360157375078322239 -0.081497644634544647024 -0.89138429731406687573 -0.15506682598780371918 0.15976259578709220421 0.095864406649851185982 0.29234296774116402817 -1.37932302514881866 0.015653412986899435666 -0.81459699091374226931 -0.42834755084529851921 1.1616974265377892905 0.27187763256034219728 0.12774147469165297863 0.92183760961890370833 0.0057623817805294297312 0.28541020379689246989 -1.0296244335607951381 -0.0076606586844266740671 -0.093347530768423975234 1.3402991180195329424 -1.5378103138477181577 1.1095980050078548818 -0.33556438611348415879 -0.80641749958501696138 1.3091730341174612207 2.2284335608855601052 -1.8381251575823447375 -0.35406830489259089045 2.6969581997993956612;0.010546544420276289175 0.36449726541452170947 0.26216882469150981638 0.075403784130865902924 0.21429422751387944279 -0.33437689511806395481 0.73369942414736877279 -0.049307316353866606495 -0.065384060670102203683 0.5653299344483286859 0.25433457600517261898 0.74849435789923501883 -0.54917250303875420059 -0.33066191888189666592 0.22702693412684721297 -0.048475264931874234575 -0.18112346083622907211 -0.045353820321852915398 -0.36821159205573589235 0.3370729386592984933 0.80500409497459224362 -0.91169588126254053062 0.79713508934996990529 -0.45502607475952394633 0.50374400655132967053 0.51434546943864778434 -0.36804570981890644132 -0.41601111554831582406 1.1363078276953741952 0.14772515849274947541;1.7308026652345973595 -0.13600828263154124409 -0.12942416139944692977 0.18299038134103037812 -0.21211905431207042638 0.20789952659177177163 -0.32962714000787862734 -0.54675815007730588224 0.54403382296013469421 -0.6735641023745883027 0.27478640093839756808 0.46989086830603599143 0.20782375018842436099 0.079764004604063826198 0.70449536214176167181 0.26083801414397506102 1.1755767628857398677 0.18330702778933607999 0.011836190629248365125 -2.3091774840762444576 0.35998881260937770632 0.45710450514374229014 -1.8052350876745846264 0.46208161521805041216 -0.10206557204641442116 -1.2851150913075333193 -1.3789713122512632371 -0.038208404721959056405 -0.11027279267099564242 -4.0864684974218974389;0.17355655771257835762 0.67627248864221900515 0.058757407952625233249 0.85410877763259862583 0.60295057336094748379 -1.3702005235381853332 0.98734787071972318628 -0.09216118516595403487 -0.21764338467311619696 -0.78602002440770502023 2.5227647532255086382 2.9406499738841938019 -0.93972680169747868639 1.7770020826754135967 -0.29812941111959584406 1.3912833486550022499 0.29335600047208704177 0.95861137007610341954 -2.4354473321591862955 -0.2176041146656685632 -0.87304593845261524443 -1.0177411267468199352 -0.31899405842575800918 -1.1140913477059284364 -1.3930909142543714818 -0.41246270333262646801 -1.5499712009150223846 -0.64119889293195064806 -0.6775687858723360435 0.038401895620951774502];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [1;1;1;1;1;1;1;1;1];
y1_step1.xoffset = [-1;-1;-1;-1;-1;-1;-1;-1;-1];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
